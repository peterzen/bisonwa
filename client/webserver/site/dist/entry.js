/*! For license information please see entry.js.LICENSE.txt */
(()=>{var e={61:(e,t,n)=>{var r=n(698).default;function a(){"use strict";e.exports=a=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,o=n.hasOwnProperty,s=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},c=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function h(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,o=Object.create(a.prototype),i=new I(r||[]);return s(o,"_invoke",{value:S(e,n,i)}),o}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f={};function v(){}function m(){}function g(){}var y={};d(y,c,(function(){return this}));var k=Object.getPrototypeOf,b=k&&k(k(R([])));b&&b!==n&&o.call(b,c)&&(y=b);var w=g.prototype=v.prototype=Object.create(y);function x(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(a,s,i,c){var l=p(e[a],e,s);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==r(d)&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var a;s(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(o,o):o()}})}function S(e,t,n){var r="suspendedStart";return function(a,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw o;return{value:void 0,done:!0}}for(n.method=a,n.arg=o;;){var s=n.delegate;if(s){var i=A(s,n);if(i){if(i===f)continue;return i}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=p(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function A(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,A(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var a=p(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,f;var o=a.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function F(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(F,this),this.reset(!0)}function R(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:T}}function T(){return{value:void 0,done:!0}}return m.prototype=g,s(w,"constructor",{value:g,configurable:!0}),s(g,"constructor",{value:m,configurable:!0}),m.displayName=d(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,d(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},x(C.prototype),d(C.prototype,l,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var s=new C(h(e,n,r,a),o);return t.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},x(w),d(w,u,"Generator"),d(w,c,(function(){return this})),d(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=R,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var i=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(i&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(i){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;E(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},698:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},687:(e,t,n)=>{var r=n(61)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function t(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}function r(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,s,i=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){l=!0,a=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw a}}return i}}(e,n)||t(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t,n,r,a,o,s){try{var i=e[o](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,a)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var s=e.apply(t,n);function i(e){a(s,r,o,i,c,"next",e)}function c(e){a(s,r,o,i,c,"throw",e)}i(void 0)}))}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function c(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===i(t)?t:String(t)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function u(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h,p,f,v,m,g,y,k=n(687),b=n.n(k),w="ID_NO_PASS_ERROR_MSG",x="ID_NO_APP_PASS_ERROR_MSG",C="ID_SET_BUTTON_BUY",S="ID_SET_BUTTON_SELL",A="ID_OFF",F="ID_READY",E="ID_NO_WALLET",I="ID_DISABLED_MSG",R="ID_WALLET_SYNC_PROGRESS",T="ID_HIDE_ADDITIONAL_SETTINGS",D="ID_SHOW_ADDITIONAL_SETTINGS",M="ID_BUY",P="ID_SELL",B="ID_NOT_SUPPORTED",O="ID_VERSION_NOT_SUPPORTED",L="ID_CONNECTION_FAILED",W="ID_ORDER_PREVIEW",q="ID_CALCULATING",N="ID_ESTIMATE_UNAVAILABLE",U="ID_NO_ZERO_RATE",V="ID_NO_ZERO_QUANTITY",_="ID_TRADE",z="ID_NO_ASSET_WALLET",j="ID_EXECUTED",H="ID_BOOKED",G="ID_CANCELING",K="ID_PASSWORD_NOT_MATCH",X="ID_ACCT_UNDEFINED",Y="ID_KEEP_WALLET_PASS",Q="ID_NEW_WALLET_PASS",J="ID_LOT",Z="ID_LOTS",$="ID_UNKNOWN",ee="ID_EPOCH",te="ID_ORDER_SUBMITTING",ne="ID_SETTLING",re="ID_NO_MATCH",ae="ID_CANCELED",oe="ID_REVOKED",se="ID_WAITING_FOR_CONFS",ie="ID_NONE_SELECTED",ce="ID_REGISTRATION_FEE_SUCCESS",le="ID_API_ERROR",ue="ID_ADD",de="ID_CREATE",he="ID_SETUP_WALLET",pe="ID_WALLET_READY",fe="ID_CHANGE_WALLET_TYPE",ve="ID_KEEP_WALLET_TYPE",me="WALLET_READY",ge="WALLET_PENDING",ye="SETUP_NEEDED",ke="SEND_SUCCESS",be="RECONFIG_SUCCESS",we="RESCAN_STARTED",xe="NEW_WALLET_SUCCESS",Ce="WALLET_UNLOCKED",Se="ID_SELLING",Ae="ID_BUYING",Fe="WALLET_DISABLED",Ee="WALLET_ENABLED",Ie="ACTIVE_ORDERS_ERR_MSG",Re="AVAILABLE",Te="LOCKED",De="IMMATURE",Me="FEE_BALANCE",Pe="CANDLES_LOADING",Be="DEPTH_LOADING",Oe="INVALID_ADDRESS_MSG",Le="TXFEE_ERR_MSG",We="ACTIVE_ORDERS_LOGOUT_ERR_MSG",qe="INVALID_DATE_ERR_MSG",Ne="NO_ARCHIVED_RECORDS",Ue="DELETE_ARCHIVED_RECORDS_RESULT",Ve="ARCHIVED_RECORDS_PATH",_e="DEFAULT",ze="USER_ADDED",je="DISCOVERED",He="UNSUPPORTED_ASSET_INFO_ERR_MSG",Ge="LIMIT_ORDER",Ke="LIMIT_ORDER_IMMEDIATE_TIF",Xe="MARKET_ORDER",Ye="MATCH_STATUS_NEWLY_MATCHED",Qe="MATCH_STATUS_MAKER_SWAP_CAST",Je="MATCH_STATUS_TAKER_SWAP_CAST",Ze="MATCH_STATUS_MAKER_REDEEMED",$e="MATCH_STATUS_REDEMPTION_SENT",et="MATCH_REDEMPTION_CONFIRMED",tt="MATCH_STATUS_REVOKED",nt="MATCH_STATUS_REFUNDED",rt="MATCH_STATUS_REFUND_PENDING",at="MATCH_STATUS_REDEEM_PENDING",ot="MATCH_STATUS_COMPLETE",st="TAKER_FOUND_MAKER_REDEMPTION",it="OPEN_WALLET_ERR_MSG",ct="ORDER_ACCELERATION_FEE_ERR_MSG",lt="ORDER_ACCELERATION_ERR_MSG",ut="CONNECTED",dt="DISCONNECTED",ht="INVALID_CERTIFICATE",pt="ID_CONFIRMATIONS",ft="TAKER",vt="MAKER",mt="EMPTY_DEX_ADDRESS_MSG",gt="SELECT_WALLET_FOR_FEE_PAYMENT",yt="UNAVAILABLE",kt="WALLET_SYNC_FINISHING_UP",bt="CONNECTING_WALLET_ERR_MSG",wt="REFUND_IMMINENT",xt="REFUND_WILL_HAPPEN_AFTER",Ct="AVAILABLE_TITLE",St="LOCKED_TITLE",At="IMMATURE_TITLE",Ft="SWAPPING",Et="BONDED",It="LOCKED_BAL_MSG",Rt="IMMATURE_BAL_MSG",Tt="LOCKED_SWAPPING_BAL_MSG",Dt="LOCKED_BOND_BAL_MSG",Mt="RESERVES_DEFICIT",Pt="RESERVES_DEFICIT_MSG",Bt="BOND_RESERVES",Ot="BOND_RESERVES_MSG",Lt="SHIELDED",Wt="SHIELDED_MSG",qt="ORDER",Nt="LOCKED_ORDER_BAL_MSG",Ut="CREATING_WALLETS",Vt="ADDING_SERVER",_t="WALLET_RECOVERY_SUPPORT_MSG",zt="TICKETS_PURCHASED",jt="TICKET_STATUS_UNKNOWN",Ht="TICKET_STATUS_UNMINED",Gt="TICKET_STATUS_IMMATURE",Kt="TICKET_STATUS_LIVE",Xt="TICKET_STATUS_VOTED",Yt="TICKET_STATUS_MISSED",Qt="TICKET_STATUS_EXPIRED",Jt="TICKET_STATUS_UNSPENT",Zt="TICKET_STATUS_REVOKED",$t="INVALID_SEED",en="PASSWORD_RESET_SUCCESS_MSG ",tn="ID_BROWSER_NTFN_ENABLED",nn="ID_BROWSER_NTFN_ORDERS",rn="ID_BROWSER_NTFN_MATCHES",an="ID_BROWSER_NTFN_BONDS",on="ID_BROWSER_NTFN_CONNECTIONS",sn=(d(h={},w,"password cannot be empty"),d(h,x,"app password cannot be empty"),d(h,K,"passwords do not match"),d(h,C,"Place order to buy  {{ asset }}"),d(h,S,"Place order to sell {{ asset }}"),d(h,A,"off"),d(h,F,"ready"),d(h,Te,"locked"),d(h,E,"no wallet"),d(h,R,"wallet is {{ syncProgress }}% synced"),d(h,T,"hide additional settings"),d(h,D,"show additional settings"),d(h,M,"Buy"),d(h,P,"Sell"),d(h,B,"{{ asset }} is not supported"),d(h,O,"{{ asset }} (v{{version}}) is not supported"),d(h,L,"Connection to dex server failed. You can close dexc and try again later or wait for it to reconnect."),d(h,W,"Total: {{ total }} {{ asset }}"),d(h,q,"calculating..."),d(h,N,"estimate unavailable"),d(h,U,"zero rate not allowed"),d(h,V,"zero quantity not allowed"),d(h,_,"trade"),d(h,z,"No {{ asset }} wallet"),d(h,j,"executed"),d(h,H,"booked"),d(h,G,"canceling"),d(h,X,"Account undefined."),d(h,Y,"keep current wallet password"),d(h,Q,"set a new wallet password"),d(h,J,"lot"),d(h,Z,"lots"),d(h,$,"unknown"),d(h,ee,"epoch"),d(h,ne,"settling"),d(h,re,"no match"),d(h,ae,"canceled"),d(h,oe,"revoked"),d(h,se,"Waiting for confirmations..."),d(h,ie,"none selected"),d(h,ce,"Fidelity bond accepted!"),d(h,le,"API error"),d(h,ue,"Add"),d(h,de,"Create"),d(h,pe,"Ready"),d(h,he,"Setup"),d(h,fe,"change the wallet type"),d(h,ve,"don't change the wallet type"),d(h,me,"Wallet Ready"),d(h,ye,"Setup Needed"),d(h,ge,"Creating Wallet"),d(h,ke,"{{ assetName }} Sent!"),d(h,be,"Wallet Reconfigured!"),d(h,we,"Wallet Rescan Running"),d(h,xe,"{{ assetName }} Wallet Created!"),d(h,Ce,"Wallet Unlocked"),d(h,Se,"Selling"),d(h,Ae,"Buying"),d(h,Ee,"{{ assetName }} Wallet Enabled"),d(h,Fe,"{{ assetName }} Wallet Disabled"),d(h,I,"wallet is disabled"),d(h,Ie,"{{ assetName }} wallet is actively managing orders"),d(h,Re,"available"),d(h,De,"immature"),d(h,Me,"fee balance"),d(h,Pe,"waiting for candlesticks"),d(h,Be,"retrieving depth data"),d(h,Oe,"invalid address: {{ address }}"),d(h,"TXFEE_UNSUPPORTED","fee estimation is not supported for this wallet type"),d(h,Le,"fee estimation failed: {{ err }}"),d(h,We,"cannot logout with active orders"),d(h,qe,"error: invalid date or time"),d(h,Ne,"No archived records found"),d(h,Ue,"Message: {{ nRecords }} archived records has been deleted"),d(h,Ve,"File Location: {{ path }}"),d(h,te,"submitting"),d(h,_e,"Default"),d(h,ze,"Added"),d(h,je,"Discovered"),d(h,He,"no supported asset info for id = {{ assetID }}, and no exchange info provided"),d(h,Ge,"limit"),d(h,Ke,"limit (i)"),d(h,Xe,"market"),d(h,Ye,"Newly Matched"),d(h,Qe,"Maker Swap Sent"),d(h,Je,"Taker Swap Sent"),d(h,Ze,"Maker Redeemed"),d(h,$e,"Redemption Sent"),d(h,tt,"Revoked - {{ status }}"),d(h,rt,"Refund PENDING"),d(h,nt,"Refunded"),d(h,at,"Redeem PENDING"),d(h,et,"Redemption Confirmed"),d(h,ot,"Complete"),d(h,it,"Error opening wallet: {{ msg }}"),d(h,ct,"Error estimating acceleration fee: {{ msg }}"),d(h,lt,"Error accelerating order: {{ msg }}"),d(h,ut,"Connected"),d(h,dt,"Disconnected"),d(h,ht,"Invalid Certificate"),d(h,pt,"confirmations"),d(h,ft,"Taker"),d(h,vt,"Maker"),d(h,yt,"unavailable"),d(h,mt,"DEX address cannot be empty"),d(h,gt,"Select a valid wallet to post a bond"),d(h,kt,"finishing up"),d(h,bt,"Failed to connect {{ assetName }} wallet: {{ errMsg }}"),d(h,st,"Redeemed by {{ makerAddr }}"),d(h,wt,"Will happen in the next few blocks"),d(h,xt,"Refund will happen after {{ refundAfterTime }}"),d(h,Ct,"Available"),d(h,St,"Locked"),d(h,At,"Immature"),d(h,Ft,"Swapping"),d(h,Et,"Bonded"),d(h,It,"Total funds temporarily locked to cover the costs of your bond maintenance, live orders, matches and other activities"),d(h,Rt,"Incoming funds awaiting confirmation"),d(h,Tt,"Funds currently locked in settling matches"),d(h,Dt,"Funds locked in active bonds"),d(h,Mt,"Reserves Deficit"),d(h,Pt,"The apparent wallet balance shortcoming to maintain bonding level. If this persists, you may need to add funds to stay fully bonded."),d(h,Bt,"Bond Reserves"),d(h,Ot,"Funds reserved to cover the expenses associated with bond maintenance"),d(h,Lt,"Shielded"),d(h,Wt,"Total funds kept shielded"),d(h,qt,"Order"),d(h,Nt,"Funds locked in unmatched orders"),d(h,Ut,"Creating wallets"),d(h,Vt,"Connecting to servers"),d(h,_t,'Native {{ walletSymbol }} wallet failed to load properly. Try clicking the "Recover" button below to fix it'),d(h,zt,"Purchased {{ n }} Tickets!"),d(h,jt,"unknown"),d(h,Ht,"unmined"),d(h,Gt,"immature"),d(h,Kt,"live"),d(h,Xt,"voted"),d(h,Yt,"missed"),d(h,Qt,"expired"),d(h,Jt,"unspent"),d(h,Zt,"revoked"),d(h,$t,"Invalid seed"),d(h,en,"Your password reset was successful. You can proceed to login with your new password."),d(h,tn,"DCRDEX notifications enabled"),d(h,nn,"Orders"),d(h,rn,"Matches"),d(h,an,"Bonds"),d(h,on,"Server connections"),h),cn=(d(p={},w,"senha não pode ser vazia"),d(p,x,"senha do app não pode ser vazia"),d(p,K,"senhas diferentes"),d(p,C,"Ordem de compra de {{ asset }}"),d(p,S,"Ordem de venda de {{ asset }}"),d(p,A,"desligar"),d(p,F,"pronto"),d(p,Te,"trancado"),d(p,E,"sem carteira"),d(p,R,"carteira está {{ syncProgress }}% sincronizada"),d(p,T,"esconder configurações adicionais"),d(p,D,"mostrar configurações adicionais"),d(p,M,"Comprar"),d(p,P,"Vender"),d(p,B,"{{ asset }} não tem suporte"),d(p,L,"Conexão ao server dex falhou. Pode fechar dexc e tentar novamente depois ou esperar para tentar se reconectar."),d(p,W,"Total: {{ total }} {{ asset }}"),d(p,q,"calculando..."),d(p,N,"estimativa indisponível"),d(p,U,"taxa não pode ser zero"),d(p,V,"quantidade não pode ser zero"),d(p,_,"troca"),d(p,z,"Sem carteira {{ asset }}"),d(p,j,"executado"),d(p,H,"reservado"),d(p,G,"cancelando"),d(p,X,"conta não definida."),d(p,Y,"manter senha da carteira"),d(p,Q,"definir nova senha para carteira"),d(p,J,"lote"),d(p,Z,"lotes"),d(p,$,"desconhecido"),d(p,ee,"epoque"),d(p,ne,"assentando"),d(p,re,"sem combinações"),d(p,ae,"cancelado"),d(p,oe,"revocado"),d(p,se,"Esperando confirmações..."),d(p,ie,"nenhuma selecionado"),d(p,ce,"Sucesso no pagamento da taxa de registro!"),d(p,le,"Erro de API"),d(p,ue,"Adicionar"),d(p,de,"Criar"),d(p,pe,"Escolher"),d(p,he,"Configurar"),d(p,fe,"trocar o tipo de carteira"),d(p,ve,"Não trocara tipo de carteira"),d(p,me,"Carteira Pronta"),d(p,ye,"Configuração Necessária"),d(p,Re,"disponível"),d(p,De,"imaturo"),p),ln=(d(f={},w,"密码不能为空"),d(f,x,"应用密码不能为空"),d(f,K,"密码不相同"),d(f,C,"来自{{ asset }}的买入订单"),d(f,S,"来自{{ asset }}的卖出订单"),d(f,A,"关闭"),d(f,F,"准备就绪"),d(f,Te,"锁"),d(f,E,"未连接钱包"),d(f,R,"钱包同步进度{{ syncProgress }}%"),d(f,T,"隐藏其它设置"),d(f,D,"显示其它设置"),d(f,M,"买入"),d(f,P,"卖出"),d(f,B,"{{ asset }}不受支持"),d(f,L,"连接到服务器 dex 失败。您可以关闭 dexc 并稍后重试或等待尝试重新连接。"),d(f,W,"总计： {{ total }} {{ asset }}"),d(f,q,"计算中..."),d(f,N,"估计不可用"),d(f,U,"汇率不能为零"),d(f,V,"数量不能为零"),d(f,_,"交易"),d(f,z,"没有钱包 {{ asset }}"),d(f,j,"执行"),d(f,H,"保留"),d(f,G,"取消"),d(f,X,"帐户未定义。"),d(f,Y,"保留钱包密码"),d(f,Q,"设置新的钱包密码"),d(f,J,"批处理"),d(f,Z,"批"),d(f,ee,"时间"),d(f,le,"接口错误"),d(f,ue,"添加"),d(f,de,"创建"),d(f,Re,"可用"),d(f,De,"不成熟"),f),un=(d(v={},w,"hasło nie może być puste"),d(v,x,"hasło aplikacji nie może być puste"),d(v,K,"hasła nie są jednakowe"),d(v,C,"Złóż zlecenie, aby kupić  {{ asset }}"),d(v,S,"Złóż zlecenie, aby sprzedać {{ asset }}"),d(v,A,"wyłączony"),d(v,F,"gotowy"),d(v,Te,"zablokowany"),d(v,E,"brak portfela"),d(v,R,"portfel zsynchronizowany w {{ syncProgress }}%"),d(v,T,"ukryj dodatkowe ustawienia"),d(v,D,"pokaż dodatkowe ustawienia"),d(v,M,"Kup"),d(v,P,"Sprzedaj"),d(v,B,"{{ asset }} nie jest wspierany"),d(v,L,"Połączenie z serwerem dex nie powiodło się. Możesz zamknąć dexc i spróbować ponownie później, lub poczekać na wznowienie połączenia."),d(v,W,"W sumie: {{ total }} {{ asset }}"),d(v,q,"obliczanie..."),d(v,N,"brak szacunkowego wyliczenia"),d(v,U,"zero nie może być ceną"),d(v,V,"zero nie może być ilością"),d(v,_,"handluj"),d(v,z,"Brak portfela {{ asset }}"),d(v,j,"wykonano"),d(v,H,"zapisano"),d(v,G,"anulowanie"),d(v,X,"Niezdefiniowane konto."),d(v,Y,"zachowaj obecne hasło portfela"),d(v,Q,"ustaw nowe hasło portfela"),d(v,J,"lot"),d(v,Z,"loty(ów)"),d(v,$,"nieznane"),d(v,ee,"epoka"),d(v,ne,"rozliczanie"),d(v,re,"brak spasowania"),d(v,ae,"anulowano"),d(v,oe,"unieważniono"),d(v,se,"Oczekiwanie na potwierdzenia..."),d(v,ie,"brak zaznaczenia"),d(v,ce,"Płatność rejestracyjna powiodła się!"),d(v,le,"błąd API"),d(v,ue,"Dodaj"),d(v,de,"Utwórz"),d(v,pe,"Gotowy"),d(v,he,"Konfiguracja"),d(v,fe,"zmień typ portfela"),d(v,ve,"nie zmieniaj typu portfela"),d(v,me,"Portfel jest gotowy"),d(v,ye,"Potrzebna konfiguracja"),d(v,Re,"dostępne"),d(v,De,"niedojrzałe"),v),dn=(d(m={},w,"Passwort darf nicht leer sein"),d(m,x,"App-Passwort darf nicht leer sein"),d(m,K,"Passwörter stimmen nicht überein"),d(m,C,"Platziere Auftrag zum Kauf von  {{ asset }}"),d(m,S,"Platziere Auftrag zum Verkauf von {{ asset }}"),d(m,A,"aus"),d(m,F,"bereit"),d(m,Te,"gesperrt"),d(m,E,"kein Wallet"),d(m,R,"Wallet ist zu {{ syncProgress }}% synchronisiert"),d(m,T,"zusätzliche Einstellungen ausblenden"),d(m,D,"zusätzliche Einstellungen anzeigen"),d(m,M,"Kaufen"),d(m,P,"Verkaufen"),d(m,B,"{{ asset }} wird nicht unterstützt"),d(m,L,"Die Verbindung zum Dex-Server fehlgeschlagen. Du kannst dexc schließen und es später erneut versuchen oder warten bis die Verbindung wiederhergestellt ist."),d(m,W,"Insgesamt: {{ total }} {{ asset }}"),d(m,q,"kalkuliere..."),d(m,N,"Schätzung nicht verfügbar"),d(m,U,"Null-Satz nicht erlaubt"),d(m,V,"Null-Menge nicht erlaubt"),d(m,_,"Handel"),d(m,z,"Kein {{ asset }} Wallet"),d(m,j,"ausgeführt"),d(m,H,"gebucht"),d(m,G,"Abbruch"),d(m,X,"Account undefiniert."),d(m,Y,"aktuelles Passwort für das Wallet behalten"),d(m,Q,"ein neues Passwort für das Wallet festlegen"),d(m,J,"Lot"),d(m,Z,"Lots"),d(m,$,"unbekannt"),d(m,ee,"Epoche"),d(m,ne,"Abwicklung"),d(m,re,"kein Match"),d(m,ae,"abgebrochen"),d(m,oe,"widerrufen"),d(m,se,"Warten auf Bestätigungen..."),d(m,ie,"keine ausgewählt"),d(m,ce,"Zahlung der Registrierungsgebühr erfolgreich!"),d(m,le,"API Fehler"),d(m,ue,"Hinzufügen"),d(m,de,"Erstellen"),d(m,pe,"Bereit"),d(m,he,"Einrichten"),d(m,fe,"den Wallet-Typ ändern"),d(m,ve,"den Wallet-Typ nicht ändern"),d(m,me,"Wallet bereit"),d(m,ye,"Einrichtung erforderlich"),d(m,ge,"Erstelle Wallet"),d(m,ke,"{{ assetName }} gesendet!"),d(m,be,"Wallet neu konfiguriert!"),d(m,we,"Wallet Rescan läuft"),d(m,xe,"{{ assetName }} Wallet erstellt!"),d(m,Ce,"Wallet entsperrt"),m),hn=(d(g={},w,"لا يمكن أن تكون كلمة المرور فارغة"),d(g,x,"لا يمكن أن تكون كلمة مرور التطبيق فارغة"),d(g,K,"كلمات المرور غير متطابقة"),d(g,C,"ضع طلبًا للشراء  {{ asset }}"),d(g,S,"ضع طلبًا للبيع {{ asset }}"),d(g,A,"إيقاف"),d(g,F,"متوقف"),d(g,Te,"مقفل"),d(g,E,"لا توجد أي محفظة"),d(g,R,"تمت مزامنة {{ syncProgress }}% المحفظة"),d(g,T,"إخفاء الإعدادات الإضافية"),d(g,D,"عرض الإعدادات الإضافية"),d(g,M,"شراء"),d(g,P,"بيع"),d(g,B,"{{ asset }} غير مدعوم"),d(g,L,"فشل الاتصال بخادم dex. يمكنك إغلاق dexc والمحاولة مرة أخرى لاحقًا أو انتظار إعادة الاتصال."),d(g,W,"إجمالي: {{ total }} {{ asset }}"),d(g,q,"جاري الحساب ..."),d(g,N,"التقديرات غير متاحة"),d(g,U,"معدل الصفر غير مسموح به"),d(g,V,"غير مسموح بالكمية الصفرية"),d(g,_,"التداول"),d(g,z,"لا توجد {{ asset }} محفظة"),d(g,j,"تم تنفيذها"),d(g,H,"تم الحجز"),d(g,G,"جارٍ الإلغاء"),d(g,X,"حساب غير محدد."),d(g,Y,"احتفظ بكلمة مرور المحفظة الحالية"),d(g,Q,"قم بتعيين كلمة مرور جديدة للمحفظة"),d(g,J,"الحصة"),d(g,Z,"الحصص"),d(g,$,"غير معروف"),d(g,ee,"الحقبة الزمنية"),d(g,ne,"الإعدادات"),d(g,re,"غير متطابقة"),d(g,ae,"ملغاة"),d(g,oe,"مستعادة"),d(g,se,"في انتظار التأكيدات ..."),d(g,ie,"لم يتم تحديد أي شيء"),d(g,ce,"تم دفع رسوم التسجيل بنجاح!"),d(g,le,"خطأ في واجهة برمجة التطبيقات"),d(g,ue,"إضافة"),d(g,de,"إنشاء"),d(g,pe,"جاهزة"),d(g,he,"إعداد"),d(g,fe,"تغيير نوع المحفظة"),d(g,ve,"لا تغير نوع المحفظة"),d(g,me,"المحفظة جاهزة"),d(g,ye,"الإعداد مطلوب"),d(g,ge,"إنشاء المحفظة"),d(g,ke,"{{ assetName }} تم الإرسال!"),d(g,be,"تمت إعادة تهيئة المحفظة!!"),d(g,we,"إعادة فحص المحفظة قيد التشغيل"),d(g,xe,"{{ assetName }} تم إنشاء المحفظة!"),d(g,Ce,"المحفظة غير مقفلة"),d(g,Se,"البيع"),d(g,Ae,"Bالشراء"),d(g,Ee,"{{ assetName }} المحفظة ممكنة"),d(g,Fe,"{{ assetName }} المحفظة معطلة"),d(g,I,"تم تعطيل المحفظة"),d(g,Ie,"{{ assetName }} تدير المحفظة  الطلبات بفعالية"),g),pn={"en-us":sn,"pt-br":cn,"zh-cn":ln,"pl-pl":un,"de-de":dn,ar:hn},fn=sn;function vn(e,t){return function(e,t){return e.replace(/{{\s?([^{}\s]*)\s?}}/g,(function(e,n){return t[n]}))}(y[e]||fn[e],t||{})}window.localeDiscrepancies=function(){for(var e=sn,t=0,n=Object.entries(pn);t<n.length;t++){var a=r(n[t],2),o=a[0],s=a[1];if(s!==e)for(var i=0,c=Object.entries(e);i<c.length;i++){var l=r(c[i],2),u=l[0],d=l[1];s[u]||console.log("".concat(o," needs a tranlation for: ").concat(d))}}};var mn,gn,yn,kn,bn=function(e){return e[e.Disconnected=0]="Disconnected",e[e.Connected=1]="Connected",e[e.InvalidCert=2]="InvalidCert",e}({}),wn=function(e){return e[e.Approved=0]="Approved",e[e.Pending=1]="Pending",e[e.NotApproved=2]="NotApproved",e}({}),xn=function(e){return e[e.Percentage=0]="Percentage",e[e.Amount=1]="Amount",e}({}),Cn=function(e){return e[e.WalletDefault=0]="WalletDefault",e[e.UserAdded=1]="UserAdded",e[e.Discovered=2]="Discovered",e}({});function Sn(){return mn}function An(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fn(e,t){return Fn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Fn(e,t)}function En(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fn(e,t)}function In(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return An(e)}function Rn(e){return Rn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Rn(e)}function Tn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Rn(e);if(t){var a=Rn(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return In(this,n)}}function Dn(e){var t=[e.booleanOptTmpl,e.rangeOptTmpl,e.orderOptTmpl];yn=t[0],kn=t[1],gn=t[2]}var Mn=new Intl.NumberFormat(navigator.languages,{minimumSignificantDigits:3,maximumSignificantDigits:3}),Pn=u((function e(t,n,r){var a=this;s(this,e),d(this,"opt",void 0),d(this,"node",void 0),d(this,"tmpl",void 0),d(this,"on",void 0),this.opt=t;var o=this.node=gn.cloneNode(!0),i=this.tmpl=br.parseTemplate(o);i.optName.textContent=t.displayname,i.tooltip.dataset.tooltip=t.description,n?i.chainIcon.src=br.logoPath(n):br.hide(i.chainIcon),this.on=!1,br.bind(o,"click",(function(){a.on||(a.on=!0,o.classList.add("selected"),r.enable())})),br.bind(i.toggle,"click",(function(e){a.on&&(e.stopPropagation(),a.on=!1,o.classList.remove("selected"),r.disable())}))})),Bn=function(e){En(n,e);var t=Tn(n);function n(e,r,a,o){var i;if(s(this,n),d(An(i=t.call(this,e,r,{enable:function(){return i.enable()},disable:function(){return i.disable()}})),"control",void 0),d(An(i),"changed",void 0),d(An(i),"dict",void 0),i.dict=a,i.changed=function(){return o()},void 0===e.boolean)throw Error("not a boolean opt");var c=e.boolean,l=i.control=yn.cloneNode(!0);return i.tmpl.controls.appendChild(l),br.parseTemplate(l).reason.textContent=c.reason,i.on=void 0!==a[e.key]?a[e.key]:e.default,i.on&&i.node.classList.add("selected"),i}return u(n,[{key:"store",value:function(){this.on===this.opt.default?delete this.dict[this.opt.key]:this.dict[this.opt.key]=this.on,this.changed()}},{key:"enable",value:function(){this.store()}},{key:"disable",value:function(){this.store()}}]),n}(Pn),On=function(e){En(n,e);var t=Tn(n);function n(e,r,a,o){var i;if(s(this,n),d(An(i=t.call(this,e,r,{enable:function(){return i.enable()},disable:function(){return i.disable()}})),"handler",void 0),d(An(i),"x",void 0),d(An(i),"changed",void 0),d(An(i),"dict",void 0),i.dict=a,i.changed=o,void 0===e.xyRange)throw Error("not an xy range opt");var c=e.xyRange,l=a[e.key];return i.on=void 0!==l,i.on?(i.node.classList.add("selected"),i.x=l):i.x=e.default,i.handler=new Ln(c,i.x,(function(e){i.x=e,i.dict[i.opt.key]=e}),(function(){i.changed()}),(function(){i.node.classList.add("selected")})),i.tmpl.controls.appendChild(i.handler.control),i}return u(n,[{key:"enable",value:function(){this.dict[this.opt.key]=this.x,this.changed()}},{key:"disable",value:function(){delete this.dict[this.opt.key],this.changed()}},{key:"setValue",value:function(e){this.handler.setValue(e),this.on=!0,this.node.classList.add("selected")}}]),n}(Pn),Ln=function(){function e(t,n,r,a,o,i,c,l){var u=this;s(this,e),d(this,"control",void 0),d(this,"cfg",void 0),d(this,"tmpl",void 0),d(this,"x",void 0),d(this,"scrollingX",void 0),d(this,"y",void 0),d(this,"r",void 0),d(this,"roundX",void 0),d(this,"roundY",void 0),d(this,"updated",void 0),d(this,"changed",void 0),d(this,"selected",void 0),d(this,"setConfig",void 0);var h=this.control=kn.cloneNode(!0),p=this.tmpl=br.parseTemplate(h);this.roundX=Boolean(c),this.roundY=Boolean(i),this.cfg=t,this.changed=a,this.selected=o,this.updated=r;var f=p.slider,v=p.handle,m=t.end.x-t.start.x,g=t.end.y-t.start.y,y=function(e){return(e-t.start.x)/m},k=function(e){m=e.end.x-e.start.x,g=e.end.y-e.start.y,t=u.cfg=e,p.rangeLblStart.textContent=t.start.label,p.rangeLblEnd.textContent=t.end.label,p.xUnit.textContent=t.xUnit,p.yUnit.textContent=t.yUnit,u.y=u.r*g+t.start.y,u.r=(u.y-t.start.y)/g,u.scrollingX=u.r*m+t.start.x};if(k(t),this.setConfig=function(e){k(e),u.accept(u.scrollingX)},this.r=y(n),this.scrollingX=this.x=n,this.y=this.r*g+t.start.y,this.accept(this.scrollingX,!0),!l){var b=function e(n){if("change"===n.type||n.target!==p.xInput){var r=p.xInput.value;if(r){var a=parseFloat(r);isNaN(a)||(u.scrollingX=Wn(a,t.start.x,t.end.x),u.r=y(u.scrollingX),u.y=u.r*g+t.start.y,u.accept(u.scrollingX))}br.hide(p.xInput),br.show(p.x),br.unbind(document,"click",e),u.changed()}};br.bind(p.x,"click",(function(e){br.hide(p.x),br.show(p.xInput),p.xInput.focus(),p.xInput.value=Mn.format(u.scrollingX),br.bind(document,"click",b),e.stopPropagation()})),br.bind(p.xInput,"change",b);var w=function e(n){if("change"===n.type||n.target!==p.yInput){var r=p.yInput.value;if(r){var a=parseFloat(r);isNaN(a)||(u.y=Wn(a,t.start.y,t.end.y),u.r=(u.y-t.start.y)/g,u.scrollingX=t.start.x+u.r*m,u.accept(u.scrollingX))}br.hide(p.yInput),br.show(p.y),br.unbind(document,"click",e),u.changed()}};br.bind(p.y,"click",(function(e){br.hide(p.y),br.show(p.yInput),p.yInput.focus(),p.yInput.value=Mn.format(u.y),br.bind(document,"click",w),e.stopPropagation()})),br.bind(p.yInput,"change",w),br.bind(v,"mousedown",(function(e){if(0===e.button){e.preventDefault(),u.selected();var n=e.pageX,r=f.clientWidth-v.offsetWidth,a=y(u.scrollingX)*r,o=function(e){e.preventDefault(),u.r=function(e){return Math.max(Math.min(a+(e.pageX-n),r),0)}(e)/r,u.scrollingX=u.r*m+t.start.x,u.y=u.r*g+t.start.y,u.accept(u.scrollingX)};br.bind(document,"mousemove",o),br.bind(document,"mouseup",(function e(t){o(t),br.unbind(document,"mousemove",o),br.unbind(document,"mouseup",e),u.changed()}))}}))}}return u(e,[{key:"accept",value:function(e,t){var n=this.tmpl;this.roundX&&(e=Math.round(e)),this.roundY&&(this.y=Math.round(this.y)),n.x.textContent=Mn.format(e),n.y.textContent=Mn.format(this.y),this.roundY&&(n.y.textContent="".concat(this.y)),n.handle.style.left="calc(".concat(100*this.r,"% - ").concat(14*this.r,"px)"),this.x=e,this.scrollingX=e,t||this.updated(e,this.y)}},{key:"setValue",value:function(e){var t=this.cfg;this.r=(e-t.start.x)/(t.end.x-t.start.x),this.y=t.start.y+this.r*(t.end.y-t.start.y),this.accept(e,!0)}}]),e}(),Wn=function(e,t,n){return e<t?t:e>n?n:e};function qn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Nn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function Nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Un=1,Vn=2,_n=1,zn=2,jn=3,Hn=0,Gn=1e8;function Kn(e){var t=e.sell?P:M,n=document.documentElement.lang.toLowerCase();return vn(t).toLocaleLowerCase(n)}function Xn(e){return e.type===Un?0===e.tif?vn(Ke):vn(Ge):vn(Xe)}function Yn(e){return e.type===Vn&&!e.sell}function Qn(e){if(!e.matches)return!1;var t,n=qn(e.matches);try{for(n.s();!(t=n.n()).done;)if(t.value.active)return!0}catch(e){n.e(e)}finally{n.f()}return!1}function Jn(e){if(!e.id)return vn(te);var t=Qn(e);switch(e.status){case 0:return vn($);case _n:return vn(ee);case zn:return e.cancelling?vn(G):t?"".concat(vn(H),"/").concat(vn(ne)):vn(H);case jn:return t?vn(ne):0===e.filled&&3!==e.type?vn(re):vn(j);case 4:return t?"".concat(vn(ae),"/").concat(vn(ne)):vn(ae);case 5:return t?"".concat(vn(oe),"/").concat(vn(ne)):vn(oe)}return vn($)}function Zn(e){if(!e.matches)return 0;var t=Yn(e)?function(e){return e.qty*e.rate/Gn}:function(e){return e.qty};return e.matches.reduce((function(e,n){return n.isCancel?e:e+t(n)}),0)}function $n(e){if(!e.matches)return 0;var t=Yn(e)?function(e){return e.qty*e.rate/Gn}:function(e){return e.qty};return e.matches.reduce((function(e,n){return n.isCancel?e:n.side===Hn&&n.status>=3||1===n.side&&n.status>=4?e+t(n):e}),0)}function er(e){var t;if(null===(t=e.matches)||void 0===t||!t.length)return vn(Xe);var n=br.formatCoinValue(Sn().conventionalRate(e.baseID,e.quoteID,tr(e)));return e.matches.length>1&&(n="~ "+n),n}function tr(e){var t;if(null===(t=e.matches)||void 0===t||!t.length)return 0;var n,r=0,a=0,o=qn(e.matches);try{for(o.s();!(n=o.n()).done;){var s=n.value;a+=s.qty,r+=s.rate*s.qty}}catch(e){o.e(e)}finally{o.f()}return r/a}function nr(e,t){return e*t/Gn}function rr(e){return vn(tt,{status:vn(e)})}function ar(e){return e.type===Un&&1===e.tif&&e.status<jn}function or(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return sr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){i=!0,o=e})),f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function sr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ir=new window.DOMParser,cr={0:"btc",42:"dcr",2:"ltc",5:"dash",20:"dgb",22:"mona",28:"vtc",3:"doge",145:"bch",60:"eth",136:"firo",133:"zec",966:"polygon",6e4:"dextt.eth",60001:"usdc.eth",966e3:"dextt.polygon",966001:"usdc.polygon",966002:"weth.polygon",966003:"wbtc.polygon",147:"zcl"},lr={};!function(){for(var e=0,t=Object.keys(cr);e<t.length;e++){var n=t[e];lr[cr[parseInt(n)]]=parseInt(n)}}();var ur=Object.values(cr),dr=Math.round(Math.log10(Gn)),hr=new Intl.NumberFormat(navigator.languages),pr=new Intl.NumberFormat(navigator.languages,{minimumSignificantDigits:4,maximumSignificantDigits:4}),fr=new Intl.NumberFormat(navigator.languages,{minimumFractionDigits:1,maximumFractionDigits:1}),vr={},mr={};function gr(e,t){return yr(mr,e,e,t)}function yr(e,t,n,r){var a="".concat(t,"-").concat(n),o=e[a];return o||(o=new Intl.NumberFormat(r||navigator.languages,{minimumFractionDigits:t,maximumFractionDigits:n}),e[a]=o),o}function kr(e,t){var n=8;if(t){var r=t.conventional.conversionFactor;e/=r,n=Math.round(Math.log10(r))}return[e,n]}var br=function(){function e(){s(this,e)}var t;return u(e,null,[{key:"idel",value:function(e,t){return e.querySelector("#".concat(t))}},{key:"bind",value:function(e,t,n){e.addEventListener(t,n)}},{key:"unbind",value:function(e,t,n){e.removeEventListener(t,n)}},{key:"noderize",value:function(e){return ir.parseFromString(e,"text/html")}},{key:"mouseInElement",value:function(e,t){if(t.contains(e.target))return!0;var n=t.getBoundingClientRect();return e.pageX>=n.left&&e.pageX<=n.right&&e.pageY>=n.top&&e.pageY<=n.bottom}},{key:"layoutMetrics",value:function(e){var t=e.getBoundingClientRect(),n=document.documentElement,r=t.top+n.scrollTop,a=t.left+n.scrollLeft,o=e.offsetWidth,s=e.offsetHeight;return{bodyTop:r,bodyLeft:a,width:o,height:s,centerX:a+o/2,centerY:r+s/2}}},{key:"descendentMetrics",value:function(t,n){var r=e.layoutMetrics(t),a=e.layoutMetrics(n);return{bodyTop:a.bodyTop-r.bodyTop,bodyLeft:a.bodyLeft-r.bodyLeft,width:a.width,height:a.height,centerX:a.centerX-r.bodyLeft,centerY:a.centerY-r.bodyTop}}},{key:"empty",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,a=t;r<a.length;r++)for(var o=a[r];o.firstChild;)o.removeChild(o.firstChild)}},{key:"setContent",value:function(t){e.empty(t);for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];for(var o=0,s=r;o<s.length;o++){var i=s[o];t.appendChild(i)}}},{key:"hide",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,a=t;r<a.length;r++)a[r].classList.add("d-hide")}},{key:"show",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,a=t;r<a.length;r++)a[r].classList.remove("d-hide")}},{key:"setVis",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];t?e.show.apply(e,r):e.hide.apply(e,r)}},{key:"isHidden",value:function(e){return e.classList.contains("d-hide")}},{key:"isDisplayed",value:function(e){return!e.classList.contains("d-hide")}},{key:"animate",value:(t=o(b().mark((function e(t,n,r){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new wr(t,n,r).wait();case 2:case"end":return e.stop()}}),e)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"applySelector",value:function(e,t){return Array.from(e.querySelectorAll(t))}},{key:"kids",value:function(e){return Array.from(e.children)}},{key:"safeSelector",value:function(e,t){return e.querySelector(t)||(console.warn("no element found for selector '".concat(t,"' on element ->"),e),document.createElement("div"))}},{key:"idDescendants",value:function(t){var n,r={},a=or(e.applySelector(t,"[id]"));try{for(a.s();!(n=a.n()).done;){var o=n.value;r[o.id]=o}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"formatCoinValue",value:function(e,t){var n=r(kr(e,t),2),a=n[0],o=n[1];return Number.isInteger(a)?hr.format(a):function(e){return yr(vr,2,e)}(o).format(a)}},{key:"conventionalCoinValue",value:function(e,t){return r(kr(e,t),1)[0]}},{key:"formatRateFullPrecision",value:function(e,t,n,r){var a=e*(t.conventional.conversionFactor/n.conventional.conversionFactor)/Gn;return gr(dr-Math.floor(Math.log10(r))-Math.floor(Math.log10(t.conventional.conversionFactor)-Math.log10(n.conventional.conversionFactor))).format(a)}},{key:"formatFourSigFigs",value:function(e){return function(e,t,n,r,a){if(n>=1e3)return e.format(n);var o=t.format(n);return o}(fr,pr,e)}},{key:"formatFullPrecision",value:function(e,t){var n=r(kr(e,t),2),a=n[0];return gr(n[1]).format(a)}},{key:"formatFiatConversion",value:function(e,t,n){if(!t||0===t)return vn(yt);var a=r(kr(e,n),1)[0]*t;return gr(2).format(a)}},{key:"conventionalRateStep",value:function(e,t,n){var r=[n.conventional.conversionFactor,t.conventional.conversionFactor];return e/Gn*(r[1]/r[0])}},{key:"logoPath",value:function(e){return-1===ur.indexOf(e)&&(e=e.substring(0,1)),e=e.split(".")[0],"/img/coins/".concat(e,".png")}},{key:"bipSymbol",value:function(e){return cr[e]}},{key:"bipIDFromSymbol",value:function(e){return lr[e]}},{key:"logoPathFromID",value:function(t){return e.logoPath(cr[t])}},{key:"symbolize",value:function(t,n){var r=t.unitInfo.conventional.unit,a=document.createElement("span");a.textContent=r.toUpperCase();var o=t.symbol.split(".");if(2!==o.length)return a;var s=o[1],i=document.createElement("span");if(i.appendChild(a),n){var c=document.createElement("img");return c.src=e.logoPath(s),c.classList.add("token-parent"),i.appendChild(c),i}var l=document.createElement("sup");return l.textContent=s.toUpperCase(),l.classList.add("token-parent"),i.appendChild(l),i}},{key:"shortSymbol",value:function(e){return e.split(".")[0].toUpperCase()}},{key:"cleanTemplates",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){e.remove(),e.removeAttribute("id")}))}},{key:"tmplElement",value:function(e,t){return e.querySelector('[data-tmpl="'.concat(t,'"]'))||document.createElement("div")}},{key:"parseTemplate",value:function(t){var n,r={},a=or(e.applySelector(t,"[data-tmpl]"));try{for(a.s();!(n=a.n()).done;){var o=n.value;r[o.dataset.tmpl||""]=o}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"timeSince",value:function(t){return e.formatDuration((new Date).getTime()-t)}},{key:"formatDuration",value:function(e){var t,n,a,o,s,i,c=Math.floor(e),l="",u=0,d=function(e,t){return(e>0||u>0)&&u++,e>0&&(l+="".concat(e," ").concat(t," ")),u>=2},h=r(Tr(c,Ar),2);if(t=h[0],c=h[1],d(t,"y"))return l;var p=r(Tr(c,Fr),2);if(n=p[0],c=p[1],d(n,"mo"))return l;var f=r(Tr(c,Er),2);if(a=f[0],c=f[1],d(a,"d"))return l;var v=r(Tr(c,Ir),2);if(o=v[0],c=v[1],d(o,"h"))return l;var m=r(Tr(c,Rr),2);if(s=m[0],c=m[1],d(s,"m"))return l;var g=r(Tr(c,1e3),2);return i=g[0],c=g[1],d(i,"s"),l||"0 s"}},{key:"disableMouseWheel",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,a=t;r<a.length;r++)a[r].addEventListener("wheel",(function(e){e.preventDefault()}))}},{key:"showFormError",value:function(t,n){t.textContent=n,e.show(t)}},{key:"showFiatValue",value:function(t,n,r,a){r?(t.textContent=e.formatFiatConversion(n,r,a),e.show(t.parentElement)):e.hide(t.parentElement)}}]),e}(),wr=function(){function e(t,n,r,a){s(this,e),d(this,"done",void 0),d(this,"endAnimation",void 0),d(this,"thread",void 0),this.done=a,this.thread=this.run(t,n,r)}var t,n,r;return u(e,[{key:"run",value:(r=o(b().mark((function t(n,r,a){var o,s,i,c,l,u;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=n>=0?n:31536e7,o=a?xr[a]:xr.linear,s=(new Date).getTime(),i=n===e.Forever?Number.MAX_SAFE_INTEGER:s+n,c=i-s,l=1e3/30,u=s,this.endAnimation=!1;case 8:if(!(u<i)){t.next=17;break}if(!this.endAnimation){t.next=11;break}return t.abrupt("return",this.runCompletionFunction());case 11:return r(o((u-s)/c)),t.next=14,Sr(l);case 14:u=(new Date).getTime(),t.next=8;break;case 17:r(1),this.runCompletionFunction();case 19:case"end":return t.stop()}}),t,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"wait",value:(n=o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.thread;case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"stop",value:function(){this.endAnimation=!0}},{key:"stopAndWait",value:(t=o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stop(),e.next=3,this.wait();case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"runCompletionFunction",value:function(){this.done&&this.done()}}]),e}();d(wr,"Forever",void 0),wr.Forever=-1;var xr={linear:function(e){return e},easeIn:function(e){return e*e},easeOut:function(e){return e*(2-e)},easeInHard:function(e){return e*e*e},easeOutHard:function(e){return--e*e*e+1},easeOutElastic:function(e){var t=2*Math.PI/3;return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin((10*e-.75)*t)+1}},Cr=function(){function e(t){s(this,e),d(this,"icons",void 0),d(this,"status",void 0);var n=function(e){return t.querySelector("[data-state=".concat(e,"]"))};this.icons={},this.icons.sleeping=n("sleeping"),this.icons.locked=n("locked"),this.icons.unlocked=n("unlocked"),this.icons.nowallet=n("nowallet"),this.icons.syncing=n("syncing"),this.icons.nopeers=n("nopeers"),this.icons.disabled=n("disabled"),this.status=n("status")}return u(e,[{key:"sleeping",value:function(){var e=this.icons;br.hide(e.locked,e.unlocked,e.nowallet,e.syncing,e.disabled),br.show(e.sleeping),this.status&&(this.status.textContent=vn(A))}},{key:"locked",value:function(){var e=this.icons;br.hide(e.unlocked,e.nowallet,e.sleeping,e.disabled),br.show(e.locked),this.status&&(this.status.textContent=vn(Te))}},{key:"unlocked",value:function(){var e=this.icons;br.hide(e.locked,e.nowallet,e.sleeping,e.disabled),br.show(e.unlocked),this.status&&(this.status.textContent=vn(F))}},{key:"nowallet",value:function(){var e=this.icons;br.hide(e.locked,e.unlocked,e.sleeping,e.syncing,e.disabled),br.show(e.nowallet),this.status&&(this.status.textContent=vn(E))}},{key:"disabled",value:function(){var e=this.icons;br.hide(e.locked,e.unlocked,e.sleeping,e.syncing,e.nowallet,e.nopeers),br.show(e.disabled),e.disabled.dataset.tooltip=vn(I)}},{key:"setSyncing",value:function(e){var t=this.icons.syncing;if(e&&e.running&&!e.disabled){if(0===e.peerCount)return br.show(this.icons.nopeers),void br.hide(t);if(br.hide(this.icons.nopeers),!e.synced)return br.show(t),void(t.dataset.tooltip=vn(R,{syncProgress:(100*e.syncProgress).toFixed(1)}));br.hide(t)}else br.hide(t)}},{key:"readWallet",value:function(e){if(this.setSyncing(e),!e)return this.nowallet();switch(!0){case e.disabled:this.disabled();break;case!e.running:this.sleeping();break;case!e.open:this.locked();break;case e.open:this.unlocked();break;default:console.error("wallet in unknown state",e)}}}]),e}();function Sr(e){return new Promise((function(t){return setTimeout(t,e)}))}var Ar=31536e6,Fr=2592e6,Er=864e5,Ir=36e5,Rr=6e4;function Tr(e,t){var n=Math.floor(e/t);return[n,e-n*t]}function Dr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Mr=function(){function e(){s(this,e)}return u(e,null,[{key:"setCookie",value:function(e,t){var n=new Date;n.setTime(n.getTime()+31536e7);var r="expires="+n.toUTCString();document.cookie=e+"="+t+";"+r+";path=/"}},{key:"getCookie",value:function(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Dr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}(document.cookie.split(";"));try{for(n.s();!(t=n.n()).done;){var a=r(t.value.split("="),2),o=a[0],s=a[1];if(o.trim()===e)return s}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"removeCookie",value:function(e){document.cookie="".concat(e,"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")}},{key:"isDark",value:function(){return document.cookie.split(";").filter((function(t){return t.includes("".concat(e.darkModeCK,"=1"))})).length}},{key:"passwordIsCached",value:function(){return!!this.getCookie(e.pwKeyCK)}},{key:"storeLocal",value:function(e,t){window.localStorage.setItem(e,JSON.stringify(t))}},{key:"fetchLocal",value:function(e){var t=window.localStorage.getItem(e);return null!==t?JSON.parse(t):null}},{key:"removeLocal",value:function(e){window.localStorage.removeItem(e)}}]),e}();d(Mr,"darkModeCK","darkMode"),d(Mr,"authCK","dexauth"),d(Mr,"pwKeyCK","sessionkey"),d(Mr,"popupsLK","popups"),d(Mr,"loggersLK","loggers"),d(Mr,"recordersLK","recorders"),d(Mr,"lastMarketLK","selectedMarket"),d(Mr,"depthZoomLK","depthZoom"),d(Mr,"lastMMMarketLK","mmMarket"),d(Mr,"optionsExpansionLK","mmOptsExpand"),d(Mr,"leftMarketDockLK","leftmarketdock"),d(Mr,"selectedAssetLK","selectedasset"),d(Mr,"notificationsLK","notifications"),d(Mr,"orderDisclaimerAckedLK","ordAck"),d(Mr,"lastCandleDurationLK","lastCandleDuration"),null===Mr.getCookie(Mr.darkModeCK)&&Mr.setCookie(Mr.darkModeCK,"1"),null===Mr.fetchLocal(Mr.popupsLK)&&Mr.storeLocal(Mr.popupsLK,"1"),null===Mr.fetchLocal(Mr.leftMarketDockLK)&&Mr.storeLocal(Mr.leftMarketDockLK,"1");var Pr=function(){function e(){s(this,e)}return u(e,[{key:"unload",value:function(){}}]),e}();function Br(e,t,n){return Or.apply(this,arguments)}function Or(){return(Or=o(b().mark((function e(t,n,r){var a,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.fetch(n,{method:t,headers:new window.Headers({"content-type":"application/json"}),body:r});case 3:if(200===(a=e.sent).status){e.next=6;break}throw a;case 6:return e.next=8,a.json();case 8:return(o=e.sent).requestSuccessful=!0,e.abrupt("return",o);case 13:return e.prev=13,e.t0=e.catch(0),e.t0.requestSuccessful=!1,e.next=18,e.t0.text();case 18:return e.t0.msg=e.sent,e.abrupt("return",e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}function Lr(e,t){return Wr.apply(this,arguments)}function Wr(){return(Wr=o(b().mark((function e(t,n){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Br("POST",t,JSON.stringify(n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qr(e){return Nr.apply(this,arguments)}function Nr(){return(Nr=o(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Br("GET",t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ur=function(e){return e[e.walletErr=0]="walletErr",e[e.walletAuthErr=1]="walletAuthErr",e[e.walletBalanceErr=2]="walletBalanceErr",e[e.dupeDEXErr=3]="dupeDEXErr",e[e.assetSupportErr=4]="assetSupportErr",e[e.registerErr=5]="registerErr",e[e.signatureErr=6]="signatureErr",e[e.zeroFeeErr=7]="zeroFeeErr",e[e.feeMismatchErr=8]="feeMismatchErr",e[e.feeSendErr=9]="feeSendErr",e[e.passwordErr=10]="passwordErr",e[e.emptyHostErr=11]="emptyHostErr",e[e.connectionErr=12]="connectionErr",e[e.acctKeyErr=13]="acctKeyErr",e[e.unknownOrderErr=14]="unknownOrderErr",e[e.orderParamsErr=15]="orderParamsErr",e[e.dbErr=16]="dbErr",e[e.authErr=17]="authErr",e[e.connectWalletErr=18]="connectWalletErr",e[e.missingWalletErr=19]="missingWalletErr",e[e.encryptionErr=20]="encryptionErr",e[e.decodeErr=21]="decodeErr",e[e.accountVerificationErr=22]="accountVerificationErr",e[e.accountProofErr=23]="accountProofErr",e[e.parseKeyErr=24]="parseKeyErr",e[e.marketErr=25]="marketErr",e[e.addressParseErr=26]="addressParseErr",e[e.addrErr=27]="addrErr",e[e.fileReadErr=28]="fileReadErr",e[e.unknownDEXErr=29]="unknownDEXErr",e[e.accountRetrieveErr=30]="accountRetrieveErr",e[e.accountDisableErr=31]="accountDisableErr",e[e.suspendedAcctErr=32]="suspendedAcctErr",e[e.existenceCheckErr=33]="existenceCheckErr",e[e.createWalletErr=34]="createWalletErr",e[e.activeOrdersErr=35]="activeOrdersErr",e[e.newAddrErr=36]="newAddrErr",e}({});function Vr(n){return function(t){if(Array.isArray(t))return e(t)}(n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||t(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Rn(e);if(t){var a=Rn(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return In(this,n)}}function zr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return jr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){i=!0,o=e})),f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function jr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Hr=br.bind,Gr=2*Math.PI,Kr=String.fromCharCode(59914),Xr=String.fromCharCode(59915),Yr={axisLabel:"#b1b1b1",gridBorder:"#383f4b",gridLines:"#383f4b",gapLine:"#6b6b6b",value:"#9a9a9a",zoom:"#5b5b5b",zoomHover:"#aaa",sellLine:"#ae3333",buyLine:"#05a35a",sellFill:"#591a1a",buyFill:"#02572f",crosshairs:"#888",legendFill:"black",legendText:"#d5d5d5"},Qr={axisLabel:"#1b1b1b",gridBorder:"#ddd",gridLines:"#ddd",gapLine:"#595959",value:"#4d4d4d",zoom:"#777",zoomHover:"#333",sellLine:"#99302b",buyLine:"#207a46",sellFill:"#bd5959",buyFill:"#4cad75",crosshairs:"#595959",legendFill:"#e6e6e6",legendText:"#1b1b1b"},Jr=function(){function e(t,n){var r=this;s(this,e),d(this,"parent",void 0),d(this,"report",void 0),d(this,"theme",void 0),d(this,"canvas",void 0),d(this,"visible",void 0),d(this,"renderScheduled",void 0),d(this,"ctx",void 0),d(this,"mousePos",void 0),d(this,"rect",void 0),d(this,"wheelLimiter",void 0),d(this,"boundResizer",void 0),d(this,"plotRegion",void 0),d(this,"xRegion",void 0),d(this,"yRegion",void 0),d(this,"dataExtents",void 0),d(this,"unattachers",void 0),this.parent=t,this.report=n,this.theme=Mr.isDark()?Yr:Qr,this.canvas=document.createElement("canvas"),this.visible=!0,t.appendChild(this.canvas);var a=this.canvas.getContext("2d");if(a){this.ctx=a,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.mousePos=null,Hr(this.canvas,"mousemove",(function(e){r.rect&&(r.mousePos={x:e.clientX-r.rect.left,y:e.clientY-r.rect.y},r.draw())})),Hr(this.canvas,"mouseleave",(function(){r.mousePos=null,r.draw()})),new ResizeObserver((function(){return r.resize()})).observe(this.parent),this.wheelLimiter=null,Hr(this.canvas,"wheel",(function(e){r.wheel(e)})),Hr(this.canvas,"click",(function(e){r.click(e)}));var o=function(){r.visible="hidden"!==document.visibilityState,r.visible&&r.renderScheduled&&(r.renderScheduled=!1,r.draw())};Hr(document,"visibilitychange",o),this.unattachers=[function(){br.unbind(document,"visibilitychange",o)}]}else console.error("error getting canvas context")}return u(e,[{key:"wheeled",value:function(){var e=this;this.wheelLimiter=window.setTimeout((function(){e.wheelLimiter=null}),100)}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"draw",value:function(){this.render()}},{key:"click",value:function(e){this.report.click(e)}},{key:"wheel",value:function(e){this.zoom(e.deltaY<0),e.preventDefault()}},{key:"resize",value:function(){var e=this;this.canvas.width=this.parent.clientWidth,this.canvas.height=this.parent.clientHeight;var t=new ta(40,this.canvas.width,10,this.canvas.height-30),n=new ta(40,this.canvas.width,this.canvas.height-30,this.canvas.height),r=new ta(0,40,10,this.canvas.height-30);this.plotRegion=new na(this.ctx,t),this.xRegion=new na(this.ctx,n),this.yRegion=new na(this.ctx,r),window.requestAnimationFrame((function(){e.rect=e.canvas.getBoundingClientRect(),e.report.resize()}))}},{key:"zoom",value:function(e){this.wheelLimiter||this.report.zoom(e)}},{key:"unattach",value:function(){var e,t=zr(this.unattachers);try{for(t.s();!(e=t.n()).done;)(0,e.value)()}catch(e){t.e(e)}finally{t.f()}this.unattachers=[]}},{key:"render",value:function(){console.error("child class must override render method")}},{key:"applyLabelStyle",value:function(e){this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.font="".concat(null!=e?e:"14","px 'sans', sans-serif"),this.ctx.fillStyle=this.theme.axisLabel}},{key:"plotXLabels",value:function(e,t,n,r){var a=this,o=new ta(t,n,0,1);this.xRegion.plot(o,(function(o,s){a.applyLabelStyle();var i=(n+t)/2,c=t,l=i;e.lbls.forEach((function(e){o.fillText(e.txt,s.x(e.val),s.y(.5)),i>=c&&i<e.val&&(l=(c+e.val)/2),c=e.val})),o.font="11px 'sans', sans-serif",2===r.length?(o.fillText(r[0],s.x(l),s.y(.63)),o.fillText(r[1],s.x(l),s.y(.23))):1===r.length&&o.fillText(r[0],s.x(l),s.y(.5))}),!0),this.plotRegion.plot(o,(function(t,n){t.lineWidth=1,t.strokeStyle=a.theme.gridLines,e.lbls.forEach((function(e){sa(t,n.x(e.val),n.y(0),n.x(e.val),n.y(1))}))}),!0)}},{key:"plotYLabels",value:function(e,t,n,r,a){var o=this,s=new ta(0,1,n,r);this.yRegion.plot(s,(function(e,n){o.applyLabelStyle();var s=r/2,i=0,c=s;t.lbls.forEach((function(t){e.fillText(t.txt,n.x(.5),n.y(t.val)),s>=i&&s<t.val&&(c=(i+t.val)/2),i=t.val})),e.fillText(a,n.x(.5),n.y(c))}),!0),e.plot(s,(function(e,n){e.lineWidth=1,e.strokeStyle=o.theme.gridLines,t.lbls.forEach((function(t){sa(e,n.x(0),n.y(t.val),n.x(1),n.y(t.val))}))}),!0)}},{key:"doYLabels",value:function(e,t,n,r){this.applyLabelStyle();var a=ra(this.ctx,e.height(),this.dataExtents.y.min,this.dataExtents.y.max,50,t,n,r),o=(a.widest||0)+20;return this.yRegion.extents.x.max=o,this.yRegion.extents.y.max=e.extents.y.max,this.plotRegion.extents.x.min=o,this.xRegion.extents.x.min=o,this.plotYLabels(e,a,this.dataExtents.y.min,this.dataExtents.y.max,n),a}},{key:"drawFrame",value:function(){var e=this;this.plotRegion.plot(new ta(0,1,0,1),(function(t,n){t.lineWidth=1,t.strokeStyle=e.theme.gridBorder,t.beginPath(),t.moveTo(n.x(0),n.y(0)),t.lineTo(n.x(0),n.y(1)),t.lineTo(n.x(1),n.y(1)),t.lineTo(n.x(1),n.y(0)),t.lineTo(n.x(0),n.y(0)),t.stroke()}))}}]),e}(),Zr=function(e){En(n,e);var t=_r(n);function n(e,r,a){var o;return s(this,n),d(An(o=t.call(this,e,{resize:function(){return o.resized()},click:function(e){return o.clicked(e)},zoom:function(e){return o.zoomed(e)}})),"reporters",void 0),d(An(o),"book",void 0),d(An(o),"zoomLevel",void 0),d(An(o),"lotSize",void 0),d(An(o),"conventionalRateStep",void 0),d(An(o),"lines",void 0),d(An(o),"markers",void 0),d(An(o),"zoomInBttn",void 0),d(An(o),"zoomOutBttn",void 0),d(An(o),"baseUnit",void 0),d(An(o),"quoteUnit",void 0),o.reporters=r,o.zoomLevel=a,o.lines=[],o.markers={buys:[],sells:[]},o.setZoomBttns(),o.resize(),o}return u(n,[{key:"setZoomBttns",value:function(){this.zoomInBttn=new na(this.ctx,new ta(0,0,0,0)),this.zoomOutBttn=new na(this.ctx,new ta(0,0,0,0))}},{key:"resized",value:function(){this.setZoomBttns(),this.book&&this.draw()}},{key:"zoomed",value:function(e){this.zoomLevel&&this.book.buys&&this.book.sells&&(this.wheeled(),this.zoomLevel*=e?2/3:1.5,this.zoomLevel=ia(this.zoomLevel,.005,2),this.draw(),this.reporters.zoom(this.zoomLevel))}},{key:"clicked",value:function(e){if(this.dataExtents){var t=e.clientX-this.rect.left,n=e.clientY-this.rect.y;if(this.zoomInBttn.contains(t,n))this.zoom(!0);else if(this.zoomOutBttn.contains(t,n))this.zoom(!1);else{var r=this.plotRegion.translator(this.dataExtents);this.reporters.click(r.unx(t))}}}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"set",value:function(e,t,n,a,o){if(this.book=e,this.lotSize=t/a.conventional.conversionFactor,this.conventionalRateStep=br.conventionalRateStep(n,a,o),this.baseUnit=a.conventional.unit,this.quoteUnit=o.conventional.unit,!this.zoomLevel){var s=r(this.gap(),2),i=s[0],c=s[1],l=Math.max(c/i*5,.05);this.zoomLevel=Math.min(l,2)}this.draw()}},{key:"render",value:function(){var e=this;if(this.book&&this.visible&&0!==this.canvas.width){this.clear();var t=this.ctx,n=this.mousePos,a=this.book.buys,o=this.book.sells,s=r(this.gap(),2),i=s[0],c=s[1],l=this.zoomLevel*i/2,u=i+l,d=i-l,h=Vr(this.markers.buys),p=Vr(this.markers.sells);h.sort((function(e,t){return t.rate-e.rate})),p.sort((function(e,t){return e.rate-t.rate}));for(var f=[],v=[],m=[],g=[],y=[],k={buyBase:0,buyQuote:0,sellBase:0,sellQuote:0},b=0,w=0,x=0;x<a.length;x++){var C=a[x];if(w+=C.qty,C.rate>=d&&m.push([C.rate,w]),!C.epoch)for(b+=C.qty,v.push([C.rate,b]),k.buyBase+=C.qty,k.buyQuote+=C.qty*C.rate;h.length&&ca(h[0].rate,C.rate);){var S=h.shift();S&&f.push({rate:S.rate,qty:C.epoch?w:b,sell:C.sell,active:S.active})}}var A=v.length?oa(v)[1]:0;v.push([d,A]);var F=m.length?oa(m)[1]:0;m.push([d,F]),w=b=0;for(var E=0;E<o.length;E++){var I=o[E];if(w+=I.qty,I.rate<=u&&y.push([I.rate,w]),!I.epoch)for(b+=I.qty,g.push([I.rate,b]),k.sellBase+=I.qty,k.sellQuote+=I.qty*I.rate;p.length&&ca(p[0].rate,I.rate);){var R=p.shift();R&&f.push({rate:R.rate,qty:I.epoch?w:b,sell:I.sell,active:R.active})}}var T=g.length?oa(g)[1]:0;g.push([u,T]);var D=y.length?oa(y)[1]:0;y.push([u,D]);var M=this.xRegion.extents.y.min,P=(M+30)/M,B=(D&&F?Math.max(F,D):D||F||1)*P,O=new ta(d,u,0,B);this.dataExtents=O,this.doYLabels(this.plotRegion,this.lotSize,this.baseUnit);var L=ra(t,this.plotRegion.width(),O.x.min,O.x.max,100,this.conventionalRateStep,"");this.plotXLabels(L,d,u,["".concat(this.quoteUnit,"/"),this.baseUnit]);var W=null;this.drawFrame(),this.plotRegion.plot(O,(function(t,r){t.lineWidth=1,t.strokeStyle=e.theme.gridBorder,t.lineWidth=2.5,t.strokeStyle=e.theme.gapLine,sa(t,r.x(i),r.y(0),r.x(i),r.y(.3*O.y.max)),t.font="30px 'demi-sans', sans-serif",t.textAlign="center",t.textBaseline="middle",t.fillStyle=e.theme.value;var a=.5*O.y.max;t.fillText(br.formatFourSigFigs(i),r.x(i),r.y(a)),t.font="12px 'sans', sans-serif",t.fillText("".concat((c/i*100).toFixed(2),"% spread"),r.x(i),r.y(a)+24),t.textAlign="center",t.textBaseline="middle";var o=e.plotRegion.extents.midX,s=r.y(.9*B),l=O.xRange/i*100,h="".concat(l.toFixed(1),"%"),p=t.measureText(h).width;t.font="13px 'sans', sans-serif",t.fillText(h,o,s+1);var m=o-p/2-10-20,y=s-10;e.zoomOutBttn.setExtents(m,m+20,y,y+20);var k=n&&e.zoomOutBttn.contains(n.x,n.y);e.zoomOutBttn.plot(new ta(0,1,0,1),(function(t){t.font="12px 'icomoon'",t.fillStyle=e.theme.zoom,k&&(t.fillStyle=e.theme.zoomHover,t.font="13px 'icomoon'"),t.fillText(Xr,e.zoomOutBttn.extents.midX,e.zoomOutBttn.extents.midY)})),m=o+p/2+10,e.zoomInBttn.setExtents(m,m+20,y,y+20),k=n&&e.zoomInBttn.contains(n.x,n.y),e.zoomInBttn.plot(new ta(0,1,0,1),(function(t){t.font="12px 'icomoon'",t.fillStyle=e.theme.zoom,k&&(t.fillStyle=e.theme.zoomHover,t.font="14px 'icomoon'"),t.fillText(Kr,e.zoomInBttn.extents.midX,e.zoomInBttn.extents.midY)}));var b,w=function(e,n){e>u||e<d||(t.save(),t.setLineDash([3,5]),t.lineWidth=1.5,t.strokeStyle=n,sa(t,r.x(e),r.y(0),r.x(e),r.y(B)),t.restore())},x=zr(e.lines||[]);try{for(x.s();!(b=x.n()).done;){var C=b.value;w(C.rate,C.color)}}catch(e){x.e(e)}finally{x.f()}for(var S=.005*(u-d),A=[],F=0,E=f||[];F<E.length;F++){var I=E[F],R=n&&la(I.rate,r.unx(n.x),S);R&&A.push(I.rate),t.save(),t.lineWidth=R||I.active?5:3,t.strokeStyle=I.sell?e.theme.sellLine:e.theme.buyLine,t.fillStyle=I.sell?e.theme.sellFill:e.theme.buyFill;var T=R||I.active?10:8;t.beginPath();var D={x:r.x(I.rate),y:r.y(I.qty)-8},M=D.y-Math.sqrt(3)*T/2;t.moveTo(D.x,D.y),t.lineTo(D.x-T/2,M),t.lineTo(D.x+T/2,M),t.closePath(),t.stroke(),t.fill(),t.restore()}if(n&&e.plotRegion.contains(n.x,n.y)){var P=r.unx(n.x),L=g,q=function(e){return e>=P},N=e.theme.sellLine;P<i&&(L=v,q=function(e){return e<=P},N=e.theme.buyLine);for(var U=L[0],V=0;V<L.length;V++){var _=L[V];if(q(_[0]))break;U=_}w(P,e.theme.crosshairs),W={rate:P,depth:U[1],dotColor:N,hoverMarkers:A}}})),t.lineWidth=1.5,t.setLineDash([3,3]),t.fillStyle=this.theme.sellFill,t.strokeStyle=this.theme.sellLine,this.drawDepth(y),t.fillStyle=this.theme.buyFill,t.strokeStyle=this.theme.buyLine,this.drawDepth(m),t.lineWidth=2.5,t.setLineDash([]),t.fillStyle=this.theme.sellFill,t.strokeStyle=this.theme.sellLine,this.drawDepth(g),t.fillStyle=this.theme.buyFill,t.strokeStyle=this.theme.buyLine,this.drawDepth(v),W&&this.plotRegion.plot(O,(function(e,t){W&&function(e,t,n,r,a){e.fillStyle=r,e.beginPath(),e.arc(t,n,5,0,Gr),e.fill()}(e,t.x(W.rate),t.y(W.depth),W.dotColor)})),this.reporters.volume(k),this.reporters.mouse(W)}else this.renderScheduled=!0}},{key:"drawDepth",value:function(e){var t,n=e[0];this.plotRegion.plot(this.dataExtents,(function(r,a){var o=a.y(0),s=a.y(n[1]);r.beginPath(),r.moveTo(a.x(n[0]),a.y(n[1]));for(var i=0;i<e.length;i++)t=a.x(e[i][0]),r.lineTo(t,s),s=a.y(e[i][1]),r.lineTo(t,s);r.stroke(),r.lineTo(t,o),r.lineTo(a.x(n[0]),o),r.closePath(),r.globalAlpha=.25,r.fill()}))}},{key:"gap",value:function(){var e=[this.book.bestGapBuy(),this.book.bestGapSell()],t=e[0],n=e[1];return t?n?[(n.rate+t.rate)/2,n.rate-t.rate]:[t.rate,0]:n?[n.rate,0]:[1,0]}},{key:"setLines",value:function(e){this.lines=e}},{key:"setMarkers",value:function(e){this.markers=e}}]),n}(Jr),$r=function(e){En(n,e);var t=_r(n);function n(e,r){var a;return s(this,n),d(An(a=t.call(this,e,{resize:function(){return a.resized()},click:function(){a.clicked()},zoom:function(e){return a.zoomed(e)}})),"reporters",void 0),d(An(a),"data",void 0),d(An(a),"zoomLevel",void 0),d(An(a),"numToShow",void 0),d(An(a),"candleRegion",void 0),d(An(a),"volumeRegion",void 0),d(An(a),"resizeTimer",void 0),d(An(a),"zoomLevels",void 0),d(An(a),"market",void 0),d(An(a),"rateConversionFactor",void 0),a.reporters=r,a.zoomLevel=1,a.numToShow=100,a.resize(),a}return u(n,[{key:"resized",value:function(){var e=this,t=this.plotRegion.extents,n=new ta(t.x.min,t.x.max,t.y.min,t.y.min+.85*t.yRange);this.candleRegion=new na(this.ctx,n);var r=new ta(t.x.min,t.x.max,t.y.min+.85*t.yRange,t.y.max);this.volumeRegion=new na(this.ctx,r),this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=window.setTimeout((function(){return e.draw()}),100)}},{key:"clicked",value:function(){}},{key:"zoomed",value:function(e){var t=this.zoomLevels.indexOf(this.numToShow);if(e){if(0===t)return;this.numToShow=this.zoomLevels[t-1]}else{if(this.zoomLevels.length<=t+1||this.numToShow>this.data.candles.length)return;this.numToShow=this.zoomLevels[t+1]}this.draw()}},{key:"render",value:function(){var e=this,t=this.data;if(t&&this.visible&&0!==this.canvas.width){var n=t.ms,r=this.mousePos,a=t.candles||[],o=Math.min(this.numToShow,a.length),s=a.slice(a.length-o);if(this.clear(),0!==o){var i,c=function(e){return ua(e.endStamp,n)},l=function(e){return c(e)+n},u=function(e){return c(e)+.2*n},d=.6*n,h=s[0],p=s[o-1],f=[h.highRate,h.lowRate,h.matchVolume],v=f[0],m=f[1],g=f[2],y=zr(s);try{for(y.s();!(i=y.n()).done;){var k=i.value;k.highRate>v&&(v=k.highRate),k.lowRate<m&&(m=k.lowRate),k.matchVolume>g&&(g=k.matchVolume)}}catch(e){y.e(e)}finally{y.f()}var b=this.market.ratestep,w=new ta(c(h),l(p),m,v);m===v&&(w.y.min-=b,w.y.max+=b),this.dataExtents=w;var x=this.rateConversionFactor;this.doYLabels(this.candleRegion,b,this.market.quotesymbol,(function(e){return br.formatFourSigFigs(e/x)})),this.candleRegion.extents.x.min=this.yRegion.extents.x.max,this.volumeRegion.extents.x.min=this.yRegion.extents.x.max;var C=function(e,t,n,r){var a=e[0],o=e[e.length-1],s=ua(a.endStamp,t),i=ua(o.endStamp,t)+t,c=i-s,l=Math.min(e.length,n/100),u=ua(c/l,t);if(0===u)return console.error("zero tick",t,c,l),{lbls:[]};var d=s,h=(new Date).getTimezoneOffset(),p=function(e){return(e-=6e4*h)-e%864e5},f=p(s),v=0;p(a.endStamp)===p(o.endStamp)&&(f=0);var m,g=[];for(m=t<864e5?function(e,t){return p(t)!==f?"".concat(aa[e.getMonth()]).concat(e.getDate()," ").concat(e.getHours(),":").concat(String(e.getMinutes()).padStart(2,"0")):"".concat(e.getHours(),":").concat(String(e.getMinutes()).padStart(2,"0"))}:function(e){var t=e.getFullYear();return t!==v?"".concat(aa[e.getMonth()]).concat(e.getDate()," '").concat(String(t).slice(2,4)):"".concat(aa[e.getMonth()]).concat(e.getDate())};d<=i;){var y=new Date(d);g.push({val:d,txt:m(y,d)}),f=p(d),v=y.getFullYear(),d+=u}return{lbls:g}}(s,n,this.plotRegion.width());this.plotXLabels(C,c(h),l(p),[]),this.drawFrame();var S=null;if(r&&(this.plotRegion.plot(new ta(w.x.min,w.x.max,0,1),(function(t,a){var o,i=ua(a.unx(r.x),n),l=zr(s);try{for(l.s();!(o=l.n()).done;){var u=o.value;if(c(u)===i){S=u,t.fillStyle=e.theme.gridLines,t.fillRect(a.x(c(u)),a.y(0),a.w(n),a.h(1));break}}}catch(e){l.e(e)}finally{l.f()}})),S)){var A=this.xRegion.extents.y;this.xRegion.plot(new ta(w.x.min,w.x.max,A.min,A.max),(function(t,n){if(S){e.applyLabelStyle();var r="".concat(new Date(c(S)).toLocaleString()," - ").concat(new Date(l(S)).toLocaleString()),a=t.measureText(r).width+50,o=n.x((c(S)+l(S))/2),s=o-a/2,i=e.xRegion.extents.x;s<i.min?s=i.min:s+a>i.max&&(s=i.max-a),o=s+a/2;var u=A.min+(e.xRegion.height()-16)/2;t.fillStyle=e.theme.legendFill,t.strokeStyle=e.theme.gridBorder;var d=[s-25,u-2,a+50,20];t.fillRect.apply(t,d),t.strokeRect.apply(t,d),e.applyLabelStyle(),t.fillText(r,o,e.xRegion.extents.midY,a)}}))}var F=new ta(c(h),l(p),0,g);this.volumeRegion.plot(F,(function(t,n){t.fillStyle=e.theme.gridBorder;var r,a=zr(s);try{for(a.s();!(r=a.n()).done;){var o=r.value;t.fillRect(n.x(u(o)),n.y(0),n.w(d),n.h(o.matchVolume))}}catch(e){a.e(e)}finally{a.f()}})),this.candleRegion.plot(w,(function(t,n){t.lineWidth=1;var r,a=zr(s);try{for(a.s();!(r=a.n()).done;){var o=r.value,i=o.startRate>o.endRate,c=[n.x(u(o)),n.y(o.startRate),n.w(d),n.h(o.endRate-o.startRate)],l=c[0],h=c[1],p=c[2],f=c[3],v=[n.y(o.highRate),n.y(o.lowRate),p/2+l],m=v[0],g=v[1],y=v[2];t.strokeStyle=i?e.theme.sellLine:e.theme.buyLine,t.fillStyle=i?e.theme.sellFill:e.theme.buyFill,t.beginPath(),t.moveTo(y,m),t.lineTo(y,g),t.stroke(),t.fillRect(l,h,p,f),t.strokeRect(l,h,p,f)}}catch(e){a.e(e)}finally{a.f()}})),this.reporters.mouse(S)}}else this.renderScheduled=!0}},{key:"setCandles",value:function(e,t,n,r){if(this.data=e,e.candles){this.market=t;var a=[r.conventional.conversionFactor,n.conventional.conversionFactor],o=a[0],s=a[1];this.rateConversionFactor=Gn*o/s;var i=25;this.zoomLevels=[];for(var c=Math.max(e.candles.length,1e3);i<c;)this.zoomLevels.push(i),i*=2;this.numToShow=100,this.draw()}}}]),n}(Jr),ea=function(e){En(n,e);var t=_r(n);function n(e,r){var a;s(this,n),d(An(a=t.call(this,e,{resize:function(){return a.resized()},click:function(){},zoom:function(){}})),"ani",void 0),d(An(a),"size",void 0),d(An(a),"region",void 0),d(An(a),"colorShift",void 0),d(An(a),"opts",void 0),d(An(a),"msgRegion",void 0),d(An(a),"fontSize",void 0),a.canvas.classList.add("fill-abs"),a.canvas.style.zIndex="5",a.opts=null!=r?r:{};var o=1500*Math.random();a.colorShift=360*Math.random();var i=[1,.65,.75],c=[3,3,2],l=[Math.PI,10*Math.PI/9,Math.PI/2.5],u=[0,0,1.5*Math.PI],h=function(e,t,n){return i[e]*Math.cos(c[e]*t+l[e]*n+u[e])},p=function(e,t){var n=e*Math.PI*2;return(h(0,n,t)+h(1,n,t)+h(2,n,t))/3};return a.resize(),a.ani=new wr(wr.Forever,(function(){for(var e=((new Date).getTime()-o)/1500*Math.PI*2,t=[],n=0;n<75;n++)t.push(p(n/74,e));a.drawValues(t)})),a}return u(n,[{key:"resized",value:function(){var e=this.opts,t=[this.canvas.width,this.canvas.height],n=t[0],r=t[1],a=.8*n,o=.8*r;a>150&&(a=150),o>100&&(o=100);var s=(n-a)/2,i=(r-o)/2;if(e.message){this.fontSize=ia(.15*o,10,14),this.applyLabelStyle(this.fontSize);var c=.5*this.fontSize,l=this.fontSize/2+c;i-=l,this.msgRegion=new na(this.ctx,new ta(0,n,i+o,i+o+2*l))}this.region=new na(this.ctx,new ta(s,s+a,i,i+o))}},{key:"drawValues",value:function(e){var t=this;if(this.region){this.clear();var n=function(e){return"hsl(".concat(e,", 35%, 50%)")},r=this.region,a=this.msgRegion,o=this.canvas,s=o.width,i=o.height,c=this.opts,l=c.backgroundColor,u=c.message,d=this.colorShift,h=this.ctx;l&&(h.fillStyle=!0===l?window.getComputedStyle(document.body,null).getPropertyValue("background-color"):l,h.fillRect(0,0,s,i)),r.plot(new ta(0,1,-1,1),(function(t,r){t.lineWidth=4,t.lineCap="round";var a=d+(new Date).getTime()%2e3/2e3*360,o=t.createLinearGradient(r.x(0),0,r.x(1),0);o.addColorStop(0,n(a)),t.strokeStyle=o,t.beginPath(),t.moveTo(r.x(0),r.y(e[0]));for(var s=1;s<e.length;s++){var i=s/(e.length-1);o.addColorStop(i,n(300*i+a)),t.lineTo(r.x(i),r.y(e[s]))}t.stroke()})),u&&a.plot(new ta(0,1,0,1),(function(e,n){t.applyLabelStyle(t.fontSize),e.fillText(u,n.x(.5),n.y(.5),t.msgRegion.width())}))}}},{key:"render",value:function(){}},{key:"stop",value:function(){this.ani.stop(),this.canvas.remove()}}]),n}(Jr),ta=function(){function e(t,n,r,a){s(this,e),d(this,"x",void 0),d(this,"y",void 0),this.setExtents(t,n,r,a)}return u(e,[{key:"setExtents",value:function(e,t,n,r){this.x={min:e,max:t},this.y={min:n,max:r}}},{key:"xRange",get:function(){return this.x.max-this.x.min}},{key:"midX",get:function(){return(this.x.max+this.x.min)/2}},{key:"yRange",get:function(){return this.y.max-this.y.min}},{key:"midY",get:function(){return(this.y.max+this.y.min)/2}}]),e}(),na=function(){function e(t,n){s(this,e),d(this,"context",void 0),d(this,"extents",void 0),this.context=t,this.extents=n}return u(e,[{key:"setExtents",value:function(e,t,n,r){this.extents.setExtents(e,t,n,r)}},{key:"width",value:function(){return this.extents.xRange}},{key:"height",value:function(){return this.extents.yRange}},{key:"contains",value:function(e,t){var n=this.extents;return e<n.x.max&&e>n.x.min&&t<n.y.max&&t>n.y.min}},{key:"translator",value:function(e){var t=this.extents,n=e.x.min,r=e.y.min,a=e.yRange,o=e.xRange,s=t.x.min,i=t.x.max-s,c=t.y.max,l=c-t.y.min,u=i/o,d=l/a;return{x:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return(e-n)*u+s})),y:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return c-(e-r)*d})),unx:function(e){return(e-s)/u+n},uny:function(e){return r-(e-c)/d},w:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return e/o*i})),h:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return-e/a*l}))}}},{key:"clear",value:function(){var e=this.extents;this.context.clearRect(e.x.min,e.y.min,e.xRange,e.yRange)}},{key:"plot",value:function(e,t,n){var r=this.context,a=this.extents;r.save(),n||(r.beginPath(),r.rect(a.x.min,a.y.min,a.xRange,a.yRange),r.clip());var o=this.translator(e);t(this.context,o),r.restore()}}]),e}();function ra(e,t,n,r,a,o,s,i){i=i||br.formatFourSigFigs;var c=t/a,l=r-n;if(c<1||l<=0)return{lbls:[]};for(var u=l/c,d=u+o-u%o,h=n+d-n%d,p=Math.max(Math.abs(r),Math.abs(n)),f=Math.round(Math.log10(p/d))+2,v=[],m=0;h<r;){var g=i(h=Number(h.toPrecision(f)));m=Math.max(m,e.measureText(g).width),v.push({val:h,txt:g}),h+=d}var y=e.measureText(s).width;return y>m&&(m=y),{widest:m,lbls:v}}var aa=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];function oa(e){return e[e.length-1]}function sa(e,t,n,r,a,o){e.beginPath(),e.moveTo(t,n),e.lineTo(r,a),o||e.stroke()}function ia(e,t,n){return e<t?t:e>n?n:e}function ca(e,t){return la(e,t,1e-8)}function la(e,t,n){return Math.abs(e-t)<Math.abs(n)}function ua(e,t){return e-e%t}function da(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ha(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ha(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){i=!0,o=e})),f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function ha(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var pa=function(){function e(t,n,r,a){var o=this;s(this,e),d(this,"page",void 0),d(this,"form",void 0),d(this,"pwCache",void 0),d(this,"success",void 0),d(this,"current",void 0),d(this,"pwHiders",void 0),d(this,"subform",void 0),d(this,"walletCfgGuide",void 0),d(this,"parentSyncer",void 0),d(this,"createUpdater",void 0),this.form=t,this.success=n,this.pwCache=r||null;var i=this.page=br.parseTemplate(t);this.pwHiders=Array.from(t.querySelectorAll(".hide-pw")),this.refresh(),a&&(br.show(i.goBack),br.bind(i.goBack,"click",(function(){a()}))),br.empty(i.walletTabTmpl),i.walletTabTmpl.removeAttribute("id"),this.subform=new va(i.walletSettings,!0),this.walletCfgGuide=br.tmplElement(t,"walletCfgGuide"),Ta(t,i.submitAdd,(function(){return o.submit()})),Ta(t,i.oneBttn,(function(){return o.submit()})),Sn().registerNoteFeeder({walletstate:function(e){o.reportWalletState(e.wallet)},createwallet:function(e){o.reportCreationUpdate(e)}})}var t,n,r,a,i,c,l;return u(e,[{key:"reportWalletState",value:function(e){this.parentSyncer&&this.parentSyncer(e)}},{key:"reportCreationUpdate",value:function(e){this.createUpdater&&this.createUpdater(e)}},{key:"refresh",value:function(){Mr.passwordIsCached()||this.pwCache&&this.pwCache.pw?br.hide.apply(br,Vr(this.pwHiders)):br.show.apply(br,Vr(this.pwHiders))}},{key:"createWallet",value:(l=o(b().mark((function e(t,n,r,a){var o,s,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={assetID:t,pass:this.page.newWalletPass.value||"",config:this.subform.map(t),appPass:r,walletType:n,parentForm:a},s=new ea(this.page.mainForm,{backgroundColor:!0}),e.next=4,Lr("/api/newwallet",o);case 4:return i=e.sent,s.stop(),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return l.apply(this,arguments)})},{key:"submit",value:(c=o(b().mark((function e(){var t,n,r,a,o,s,i,c,l,u,d;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,n=t.appPass,r=t.newWalletPass,(a=n.value||(this.pwCache?this.pwCache.pw:""))||Mr.passwordIsCached()){e.next=8;break}return t.newWalletErr.textContent=vn(x),br.show(t.newWalletErr),e.abrupt("return");case 8:return br.hide(t.newWalletErr),o=this.current,s=o.asset,i=o.parentAsset,c=this.current.selectedDef,u=c.type,i&&(u=s.token.definition.type,l={assetID:i.id,config:this.subform.map(i.id),walletType:c.type}),e.next=15,this.createWallet(s.id,u,a,l);case 15:if(d=e.sent,Sn().checkResponse(d)){e.next=19;break}return this.setError(d.msg),e.abrupt("return");case 19:if(this.pwCache&&(this.pwCache.pw=a),t.appPass.value="",r.value="",!i){e.next=27;break}return e.next=25,this.runParentSync();case 25:e.next=28;break;case 27:this.success(this.current.asset.id);case 28:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"runParentSync",value:(i=o(b().mark((function e(){var t,n,r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,n=this.current,r=n.parentAsset,a=n.asset,r){e.next=3;break}return e.abrupt("return");case 3:return t.parentSyncPct.textContent="0",t.parentName.textContent=r.name,t.parentLogo.src=br.logoPath(r.symbol),t.childName.textContent=a.name,t.childLogo.src=br.logoPath(a.symbol),br.hide(t.mainForm),br.show(t.parentSyncing),e.prev=10,e.next=13,this.syncParent(r);case 13:this.success(this.current.asset.id),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(10),this.setError(e.t0.message||e.t0);case 19:br.show(t.mainForm),br.hide(t.parentSyncing);case 21:case"end":return e.stop()}}),e,this,[[10,16]])}))),function(){return i.apply(this,arguments)})},{key:"syncParent",value:function(e){var t=this,n=this.page,r=this.current.asset;return new Promise((function(a,o){var s=Sn().assets[e.id].wallet;if(s&&s.synced)return a();t.parentSyncer=function(t){t.assetID===e.id&&(n.parentSyncPct.textContent=(100*t.syncProgress).toFixed(1))},t.createUpdater=function(e){if(e.assetID===r.id){switch(e.topic){case"QueuedCreationFailed":o(new Error("".concat(e.subject,": ").concat(e.details)));break;case"QueuedCreationSuccess":a();break;default:return}t.parentSyncer=null,t.createUpdater=null}}}))}},{key:"setAsset",value:(a=o(b().mark((function e(t){var n,r,a,o,s,i,c,l,u,d,h,p=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.parseAsset(t)){e.next=2;break}return e.abrupt("return");case 2:if(n=this.page,r=n.walletTypeTabs,a=this.current,o=a.winfo,s=a.asset,i=a.parentAsset,n.assetName.textContent=o.name,n.newWalletPass.value="",br.empty(r),br.hide(r,n.newWalletErr,n.tokenMsgBox),n.header.classList.remove("bordertop"),this.page.assetLogo.src=br.logoPath(s.symbol),i&&(n.tokenParentLogo.src=br.logoPath(i.symbol),n.tokenParentName.textContent=i.name,br.show(n.tokenMsgBox)),c=i?i.info:null,!((l=c?c.availablewallets:o.availablewallets?o.availablewallets:[o.definition]).length>1)){e.next=35;break}br.show(r),u=da(l),e.prev=17,h=b().mark((function e(){var t,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=d.value,(a=n.walletTabTmpl.cloneNode(!0)).dataset.tooltip=t.description,a.textContent=t.tab,r.appendChild(a),br.bind(a,"click",(function(){var e,n=da(br.kids(r));try{for(n.s();!(e=n.n()).done;)e.value.classList.remove("selected")}catch(e){n.e(e)}finally{n.f()}a.classList.add("selected"),p.update(t)}));case 6:case"end":return e.stop()}}),e)})),u.s();case 20:if((d=u.n()).done){e.next=24;break}return e.delegateYield(h(),"t0",22);case 22:e.next=20;break;case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(17),u.e(e.t1);case 29:return e.prev=29,u.f(),e.finish(29);case 32:Sn().bindTooltips(r),r.firstChild.classList.add("selected");case 35:return e.next=37,this.update(this.current.selectedDef);case 37:if(!s.walletCreationPending){e.next=40;break}return e.next=40,this.runParentSync();case 40:case"end":return e.stop()}}),e,this,[[17,26,29,32]])}))),function(e){return a.apply(this,arguments)})},{key:"parseAsset",value:function(e){if(this.current&&this.current.asset.id===e)return!1;var t=Sn().assets[e],n=t.token;if(!n){if(!t.info)throw Error("this non-token asset has no wallet info!");return this.current={asset:t,winfo:t.info,selectedDef:t.info.availablewallets[0]},!0}var r=Sn().user.assets[n.parentID];if(r.wallet)return this.current={asset:t,winfo:n,selectedDef:n.definition},!0;if(!r.info)throw Error("this parent has no wallet info!");return this.current={asset:t,parentAsset:r,winfo:n,selectedDef:r.info.availablewallets[0]},!0}},{key:"update",value:(r=o(b().mark((function e(t){var n,r,a,o,s,i,c,l,u,d,h,p,f,v,m,g,y,k,w;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.page,this.current.selectedDef=t,r=Mr.passwordIsCached()||this.pwCache&&this.pwCache.pw,br.hide(n.walletPassAndSubmitBttn,n.oneBttnBox,n.newWalletPassBox),a=t.guidelink,(o=t.configopts||[]).map((function(e){return e.isBirthdayConfig&&Sn().seedGenTime>0&&(e.default=Da(new Date)),e})),s=!1,i=da(o),e.prev=9,i.s();case 11:if((c=i.n()).done){e.next=18;break}if(!c.value.required){e.next=16;break}return s=!0,e.abrupt("break",18);case 16:e.next=11;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),i.e(e.t0);case 23:return e.prev=23,i.f(),e.finish(23);case 26:if(l=this.current,u=l.asset,d=l.parentAsset,h=l.winfo,p=t.seeded||Boolean(u.token),r&&p&&!s?br.show(n.oneBttnBox):p?(br.show(n.walletPassAndSubmitBttn),n.newWalletPass.value="",n.submitAdd.textContent=vn(de)):(br.show(n.walletPassAndSubmitBttn),t.noauth||br.show(n.newWalletPassBox),n.submitAdd.textContent=vn(ue)),d){f=JSON.parse(JSON.stringify(o)),v=da(f);try{for(v.s();!(m=v.n()).done;)m.value.regAsset=d.id}catch(e){v.e(e)}finally{v.f()}if((g=h.definition.configopts||[]).length>0){y=JSON.parse(JSON.stringify(g)),k=da(y);try{for(k.s();!(w=k.n()).done;)w.value.regAsset=u.id}catch(e){k.e(e)}finally{k.f()}f.push.apply(f,Vr(y))}this.subform.update(u.id,f,!1)}else this.subform.update(u.id,o,!1);return this.setGuideLink(a),this.subform.dynamicOpts.children.length||this.subform.defaultSettings.children.length?br.show(n.walletSettingsHeader):br.hide(n.walletSettingsHeader),t.seeded||Boolean(this.current.asset.token)?br.hide(this.subform.fileSelector):br.show(this.subform.fileSelector),this.refresh(),e.next=36,this.loadDefaults();case 36:case"end":return e.stop()}}),e,this,[[9,20,23,26]])}))),function(e){return r.apply(this,arguments)})},{key:"setGuideLink",value:function(e){br.hide(this.walletCfgGuide),""!==e&&(this.walletCfgGuide.href=e,br.show(this.walletCfgGuide))}},{key:"setError",value:(n=o(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.page.newWalletErr.textContent=t,br.show(this.page.newWalletErr);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"loadDefaults",value:(t=o(b().mark((function e(){var t,n,r,a,o,s,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.current,n=t.asset,r=t.parentAsset,(a=t.selectedDef).configpath){e.next=3;break}return e.abrupt("return");case 3:if(o=n.id,!r){e.next=8;break}if(!a.seeded){e.next=7;break}return e.abrupt("return");case 7:o=r.id;case 8:return s=Sn().loading(this.form),e.next=11,Lr("/api/defaultwalletcfg",{assetID:o,type:a.type});case 11:if(i=e.sent,s(),Sn().checkResponse(i)){e.next=16;break}return this.setError(i.msg),e.abrupt("return");case 16:this.subform.setLoadedConfig(i.config);case 17:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),fa=0,va=function(){function e(t,n){var r=this;s(this,e),d(this,"page",void 0),d(this,"form",void 0),d(this,"configElements",void 0),d(this,"configOpts",void 0),d(this,"sectionize",void 0),d(this,"allSettings",void 0),d(this,"dynamicOpts",void 0),d(this,"textInputTmpl",void 0),d(this,"dateInputTmpl",void 0),d(this,"checkboxTmpl",void 0),d(this,"repeatableTmpl",void 0),d(this,"fileSelector",void 0),d(this,"fileInput",void 0),d(this,"errMsg",void 0),d(this,"showOther",void 0),d(this,"showIcon",void 0),d(this,"hideIcon",void 0),d(this,"showHideMsg",void 0),d(this,"otherSettings",void 0),d(this,"loadedSettingsMsg",void 0),d(this,"loadedSettings",void 0),d(this,"defaultSettingsMsg",void 0),d(this,"defaultSettings",void 0),d(this,"assetHasActiveOrders",void 0),d(this,"assetID",void 0),this.page=br.idDescendants(t),this.form=t,this.configElements=[],this.configOpts=[],this.sectionize=n,this.allSettings=br.tmplElement(t,"allSettings"),this.dynamicOpts=br.tmplElement(t,"dynamicOpts"),this.textInputTmpl=br.tmplElement(t,"textInput"),this.textInputTmpl.remove(),this.dateInputTmpl=br.tmplElement(t,"dateInput"),this.dateInputTmpl.remove(),this.checkboxTmpl=br.tmplElement(t,"checkbox"),this.checkboxTmpl.remove(),this.repeatableTmpl=br.tmplElement(t,"repeatableInput"),this.repeatableTmpl.remove(),this.fileSelector=br.tmplElement(t,"fileSelector"),this.fileInput=br.tmplElement(t,"fileInput"),this.errMsg=br.tmplElement(t,"errMsg"),this.showOther=br.tmplElement(t,"showOther"),this.showIcon=br.tmplElement(t,"showIcon"),this.hideIcon=br.tmplElement(t,"hideIcon"),this.showHideMsg=br.tmplElement(t,"showHideMsg"),this.otherSettings=br.tmplElement(t,"otherSettings"),this.loadedSettingsMsg=br.tmplElement(t,"loadedSettingsMsg"),this.loadedSettings=br.tmplElement(t,"loadedSettings"),this.defaultSettingsMsg=br.tmplElement(t,"defaultSettingsMsg"),this.defaultSettings=br.tmplElement(t,"defaultSettings"),n||br.hide(this.showOther),br.bind(this.fileSelector,"click",(function(){return r.fileInput.click()})),br.bind(this.fileInput,"change",o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.fileInputChanged());case 1:case"end":return e.stop()}}),e)})))),br.bind(this.showOther,"click",(function(){r.setOtherSettingsViz(r.hideIcon.classList.contains("d-hide"))}))}var t;return u(e,[{key:"fileInputChanged",value:(t=o(b().mark((function e(){var t,n,r,a,o,s,i,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(br.hide(this.errMsg),this.fileInput.value){e.next=3;break}return e.abrupt("return");case 3:if((n=this.fileInput.files)&&0!==n.length){e.next=6;break}return e.abrupt("return");case 6:return r=Sn().loading(this.form),e.next=9,n[0].text();case 9:if(a=e.sent){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,Lr("/api/parseconfig",{configtext:a});case 14:if(o=e.sent,r(),Sn().checkResponse(o)){e.next=20;break}return this.errMsg.textContent=o.msg,br.show(this.errMsg),e.abrupt("return");case 20:if(0!==Object.keys(o.map).length){e.next=22;break}return e.abrupt("return");case 22:(t=this.dynamicOpts).append.apply(t,Vr(this.setConfig(o.map))),this.reorder(this.dynamicOpts),s=[this.loadedSettings.children.length,this.defaultSettings.children.length],c=s[1],0===(i=s[0])&&br.hide(this.loadedSettings,this.loadedSettingsMsg),0===c&&br.hide(this.defaultSettings,this.defaultSettingsMsg),i+c===0&&br.hide(this.showOther,this.otherSettings);case 28:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"addOpt",value:function(e,t,n,r){var a,o,s,i=this;if(t.isboolean)s=this.checkboxTmpl.cloneNode(!0);else if(t.isdate)s=this.dateInputTmpl.cloneNode(!0);else if(t.repeatable){if((s=this.repeatableTmpl.cloneNode(!0)).classList.add("repeatable"),br.bind(br.tmplElement(s,"add"),"click",(function(){i.addOpt(e,t,s,!0)})),!r)for(var c=0;c<(t.repeatN?t.repeatN-1:0);c++)this.addOpt(e,t,n,!0)}else s=this.textInputTmpl.cloneNode(!0);-1!==((null===(a=Sn().user.extensionModeConfig)||void 0===a||null===(o=a.restrictedWallets[Pa(this.assetID)])||void 0===o?void 0:o.hiddenFields)||[]).indexOf(t.key)&&br.hide(s),this.configElements.push([t,s]);var l=s.querySelector("input");l.dataset.configKey=t.key,fa++;var u="wcfg-"+String(fa);l.id=u;var d=br.safeSelector(s,"label");if(d.htmlFor=u,d.prepend(t.displayname),void 0!==t.regAsset){var h=new window.Image(15,15);h.src=br.logoPathFromID(t.regAsset||-1),d.prepend(h)}if(n?n.after(s):e.appendChild(s),t.noecho&&(l.type="password",l.autocomplete="off"),t.description&&(d.dataset.tooltip=t.description),t.isboolean)l.checked=t.default;else if(t.isdate){var p=function(e){return e?Ma("now"===e?new Date:new Date(1e3*e)):""};l.max=p(t.max),l.min=p(t.min);var f=t.default?new Date(1e3*t.default):new Date;l.value=Ma(f)}else l.value=null!==t.default?t.default:"";return l.disabled=Boolean(t.disablewhenactive&&this.assetHasActiveOrders),s}},{key:"update",value:function(e,t,n){if(this.assetHasActiveOrders=n,this.configElements=[],this.configOpts=t||[],this.assetID=e,br.empty(this.dynamicOpts,this.defaultSettings,this.loadedSettings),0===this.configOpts.length)return br.hide(this.form);br.show(this.form),this.setOtherSettingsViz(!1),br.hide(this.loadedSettingsMsg,this.loadedSettings,this.defaultSettingsMsg,this.defaultSettings,this.errMsg);var r,a=[],o=da(this.configOpts);try{for(o.s();!(r=o.n()).done;){var s=r.value;this.sectionize&&null!==s.default?a.push(s):this.addOpt(this.dynamicOpts,s)}}catch(e){o.e(e)}finally{o.f()}if(a.length){var i,c=da(a);try{for(c.s();!(i=c.n()).done;){var l=i.value;this.addOpt(this.defaultSettings,l)}}catch(e){c.e(e)}finally{c.f()}br.show(this.showOther,this.defaultSettingsMsg,this.defaultSettings)}else br.hide(this.showOther);Sn().bindTooltips(this.allSettings),this.dynamicOpts.children.length?br.show(this.dynamicOpts):br.hide(this.dynamicOpts)}},{key:"setOtherSettingsViz",value:function(e){if(e)return br.hide(this.showIcon),br.show(this.hideIcon,this.otherSettings),void(this.showHideMsg.textContent=vn(T));br.hide(this.hideIcon,this.otherSettings),br.show(this.showIcon),this.showHideMsg.textContent=vn(D)}},{key:"setConfig",value:function(e){for(var t,n=[],a={},o=[],s=0,i=Vr(this.configElements);s<i.length;s++){var c=i[s],l=r(c,2),u=l[0],d=l[1],h=e[u.key];if(void 0!==h)if(u.repeatable){if(a[u.key]){d.remove(),o.push(c);continue}a[u.key]=!0;var p=h.split(u.repeatable),f=p[0];n.push(d),br.safeSelector(d,"input").value=f;for(var v=1;v<(u.repeatN||1);v++)n.push(this.addOpt(d.parentElement,u,d,!0));for(var m=1;m<p.length;m++){var g=this.addOpt(d.parentElement,u,d,!0);br.safeSelector(g,"input").value=p[m],n.push(g)}}else{n.push(d);var y=br.safeSelector(d,"input");u.isboolean?y.checked="1"===(t=h)||"true"===t.toLowerCase():u.isdate?y.value=Ma(new Date(1e3*parseInt(h))):y.value=h}}for(var k=0,b=o;k<b.length;k++){var w=b[k],x=this.configElements.indexOf(w);x>=0&&this.configElements.splice(x,1)}return n}},{key:"setLoadedConfig",value:function(e){var t,n=this.setConfig(e);this.sectionize&&0!==n.length&&((t=this.loadedSettings).append.apply(t,Vr(n)),this.reorder(this.loadedSettings),br.show(this.loadedSettings,this.loadedSettingsMsg),0===this.defaultSettings.children.length&&br.hide(this.defaultSettings,this.defaultSettingsMsg))}},{key:"map",value:function(e){var t,n={},a=da(this.configElements);try{for(a.s();!(t=a.n()).done;){var o=r(t.value,2),s=o[0],i=o[1],c=br.safeSelector(i,"input");if(void 0===s.regAsset||s.regAsset===e)if(s.isboolean&&s.key)n[s.key]=c.checked?"1":"0";else if(s.isdate&&s.key){var l=c.min?Da(new Date(c.min+"T00:00")):Number.MIN_SAFE_INTEGER,u=c.max?Da(new Date(c.max+"T00:00")):Number.MAX_SAFE_INTEGER,d=c.value?Da(new Date(c.value+"T00:00")):0;d<l?d=l:d>u&&(d=u),n[s.key]=""+d}else c.value&&(s.repeatable&&n[s.key]?n[s.key]+=s.repeatable+c.value:n[s.key]=c.value)}}catch(e){a.e(e)}finally{a.f()}return n}},{key:"reorder",value:function(e){var t=this,n={};e.querySelectorAll("input").forEach((function(e){var a=e.dataset.configKey;if(a){var o,s=[],i=da(t.configElements);try{for(i.s();!(o=i.n()).done;){var c=r(o.value,2),l=c[0],u=c[1];l.key===a&&s.push(u)}}catch(e){i.e(e)}finally{i.f()}n[a]=s}}));var a,o=da(this.configOpts);try{for(o.s();!(a=o.n()).done;){var s,i=a.value,c=da(n[i.key]||[]);try{for(c.s();!(s=c.n()).done;){var l=s.value;e.append(l)}}catch(e){c.e(e)}finally{c.f()}}}catch(e){o.e(e)}finally{o.f()}}}]),e}(),ma=function(){function e(t,n,r,a){var o=this;s(this,e),d(this,"form",void 0),d(this,"success",void 0),d(this,"page",void 0),d(this,"xc",void 0),d(this,"certFile",void 0),d(this,"bondAssetID",void 0),d(this,"pwCache",void 0),this.form=t,this.success=n,this.page=br.parseTemplate(t),this.certFile="",this.pwCache=a,br.bind(this.page.goBack,"click",(function(){return r()})),br.bind(this.page.bondStrengthField,"input",(function(){var e=Sn().assets[o.bondAssetID];if(e){var t=e.unitInfo,n=o.xc.bondAssets[e.symbol];o.page.bondAmt.textContent=br.formatCoinValue(o.totalBondAmount(n.amount),t)}})),Ta(t,this.page.submit,(function(){return o.submitForm()}))}var t,n;return u(e,[{key:"setExchange",value:function(e,t){this.xc=e,this.certFile=t;var n=this.page;Mr.passwordIsCached()||this.pwCache&&this.pwCache.pw?br.hide(n.passBox):br.show(n.passBox),n.host.textContent=e.host}},{key:"setAsset",value:function(e){var t=Sn().assets[e],n=t.unitInfo;this.bondAssetID=t.id;var r=this.page,a=this.xc.bondAssets[t.symbol];r.bondAmt.textContent=br.formatCoinValue(this.totalBondAmount(a.amount),n),r.bondUnit.textContent=n.conventional.unit.toUpperCase(),r.logo.src=br.logoPath(t.symbol)}},{key:"totalBondAmount",value:function(e){var t;return+(null!==(t=this.page.bondStrengthField.value)&&void 0!==t?t:1)*e}},{key:"animate",value:(n=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.form,br.animate(400,(function(e){t.style.transform="scale(".concat(e,")"),t.style.opacity=String(Math.pow(e,4));var n="".concat(500*(1-e),"px");t.style.top=n,t.style.left=n}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"submitForm",value:(t=o(b().mark((function e(){var t,n,r,a,o,s,i,c,l;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.page).submit.classList.contains("selected")){e.next=3;break}return e.abrupt("return");case 3:if(n=Sn().assets[this.bondAssetID]){e.next=8;break}return t.regErr.innerText=vn(gt),br.show(t.regErr),e.abrupt("return");case 8:return br.hide(t.regErr),r=this.xc.bondAssets[n.wallet.symbol],e.next=12,this.certFile;case 12:return a=e.sent,o=this.xc.host,s=t.appPass.value||(this.pwCache?this.pwCache.pw:""),i={addr:o,cert:a,pass:s,bond:this.totalBondAmount(r.amount),asset:r.id},t.appPass.value="",c=Sn().loading(this.form),e.next=20,Lr("/api/postbond",i);case 20:if(l=e.sent,c(),Sn().checkResponse(l)){e.next=26;break}return t.regErr.textContent=l.msg,br.show(t.regErr),e.abrupt("return");case 26:this.success();case 27:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),ga=function(){function e(t,n){var r=this;s(this,e),d(this,"form",void 0),d(this,"success",void 0),d(this,"xc",void 0),d(this,"page",void 0),d(this,"assetTmpls",void 0),this.form=t,this.success=n,this.page=br.parseTemplate(t),br.cleanTemplates(this.page.marketTmpl,this.page.assetTmpl),Sn().registerNoteFeeder({createwallet:function(e){"QueuedCreationSuccess"===e.topic&&r.walletCreated(e.assetID)}})}var t;return u(e,[{key:"setExchange",value:function(e){var t=this;this.xc=e,this.assetTmpls={};var n=this.page;br.empty(n.assets,n.allMarkets);for(var a=function(e){return e.conventional.conversionFactor},o=function(t,r){var o=n.marketTmpl.cloneNode(!0),s=br.parseTemplate(o),i=Sn().assets[t.baseid],c=Sn().assets[t.quoteid];if(0===a(i.unitInfo)||0===a(c.unitInfo))return null;if(void 0!==r){var l=r===t.baseid,u=e.assets[l?t.quoteid:t.baseid].symbol;s.logo.src=br.logoPath(u)}else{var d=s.logo.cloneNode(!0);s.logo.src=br.logoPath(i.symbol),d.src=br.logoPath(c.symbol);var h=s.logo.parentNode;h&&h.insertBefore(d,s.logo.nextSibling)}if(s.baseName.replaceWith(br.symbolize(i)),s.quoteName.replaceWith(br.symbolize(c)),s.lotSize.textContent=br.formatCoinValue(t.lotsize,i.unitInfo),s.lotSizeSymbol.replaceWith(br.symbolize(i)),t.spot){br.show(s.quoteLotSize);var p=a(c.unitInfo)/a(i.unitInfo),f=t.lotsize*t.spot.rate/Gn*p,v=br.formatCoinValue(f,c.unitInfo);s.quoteLotSize.textContent="(~".concat(v," ").concat(c.symbol,")")}return o},s=function(){var a=r(c[i],2),s=a[0],l=a[1],u=Sn().assets[l.id];if(!u)return"continue";var d=u.unitInfo,h=n.assetTmpl.cloneNode(!0);br.bind(h,"click",(function(){t.success(l.id)}));var p=t.assetTmpls[l.id]=br.parseTemplate(h);n.assets.appendChild(h),p.logo.src=br.logoPath(s);var f=br.formatCoinValue(l.amount,d);p.feeAmt.textContent=String(f),p.feeSymbol.replaceWith(br.symbolize(u)),p.confs.textContent=String(l.confs),ya(p.ready,u);for(var v=0,m=0,g=Object.values(e.markets);m<g.length;m++){var y=g[m];if(y.baseid===l.id||y.quoteid===l.id){var k=o(y,l.id);k&&(v++,p.markets.appendChild(k))}}v<3&&br.hide(p.fader)},i=0,c=Object.entries(e.bondAssets);i<c.length;i++)s();n.host.textContent=e.host;for(var l=0,u=Object.values(e.markets);l<u.length;l++){var d=u[l],h=o(d);h&&n.allMarkets.appendChild(h)}}},{key:"walletCreated",value:function(e){var t=this.assetTmpls[e],n=Sn().assets[e];ya(t.ready,n)}},{key:"refresh",value:function(){this.setExchange(this.xc)}},{key:"animate",value:(t=o(b().mark((function e(){var t,n,r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=this.form,r=t.how,(a=Array.from(t.assets.children)).push(t.allmkts),n.style.opacity="0",e.next=11,br.animate(350,(function(e){for(var t=0,o=a;t<o.length;t++){var s=o[t];s.style.marginTop="".concat(75*(1-e),"px"),s.style.transform="scale(".concat(e,")")}n.style.opacity=Math.pow(e,4).toFixed(1),n.style.paddingTop="".concat(50*(1-e),"px"),r.style.fontSize="".concat(24*e,"px")}),"easeOut");case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();function ya(e,t){t.wallet?e.textContent=vn(me):t.walletCreationPending?e.textContent=vn(ge):e.textContent=vn(ye),e.classList.remove("readygreen","setuporange"),e.classList.add(t.wallet?"readygreen":"setuporange")}var ka=function(){function e(t,n,r){var a=this;s(this,e),d(this,"form",void 0),d(this,"success",void 0),d(this,"goBack",void 0),d(this,"page",void 0),d(this,"assetID",void 0),d(this,"parentID",void 0),d(this,"xc",void 0),d(this,"bondAsset",void 0),d(this,"progressCache",void 0),d(this,"progressed",void 0),d(this,"funded",void 0),d(this,"bondFeeBuffer",void 0),d(this,"parentAssetSynced",void 0),this.form=t,this.success=n,this.page=br.parseTemplate(t),this.assetID=-1,this.progressCache=[],this.progressed=!1,this.funded=!1,br.bind(this.page.goBack,"click",(function(){a.assetID=-1,r()})),Sn().registerNoteFeeder({walletstate:function(e){return a.reportWalletState(e.wallet)},balance:function(e){return a.reportBalance(e.assetID)}})}return u(e,[{key:"setExchange",value:function(e){this.xc=e}},{key:"setWallet",value:function(e,t){var n;this.assetID=e.assetID,this.progressCache=[],this.progressed=!1,this.funded=!1,this.bondFeeBuffer=t,this.parentAssetSynced=!1;var r=this.page,a=Sn().assets[e.assetID];this.parentID=null===(n=a.token)||void 0===n?void 0:n.parentID;var o,s=this.bondAsset=this.xc.bondAssets[a.symbol],i=function(e,t){br.empty(e),e.appendChild(br.symbolize(t))},c=da(br.applySelector(this.form,".unit"));try{for(c.s();!(o=c.n()).done;)i(o.value,a)}catch(e){c.e(e)}finally{c.f()}if(r.logo.src=br.logoPath(a.symbol),r.depoAddr.textContent=e.address,r.fee.textContent=br.formatCoinValue(s.amount,a.unitInfo),br.hide(r.syncUncheck,r.syncCheck,r.balUncheck,r.balCheck,r.syncRemainBox),br.show(r.balanceBox),t>0)if(r.totalForBond.textContent=br.formatCoinValue(2*s.amount+t,a.unitInfo),br.hide(r.sendEnough),br.hide(r.txFeeBox,r.sendEnoughForToken,r.txFeeBalanceBox),br.hide(r.sendEnoughWithEst),a.token){br.show(r.txFeeBox,r.sendEnoughForToken,r.txFeeBalanceBox);var l=Sn().assets[a.token.parentID];r.txFee.textContent=br.formatCoinValue(t,l.unitInfo),r.parentFees.textContent=br.formatCoinValue(t,l.unitInfo),r.tokenFees.textContent=br.formatCoinValue(s.amount,a.unitInfo),i(r.txFeeUnit,l),i(r.parentUnit,l),i(r.parentBalUnit,l),r.parentBal.textContent=l.wallet?br.formatCoinValue(l.wallet.balance.available,l.unitInfo):"0"}else br.show(r.sendEnoughWithEst);else br.show(r.sendEnough);br.show(e.synced?r.syncCheck:e.syncProgress>=1?r.syncSpinner:r.syncUncheck),br.show(e.balance.available>=2*s.amount+t?r.balCheck:r.balUncheck),r.progress.textContent=(100*e.syncProgress).toFixed(1),e.synced&&(this.progressed=!0),this.reportBalance(e.assetID)}},{key:"reportWalletState",value:function(e){this.progressed&&this.funded||(e.assetID===this.assetID&&this.reportProgress(e.synced,e.syncProgress),this.reportBalance(e.assetID))}},{key:"reportBalance",value:function(e){if(!this.funded&&-1!==this.assetID&&(e===this.assetID||e===this.parentID)){var t=this.page,n=Sn().assets[this.assetID],r=n.wallet.balance.available;if(t.balance.textContent=br.formatCoinValue(r,n.unitInfo),n.token){var a=Sn().assets[n.token.parentID],o=a.wallet.balance.available;if(t.parentBal.textContent=br.formatCoinValue(o,a.unitInfo),o<this.bondFeeBuffer)return}r<2*this.bondAsset.amount+this.bondFeeBuffer||(br.show(t.balCheck),br.hide(t.balUncheck,t.balanceBox,t.sendEnough),this.funded=!0,this.progressed&&this.success())}}},{key:"reportProgress",value:function(e,t){var n=this.page;if(e)return n.progress.textContent="100",br.hide(n.syncUncheck,n.syncRemainBox,n.syncSpinner),br.show(n.syncCheck),this.progressed=!0,void(this.funded&&this.success());if(1===t?(br.hide(n.syncUncheck),br.show(n.syncSpinner)):(br.hide(n.syncSpinner),br.show(n.syncUncheck)),n.progress.textContent=(100*t).toFixed(1),t>=.999)return br.hide(n.syncRemaining),br.show(n.syncFinishingUp),br.show(n.syncRemainBox),void(n.syncFinishingUp.textContent=vn(kt));var r=this.progressCache;if(r.push({stamp:(new Date).getTime(),progress:t}),!(r.length<2)){for(;r.length>20;)r.shift();var a=[r[0],r[r.length-1]],o=a[0],s=a[1],i=s.progress-o.progress;if(0!==i){br.hide(n.syncFinishingUp),br.show(n.syncRemaining),br.show(n.syncRemainBox);var c=i/(s.stamp-o.stamp),l=(1-s.progress)/c;n.syncRemain.textContent=br.formatDuration(l)}}}}]),e}(),ba=function(){function e(t,n,r){var a=this;s(this,e),d(this,"form",void 0),d(this,"success",void 0),d(this,"pwCache",void 0),d(this,"page",void 0),d(this,"currentAsset",void 0),this.page=br.idDescendants(t),this.form=t,this.pwCache=r||null,this.success=n,Ta(t,this.page.submitUnlock,(function(){return a.submit()}))}var t;return u(e,[{key:"refresh",value:function(e){var t=this.page;this.currentAsset=e,t.uwAssetLogo.src=br.logoPath(e.symbol),t.uwAssetName.textContent=e.name,t.uwAppPass.value="",t.unlockErr.textContent="",br.hide(t.unlockErr),Mr.passwordIsCached()||this.pwCache&&this.pwCache.pw?br.hide(t.uwAppPassBox):br.show(t.uwAppPassBox)}},{key:"setError",value:function(e){this.page.unlockErr.textContent=e,br.show(this.page.unlockErr)}},{key:"showErrorOnly",value:function(e){this.setError(e),br.hide(this.page.uwAppPassBox),br.hide(this.page.submitUnlockDiv)}},{key:"submit",value:(t=o(b().mark((function e(){var t,n,r,a,o,s;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,(n=t.uwAppPass.value||(this.pwCache?this.pwCache.pw:""))||Mr.passwordIsCached()){e.next=6;break}return t.unlockErr.textContent=vn(x),br.show(t.unlockErr),e.abrupt("return");case 6:return r=this.currentAsset.id,br.hide(this.page.unlockErr),a={assetID:r,pass:n},t.uwAppPass.value="",o=Sn().loading(this.form),e.next=13,Lr("/api/openwallet",a);case 13:if(s=e.sent,o(),Sn().checkResponse(s)){e.next=18;break}return this.setError(s.msg),e.abrupt("return");case 18:this.pwCache&&(this.pwCache.pw=n),this.success(r);case 20:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),wa=function(){function e(t,n){var r=this;s(this,e),d(this,"form",void 0),d(this,"page",void 0),d(this,"order",void 0),d(this,"acceleratedRate",void 0),d(this,"earlyAcceleration",void 0),d(this,"currencyUnit",void 0),d(this,"success",void 0),this.form=t,this.success=n;var a=this.page=br.idDescendants(t);br.bind(a.accelerateSubmit,"click",(function(){r.submit()})),br.bind(a.submitEarlyConfirm,"click",(function(){r.sendAccelerateRequest()}))}var t,n,r,a;return u(e,[{key:"displayEarlyAccelerationMsg",value:function(){var e=this.page;this.earlyAcceleration&&(e.recentAccelerationTime.textContent="".concat(Math.floor(this.earlyAcceleration.timePast/60)),e.recentSwapTime.textContent="".concat(Math.floor(this.earlyAcceleration.timePast/60)),this.earlyAcceleration.wasAcceleration?(br.show(e.recentAccelerationMsg),br.hide(e.recentSwapMsg),e.recentAccelerationTime.textContent="".concat(Math.floor(this.earlyAcceleration.timePast/60))):(br.show(e.recentSwapMsg),br.hide(e.recentAccelerationMsg),e.recentSwapTime.textContent="".concat(Math.floor(this.earlyAcceleration.timePast/60))),br.hide(e.configureAccelerationDiv,e.accelerateErr),br.show(e.earlyAccelerationDiv))}},{key:"sendAccelerateRequest",value:(a=o(b().mark((function e(){var t,n,r,a,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.order,n=this.page,r={pw:n.acceleratePass.value,orderID:t.id,newRate:this.acceleratedRate},n.acceleratePass.value="",a=Sn().loading(n.accelerateMainDiv),e.next=7,Lr("/api/accelerateorder",r);case 7:o=e.sent,a(),Sn().checkResponse(o)?(n.accelerateTxID.textContent=o.txID,br.hide(n.accelerateMainDiv,n.preAccelerateErr,n.accelerateErr),br.show(n.accelerateMsgDiv,n.accelerateSuccess),this.success()):(n.accelerateErr.textContent=vn(lt,{msg:o.msg}),br.hide(n.earlyAccelerationDiv),br.show(n.accelerateErr,n.configureAccelerationDiv));case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"submit",value:(r=o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.earlyAcceleration?this.displayEarlyAccelerationMsg():this.sendAccelerateRequest();case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"refresh",value:(n=o(b().mark((function e(t){var n,r,a,o,s,i,c=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,this.order=t,e.next=4,Lr("/api/preaccelerate",t.id);case 4:if(r=e.sent,Sn().checkResponse(r)){e.next=10;break}return n.preAccelerateErr.textContent=vn(lt,{msg:r.msg}),br.hide(n.accelerateMainDiv,n.accelerateSuccess),br.show(n.accelerateMsgDiv,n.preAccelerateErr),e.abrupt("return");case 10:br.hide(n.accelerateMsgDiv,n.preAccelerateErr,n.accelerateErr,n.feeEstimateDiv,n.earlyAccelerationDiv),br.show(n.accelerateMainDiv,n.accelerateSuccess,n.configureAccelerationDiv),a=r.preAccelerate,this.earlyAcceleration=a.earlyAcceleration,this.currencyUnit=a.suggestedRange.yUnit,n.accelerateAvgFeeRate.textContent="".concat(a.swapRate," ").concat(a.suggestedRange.yUnit),n.accelerateCurrentFeeRate.textContent="".concat(a.suggestedRate," ").concat(a.suggestedRange.yUnit),this.acceleratedRate=a.suggestedRange.start.y,o=function(){},s=function(e,t){c.acceleratedRate=t},i=new Ln(a.suggestedRange,a.suggestedRange.start.x,s,(function(){return c.updateAccelerationEstimate()}),o,!0),br.empty(n.sliderContainer),n.sliderContainer.appendChild(i.control),this.updateAccelerationEstimate();case 25:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateAccelerationEstimate",value:(t=o(b().mark((function e(){var t,n,r,a,o,s,i,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=this.order,r={orderID:n.id,newRate:this.acceleratedRate},a=Sn().loading(t.sliderContainer),e.next=6,Lr("/api/accelerationestimate",r);case 6:if(o=e.sent,a(),Sn().checkResponse(o)){e.next=12;break}return t.accelerateErr.textContent=vn(ct,{msg:o.msg}),br.show(t.accelerateErr),e.abrupt("return");case 12:t.feeRateEstimate.textContent="".concat(this.acceleratedRate," ").concat(this.currencyUnit),n.sell?(s=n.baseID,i=n.baseSymbol):(s=n.quoteID,i=n.quoteSymbol),c=Sn().unitInfo(s),t.feeEstimate.textContent="".concat(o.fee/c.conventional.conversionFactor," ").concat(i),br.show(t.feeEstimateDiv);case 17:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),xa=function(){function e(t,n,r,a){var o=this;s(this,e),d(this,"form",void 0),d(this,"success",void 0),d(this,"pwCache",void 0),d(this,"page",void 0),d(this,"knownExchanges",void 0),d(this,"dexToUpdate",void 0),this.form=t,this.success=n,this.pwCache=r||null;var i=this.page=br.parseTemplate(t);i.selectedCert.textContent=vn(ie),br.bind(i.skipRegistration,"change",(function(){return o.showOrHidePWBox()})),br.bind(i.certFile,"change",(function(){return o.onCertFileChange()})),br.bind(i.removeCert,"click",(function(){return o.clearCertFile()})),br.bind(i.addCert,"click",(function(){return i.certFile.click()})),br.bind(i.showCustom,"click",(function(){br.hide(i.showCustom),br.show(i.customBox,i.auth)})),this.knownExchanges=Array.from(i.knownXCs.querySelectorAll(".known-exchange"));var c,l=da(this.knownExchanges);try{var u=function(){var e=c.value;br.bind(e,"click",(function(){var t,n=e.dataset.host,a=da(o.knownExchanges);try{for(a.s();!(t=a.n()).done;)t.value.classList.remove("selected")}catch(e){a.e(e)}finally{a.f()}if(o.skipRegistration()||Mr.passwordIsCached()||r&&r.pw)return o.checkDEX(n);e.classList.add("selected"),i.appPW.focus(),i.addr.value=n}))};for(l.s();!(c=l.n()).done;)u()}catch(e){l.e(e)}finally{l.f()}Ta(t,i.submit,(function(){return o.checkDEX()})),a&&(br.hide(i.addDexHdr,i.skipRegistrationBox),br.show(i.updateDexHdr),this.dexToUpdate=a),this.refresh()}var t,n,r;return u(e,[{key:"refresh",value:function(){var e=this.page;e.addr.value="",e.appPW.value="",this.clearCertFile(),br.hide(e.err),0===this.knownExchanges.length||this.dexToUpdate?(br.show(e.customBox,e.auth),br.hide(e.showCustom,e.knownXCs,e.pickServerMsg,e.addCustomMsg)):(br.hide(e.customBox),br.show(e.showCustom));var t,n=da(this.knownExchanges);try{for(n.s();!(t=n.n()).done;)t.value.classList.remove("selected")}catch(e){n.e(e)}finally{n.f()}this.showOrHidePWBox()}},{key:"showOrHidePWBox",value:function(){var e=!(Mr.passwordIsCached()||this.pwCache&&this.pwCache.pw||this.skipRegistration()),t=this.page;e?br.show(t.appPWBox,t.auth):(br.hide(t.appPWBox),br.setVis(br.isDisplayed(t.customBox),t.auth))}},{key:"skipRegistration",value:function(){var e;return null!==(e=this.page.skipRegistration.checked)&&void 0!==e&&e}},{key:"animate",value:(r=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.form,br.animate(550,(function(e){t.style.transform="scale(".concat(.9+.1*e,")"),t.style.opacity=String(Math.pow(e,4))}),"easeOut");case 2:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"checkDEX",value:(n=o(b().mark((function e(t){var n,r,a,o,s,i,c,l,u;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,br.hide(n.err),""!==(t=t||n.addr.value)){e.next=7;break}return n.err.textContent=vn(mt),br.show(n.err),e.abrupt("return");case 7:if(r="",!n.certFile.value){e.next=14;break}if(!(a=n.certFile.files)||!a.length){e.next=14;break}return e.next=13,a[0].text();case 13:r=e.sent;case 14:return o=this.skipRegistration(),s="",o||Mr.passwordIsCached()||(s=n.appPW.value||(this.pwCache?this.pwCache.pw:"")),this.dexToUpdate?(i="/api/updatedexhost",c={newHost:t,cert:r,pw:s,oldHost:this.dexToUpdate}):(i=o?"/api/adddex":"/api/discoveracct",c={addr:t,cert:r,pass:s}),l=Sn().loading(this.form),e.next=21,Lr(i,c);case 21:if(u=e.sent,l(),Sn().checkResponse(u)){e.next=26;break}return String(u.msg).includes("certificate required")?br.show(n.needCert):(n.err.textContent=u.msg,br.show(n.err)),e.abrupt("return");case 26:if(this.dexToUpdate||!(o||u.paid||Object.keys(u.xc.auth.pendingBonds).length>0)){e.next=32;break}return e.next=29,Sn().fetchUser();case 29:return e.next=31,Sn().loadPage("markets");case 31:return e.abrupt("return");case 32:this.pwCache&&(this.pwCache.pw=s),this.success(u.xc,r);case 34:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onCertFileChange",value:(t=o(b().mark((function e(){var t,n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,(n=t.certFile.files)&&n.length){e.next=4;break}return e.abrupt("return");case 4:t.selectedCert.textContent=n[0].name,br.show(t.removeCert),br.hide(t.addCert);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"clearCertFile",value:function(){var e=this.page;e.certFile.value="",e.selectedCert.textContent=vn(ie),br.hide(e.removeCert),br.show(e.addCert)}}]),e}(),Ca=function(){function e(t,n,r,a){var o=this;s(this,e),d(this,"form",void 0),d(this,"addr",void 0),d(this,"success",void 0),d(this,"pwCache",void 0),d(this,"page",void 0),this.form=t,this.addr=n,this.success=r,this.pwCache=a||null;var i=this.page=br.parseTemplate(t);i.dexHost.textContent=n,Ta(t,i.submit,(function(){return o.checkDEX()})),this.refresh()}var t,n;return u(e,[{key:"refresh",value:function(){var e=this.page;e.appPW.value="",br.hide(e.err),Mr.passwordIsCached()||this.pwCache&&this.pwCache.pw?br.hide(e.appPWBox):br.show(e.appPWBox)}},{key:"animate",value:(n=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.form,br.animate(550,(function(e){t.style.transform="scale(".concat(.9+.1*e,")"),t.style.opacity=String(Math.pow(e,4))}),"easeOut");case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"checkDEX",value:(t=o(b().mark((function e(){var t,n,r,a,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,br.hide(t.err),n="",Mr.passwordIsCached()||(n=t.appPW.value||(this.pwCache?this.pwCache.pw:"")),r={addr:this.addr,pass:n},a=Sn().loading(this.form),e.next=8,Lr("/api/discoveracct",r);case 8:if(o=e.sent,a(),Sn().checkResponse(o)){e.next=14;break}return t.err.textContent=o.msg,br.show(t.err),e.abrupt("return");case 14:if(!o.paid){e.next=20;break}return e.next=17,Sn().fetchUser();case 17:return e.next=19,Sn().loadPage("markets");case 19:return e.abrupt("return");case 20:this.pwCache&&(this.pwCache.pw=n),this.success(o.xc);case 22:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Sa=function(){function e(t,n,r){var a=this;s(this,e),d(this,"form",void 0),d(this,"success",void 0),d(this,"pwCache",void 0),d(this,"headerTxt",void 0),d(this,"page",void 0),this.success=n,this.form=t,this.pwCache=r||null;var o=this.page=br.parseTemplate(t);this.headerTxt=o.header.textContent||"",Ta(t,o.submit,(function(){a.submit()})),Sn().registerNoteFeeder({login:function(e){a.handleLoginNote(e)}})}var t,n;return u(e,[{key:"handleLoginNote",value:function(e){if(""!==e.details){var t=br.idel(this.form,"loaderMsg");t&&(t.textContent=e.details)}}},{key:"focus",value:function(){this.page.pw.focus()}},{key:"refresh",value:function(){br.hide(this.page.errMsg),this.page.pw.value="",this.page.rememberPass.checked=!1}},{key:"submit",value:(n=o(b().mark((function e(){var t,n,r,a,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,br.hide(t.errMsg),n=t.pw.value||"",r=t.rememberPass.checked,""!==n){e.next=7;break}return br.showFormError(t.errMsg,vn(w)),e.abrupt("return");case 7:return a=Sn().loading(this.form),e.next=10,Lr("/api/login",{pass:n,rememberPass:r});case 10:if(o=e.sent,a(),t.pw.value="",Sn().checkResponse(o)){e.next=16;break}return br.showFormError(t.errMsg,o.msg),e.abrupt("return");case 16:o.notes&&(o.notes.reverse(),Sn().setNotes(o.notes)),this.pwCache&&(this.pwCache.pw=n),this.success();case 19:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"animate",value:(t=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.form,br.animate(550,(function(e){t.style.transform="scale(".concat(.9+.1*e,")"),t.style.opacity=String(Math.pow(e,4))}),"easeOut");case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Aa=function(){function e(t){var n=this;s(this,e),d(this,"form",void 0),d(this,"page",void 0),d(this,"assetID",void 0),this.form=t;var r=this.page=br.idDescendants(t);br.bind(r.newDepAddrBttn,"click",o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.newDepositAddress();case 1:case"end":return e.stop()}}),e)})))),br.bind(r.copyAddressBtn,"click",(function(){n.copyAddress()}))}var t,n,r;return u(e,[{key:"setAsset",value:(r=o(b().mark((function e(t){var n,r,a,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assetID=t,n=this.page,br.hide(n.depositErr,n.depositTokenMsgBox),r=Sn().assets[t],n.depositLogo.src=br.logoPath(r.symbol),a=Sn().walletMap[t],n.depositName.textContent=r.unitInfo.conventional.unit,n.depositAddress.textContent=a.address,n.qrcode.src="/generateqrcode?address=".concat(a.address),r.token&&(o=Sn().assets[r.token.parentID],n.depositTokenParentLogo.src=br.logoPath(o.symbol),n.depositTokenParentName.textContent=o.name,br.show(n.depositTokenMsgBox)),0!=(2&a.traits)?br.show(n.newDepAddrBttn):br.hide(n.newDepAddrBttn);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"newDepositAddress",value:(n=o(b().mark((function e(){var t,n,r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,br.hide(t.depositErr),n=Sn().loading(this.form),e.next=5,Lr("/api/depositaddress",{assetID:this.assetID});case 5:if(r=e.sent,n(),Sn().checkResponse(r)){e.next=11;break}return t.depositErr.textContent=r.msg,br.show(t.depositErr),e.abrupt("return");case 11:t.depositAddress.textContent=r.address,t.qrcode.src="/generateqrcode?address=".concat(r.address);case 13:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"copyAddress",value:(t=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.page,navigator.clipboard.writeText(t.depositAddress.textContent||"").then((function(){br.show(t.copyAlert),setTimeout((function(){br.hide(t.copyAlert)}),800)})).catch((function(e){console.error("Unable to copy: ",e)}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Fa=function(){function e(t,n){var r=this;s(this,e),d(this,"form",void 0),d(this,"page",void 0),d(this,"success",void 0),this.form=t,this.success=n,Ta(t,(this.page=br.idDescendants(t)).resetAppPWSubmitBtn,(function(){return r.resetAppPW()}))}var t;return u(e,[{key:"resetAppPW",value:(t=o(b().mark((function e(){var t,n,r,a,o,s,i,c=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,r=n.newAppPassword.value||"",a=n.confirmNewAppPassword.value,""!==r){e.next=6;break}return br.showFormError(n.appPWResetErrMsg,vn(w)),e.abrupt("return");case 6:if(r===a){e.next=9;break}return br.showFormError(n.appPWResetErrMsg,vn(K)),e.abrupt("return");case 9:if((o=null===(t=n.seedInput.value)||void 0===t?void 0:t.replace(/\s+/g,""))&&128===o.length){e.next=13;break}return br.showFormError(n.appPWResetErrMsg,vn($t)),e.abrupt("return");case 13:return s=Sn().loading(this.form),e.next=16,Lr("/api/resetapppassword",{newPass:r,seed:o});case 16:if(i=e.sent,s(),Sn().checkResponse(i)){e.next=21;break}return br.showFormError(n.appPWResetErrMsg,i.msg),e.abrupt("return");case 21:br.isDisplayed(n.appPWResetErrMsg)&&br.hide(n.appPWResetErrMsg),n.appPWResetSuccessMsg.textContent=vn(en),br.show(n.appPWResetSuccessMsg),setTimeout((function(){return c.success()}),3e3);case 25:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"focus",value:function(){this.page.newAppPassword.focus()}},{key:"refresh",value:function(){var e=this.page;e.newAppPassword.value="",e.confirmNewAppPassword.value="",br.hide(e.appPWResetSuccessMsg,e.appPWResetErrMsg)}}]),e}(),Ea=300;function Ia(e,t){return Ra.apply(this,arguments)}function Ra(){return(Ra=o(b().mark((function e(t,n){var r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=document.body.offsetWidth/2,e.next=3,br.animate(Ea,(function(e){t.style.right="".concat(e*r,"px")}),"easeInHard");case 3:return br.hide(t),t.style.right="0",n.style.right=String(-r),br.show(n),n.querySelector("input")&&br.safeSelector(n,"input").focus(),e.next=10,br.animate(Ea,(function(e){n.style.right="".concat(e*r-r,"px")}),"easeOutHard");case 10:n.style.right="0";case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ta(e,t,n){var r=function(e){e.preventDefault&&e.preventDefault(),n(e)};br.bind(t,"click",r),br.bind(e,"submit",r)}function Da(e){return Math.floor(e.getTime()/1e3)}function Ma(e){return function(e){return new Date(e.getTime()-60*e.getTimezoneOffset()*1e3)}(e).toISOString().split("T")[0]}function Pa(e){var t=Sn().user.assets[e];return t.token?Sn().user.assets[t.token.parentID].symbol:t.symbol}function Ba(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Oa=function(e){En(m,e);var t,n,r,a,i,c,l,h,p,f,v=(p=m,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rn(p);if(f){var n=Rn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return In(this,e)});function m(e,t){var n,r;s(this,m),d(An(r=v.call(this)),"body",void 0),d(An(r),"pwCache",void 0),d(An(r),"currentDEX",void 0),d(An(r),"page",void 0),d(An(r),"loginForm",void 0),d(An(r),"appPassResetForm",void 0),d(An(r),"dexAddrForm",void 0),d(An(r),"discoverAcctForm",void 0),d(An(r),"newWalletForm",void 0),d(An(r),"regAssetForm",void 0),d(An(r),"walletWaitForm",void 0),d(An(r),"confirmRegisterForm",void 0),r.body=e,r.pwCache={pw:""};var a=r.page=br.idDescendants(e);t.host&&a.dexAddrForm.classList.contains("selected")&&(a.dexAddrForm.classList.remove("selected"),a.discoverAcctForm.classList.add("selected"),a.discoverAcctForm.dataset.host=t.host),r.loginForm=new Sa(a.loginForm,o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sn().fetchUser();case 2:r.discoverAcctForm?(r.discoverAcctForm.refresh(),Ia(a.loginForm,a.discoverAcctForm)):(r.dexAddrForm.refresh(),Ia(a.loginForm,a.dexAddrForm));case 3:case"end":return e.stop()}}),e)}))),r.pwCache);var i=function(){br.hide(a.resetAppPWForm),r.loginForm.refresh(),br.show(a.loginForm),r.loginForm.focus()};r.appPassResetForm=new Fa(a.resetAppPWForm,(function(){i()})),br.bind(a.forgotPassBtn,"click",(function(){return Ia(a.loginForm,a.resetAppPWForm)})),br.bind(a.resetPassFormCloser,"click",(function(){i()})),br.bind(a.forms,"mousedown",(function(e){!br.mouseInElement(e,a.resetAppPWForm)&&br.isDisplayed(a.resetAppPWForm)&&i()}));var c,l=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ba(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ba(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}(e.querySelectorAll(".form-closer"));try{for(l.s();!(c=l.n()).done;){var u=c.value;u!==a.resetPassFormCloser&&br.hide(u)}}catch(e){l.e(e)}finally{l.f()}r.newWalletForm=new pa(a.newWalletForm,(function(e){return r.newWalletCreated(e)}),r.pwCache,(function(){return r.animateRegAsset(a.newWalletForm)})),r.dexAddrForm=new xa(a.dexAddrForm,function(){var e=o(b().mark((function e(t,n){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.requestFeepayment(a.dexAddrForm,t,n);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),r.pwCache);var h=a.discoverAcctForm.dataset.host;h&&(r.discoverAcctForm=new Ca(a.discoverAcctForm,h,function(){var e=o(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.requestFeepayment(a.discoverAcctForm,t,"");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.pwCache)),r.regAssetForm=new ga(a.regAssetForm,function(){var e=o(b().mark((function e(t){var n,o,s,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.confirmRegisterForm.setAsset(t),n=Sn().assets[t],!(o=n.wallet)){e.next=14;break}return s=r.currentDEX.bondAssets[n.symbol],e.next=7,r.getBondsFeeBuffer(t,a.regAssetForm);case 7:if(i=e.sent,!(o.synced&&o.balance.available>=2*s.amount+i)){e.next=11;break}return r.animateConfirmForm(a.regAssetForm),e.abrupt("return");case 11:return r.walletWaitForm.setWallet(o,i),Ia(a.regAssetForm,a.walletWait),e.abrupt("return");case 14:r.newWalletForm.setAsset(t),Ia(a.regAssetForm,a.newWalletForm);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r.walletWaitForm=new ka(a.walletWait,(function(){r.animateConfirmForm(a.walletWait)}),(function(){r.animateRegAsset(a.walletWait)})),r.confirmRegisterForm=new ma(a.confirmRegForm,(function(){r.registerDEXSuccess()}),(function(){r.animateRegAsset(a.confirmRegForm)}),r.pwCache);var p=br.safeSelector(a.forms,":scope > form.selected");switch(p.classList.remove("selected"),p){case a.loginForm:r.loginForm.animate();break;case a.dexAddrForm:r.dexAddrForm.animate();break;case a.discoverAcctForm:r.discoverAcctForm.animate()}return br.show(p),p===a.discoverAcctForm&&(Mr.passwordIsCached()||null!==(n=r.pwCache)&&void 0!==n&&n.pw)&&r.discoverAcctForm.page.submit.click(),Sn().authed()&&r.auth(),r}return u(m,[{key:"unload",value:function(){this.pwCache.pw=""}},{key:"auth",value:(h=o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sn().fetchUser();case 2:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"requestFeepayment",value:(l=o(b().mark((function e(t,n,r){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.currentDEX=n,this.confirmRegisterForm.setExchange(n,r),this.walletWaitForm.setExchange(n),this.regAssetForm.setExchange(n),this.animateRegAsset(t);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return l.apply(this,arguments)})},{key:"animateRegAsset",value:(c=o(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:br.hide(t),this.regAssetForm.animate(),br.show(this.page.regAssetForm);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"animateConfirmForm",value:(i=o(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.confirmRegisterForm.animate(),br.hide(t),br.show(this.page.confirmRegForm);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getBondsFeeBuffer",value:(a=o(b().mark((function e(t,n){var r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Sn().loading(n),e.next=3,Lr("/api/bondsfeebuffer",{assetID:t});case 3:if(a=e.sent,r(),Sn().checkResponse(a)){e.next=7;break}return e.abrupt("return",0);case 7:return e.abrupt("return",a.feeBuffer);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return a.apply(this,arguments)})},{key:"getCertFile",value:(r=o(b().mark((function e(){var t,n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="",!this.dexAddrForm.page.certFile.value){e.next=7;break}if(!(n=this.dexAddrForm.page.certFile.files)||!n.length){e.next=7;break}return e.next=6,n[0].text();case 6:t=e.sent;case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"registerDEXSuccess",value:(n=o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sn().fetchUser();case 2:return e.next=4,Sn().loadPage("markets");case 4:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"newWalletCreated",value:(t=o(b().mark((function e(t){var n,r,a,o,s,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.regAssetForm.refresh(),e.next=3,Sn().fetchUser();case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return");case 6:return r=this.page,a=n.assets[t],o=a.wallet,s=this.currentDEX.bondAssets[a.symbol].amount,e.next=12,this.getBondsFeeBuffer(t,r.newWalletForm);case 12:if(i=e.sent,!(o.synced&&o.balance.available>=2*s+i)){e.next=17;break}return e.next=16,this.animateConfirmForm(r.newWalletForm);case 16:return e.abrupt("return");case 17:return this.walletWaitForm.setWallet(o,i),e.next=20,Ia(r.newWalletForm,r.walletWait);case 20:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),m}(Pr);var La,Wa,qa,Na,Ua,Va,_a,za,ja,Ha,Ga,Ka=function(e){En(i,e);var t,n,r,a=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rn(n);if(r){var a=Rn(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return In(this,e)});function i(e){var t;s(this,i),d(An(t=a.call(this)),"loginForm",void 0),d(An(t),"page",void 0),d(An(t),"appPassResetForm",void 0);var n=t.page=br.idDescendants(e);t.loginForm=new Sa(n.loginForm,(function(){t.loggedIn()}));var r=function(){br.hide(n.resetAppPWForm),t.loginForm.refresh(),br.show(n.loginForm),t.loginForm.focus()};return r(),t.appPassResetForm=new Fa(n.resetAppPWForm,(function(){r()})),br.bind(n.forgotPassBtn,"click",(function(){return Ia(n.loginForm,n.resetAppPWForm)})),br.bind(n.resetPassFormCloser,"click",(function(){r()})),br.bind(n.forms,"mousedown",(function(e){!br.mouseInElement(e,n.resetAppPWForm)&&br.isDisplayed(n.resetAppPWForm)&&r()})),t}return u(i,[{key:"loggedIn",value:(t=o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sn().fetchUser();case 2:return e.next=4,Sn().loadPage("wallets");case 4:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),i}(Pr);function Xa(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ya(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ya(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function Ya(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Qa,Ja=288e5,Za="TakerFoundMakerRedemption:",$a=function(e){En(p,e);var t,n,r,a,i,c,l,h=(c=p,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rn(c);if(l){var n=Rn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return In(this,e)});function p(e){var t;s(this,p),d(An(t=h.call(this)),"orderID",void 0),d(An(t),"order",void 0),d(An(t),"page",void 0),d(An(t),"currentForm",void 0),d(An(t),"secondTicker",void 0),d(An(t),"refreshOnPopupClose",void 0),d(An(t),"accelerateOrderForm",void 0),d(An(t),"stampers",void 0);var n=t.page=br.idDescendants(e);t.stampers=br.applySelector(e,"[data-stamp]"),Qa=Sn().user.net,t.orderID=e.dataset.oid||"",br.cleanTemplates(n.matchCardTmpl);var r=function(){var e,n=Xa(t.stampers);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.textContent=br.timeSince(parseInt(r.dataset.stamp||""))}}catch(e){n.e(e)}finally{n.f()}};return r(),n.forms.querySelectorAll(".form-closer").forEach((function(e){br.bind(e,"click",(function(){t.refreshOnPopupClose?window.location.replace(window.location.href):br.hide(n.forms)}))})),e.querySelectorAll("[data-explorer-id]").forEach((function(e){oo(parseInt(e.dataset.explorerId||""),e)})),n.cancelBttn&&br.bind(n.cancelBttn,"click",(function(){t.showForm(n.cancelForm)})),br.bind(n.accelerateBttn,"click",(function(){t.showAccelerateForm()})),Dn(n),t.accelerateOrderForm=new wa(n.accelerateForm,(function(){t.refreshOnPopupClose=!0})),br.cleanTemplates(n.booleanOptTmpl,n.rangeOptTmpl,n.orderOptTmpl),br.bind(n.forms,"mousedown",(function(e){if(!br.mouseInElement(e,t.currentForm)){if(t.refreshOnPopupClose)return void window.location.reload();br.hide(n.forms)}})),Ta(n.cancelForm,n.cancelSubmit,o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.submitCancel();case 1:case"end":return e.stop()}}),e)})))),t.secondTicker=window.setInterval((function(){r()}),1e4),Sn().registerNoteFeeder({order:function(e){t.handleOrderNote(e)},match:function(e){t.handleMatchNote(e)}}),t.start(),t}return u(p,[{key:"start",value:(i=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=Sn().order(this.orderID))){e.next=5;break}this.order=t,e.next=8;break;case 5:return e.next=7,this.fetchOrder();case 7:t=e.sent;case 8:this.page.mktBaseSymbol.replaceWith(br.symbolize(Sn().assets[t.baseID])),this.page.mktQuoteSymbol.replaceWith(br.symbolize(Sn().assets[t.quoteID])),this.setAccelerationButtonVis(),this.showMatchCards();case 12:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"unload",value:function(){clearInterval(this.secondTicker)}},{key:"fetchOrder",value:(a=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lr("/api/order",this.orderID);case 2:if(t=e.sent,Sn().checkResponse(t)){e.next=5;break}throw t.msg;case 5:return this.order=t.order,e.abrupt("return",this.order);case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"setImmutableMatchCardElements",value:function(e,t){var n=br.parseTemplate(e);n.matchID.textContent=t.matchID;var r=new Date(t.stamp);n.matchTime.textContent=r.toLocaleTimeString(navigator.languages,{year:"numeric",month:"short",day:"numeric"}),n.matchTimeAgo.dataset.stamp=t.stamp.toString(),n.matchTimeAgo.textContent=br.timeSince(t.stamp),this.stampers.push(n.matchTimeAgo);var a=function(e,t){var n=t.qty;return Yn(e)&&(n=nr(t.rate,t.qty)),(n/e.qty*100).toFixed(1)+" %"}(this.order,t),o=br.bipSymbol(this.order.baseID),s=br.bipSymbol(this.order.quoteID),i=Sn().unitInfo(this.order.baseID),c=Sn().unitInfo(this.order.quoteID),l=[i.conventional.unit.toLowerCase(),c.conventional.unit.toLowerCase()],u=l[0],d=l[1],h=nr(t.rate,t.qty);if(t.isCancel)return br.show(n.cancelInfoDiv),br.hide(n.infoDiv,n.status,n.statusHdr),this.order.sell?(n.cancelAmount.textContent=br.formatCoinValue(t.qty,i),n.cancelIcon.src=br.logoPathFromID(this.order.baseID)):(n.cancelAmount.textContent=br.formatCoinValue(h,c),n.cancelIcon.src=br.logoPathFromID(this.order.quoteID)),void(n.cancelOrderPortion.textContent=a);br.show(n.infoDiv),br.hide(n.cancelInfoDiv),n.orderPortion.textContent=a,t.side===Hn?(n.side.textContent=vn(vt),br.show(n.makerSwapYou,n.makerRedeemYou,n.takerSwapThem,n.takerRedeemThem),br.hide(n.takerSwapYou,n.takerRedeemYou,n.makerSwapThem,n.makerRedeemThem)):(n.side.textContent=vn(ft),br.hide(n.makerSwapYou,n.makerRedeemYou,n.takerSwapThem,n.takerRedeemThem),br.show(n.takerSwapYou,n.takerRedeemYou,n.makerSwapThem,n.makerRedeemThem)),t.side===Hn&&this.order.sell||1===t.side&&!this.order.sell?(n.makerSwapAsset.textContent=u,n.takerSwapAsset.textContent=d,n.makerRedeemAsset.textContent=d,n.takerRedeemAsset.textContent=u):(n.makerSwapAsset.textContent=d,n.takerSwapAsset.textContent=u,n.makerRedeemAsset.textContent=u,n.takerRedeemAsset.textContent=d);var p=Sn().conventionalRate(this.order.baseID,this.order.quoteID,t.rate);n.rate.textContent="".concat(p," ").concat(u,"/").concat(d),this.order.sell?(n.refundAsset.textContent=o,n.fromAmount.textContent=br.formatCoinValue(t.qty,i),n.toAmount.textContent=br.formatCoinValue(h,c),n.fromIcon.src=br.logoPathFromID(this.order.baseID),n.toIcon.src=br.logoPathFromID(this.order.quoteID)):(n.refundAsset.textContent=s,n.fromAmount.textContent=br.formatCoinValue(h,c),n.toAmount.textContent=br.formatCoinValue(t.qty,i),n.fromIcon.src=br.logoPathFromID(this.order.quoteID),n.toIcon.src=br.logoPathFromID(this.order.baseID))}},{key:"setMutableMatchCardElements",value:function(e,t){if(!t.isCancel){var n=br.parseTemplate(e);n.status.textContent=function(e){if(e.revoked)return e.active?e.redeem?rr($e):e.side===Hn?rr(rt):e.counterRedeem?rr(at):rr(rt):e.refund?rr(nt):e.redeem?rr(et):rr(ot);switch(e.status){case 0:return vn(Ye);case 1:return vn(Qe);case 2:return vn(Je);case 3:return e.side===Hn?vn($e):vn(Ze);case 4:return vn($e);case 5:return vn(et)}return vn($)}(t);var r=function(e){if(e.startsWith(Za)){var t=e.substring(26);return vn(st,{makerAddr:t})}return e},a=function(e,t,n){if(!n)return br.hide(t),void br.show(e);t.textContent=r(n.stringID),t.dataset.explorerCoin=n.stringID,oo(n.assetID,t),br.show(t),br.hide(e)};if(a(n.makerSwapPending,n.makerSwapCoin,to(t)),a(n.takerSwapPending,n.takerSwapCoin,no(t)),a(n.makerRedeemPending,n.makerRedeemCoin,ro(t)),a(n.takerRedeemPending,n.takerRedeemCoin,ao(t)),t.refund)n.refundCoin.textContent=r(t.refund.stringID),n.refundCoin.dataset.explorerCoin=t.refund.stringID,oo(t.refund.assetID,n.refundCoin),br.show(n.refundCoin),br.hide(n.refundPending);else{var o=72e6;1===t.side&&(o=Ja);var s=new Date(t.stamp+o);if(Date.now()>s.getTime())n.refundPending.textContent=vn(wt);else{var i=s.toLocaleTimeString(navigator.languages,{year:"numeric",month:"short",day:"numeric"});n.refundPending.textContent=vn(xt,{refundAfterTime:i})}br.hide(n.refundCoin),br.show(n.refundPending)}if(1!==t.status||t.revoked||t.refund)if(2!==t.status||t.revoked||t.refund)!function(e){return e.status<5&&e.side===Hn&&e.status>=3}(t)||t.revoked||t.refund?!function(e){return e.status<5&&1===e.side&&e.status>=4}(t)||t.revoked||t.refund?br.hide(n.makerSwapMsg,n.takerSwapMsg,n.makerRedeemMsg,n.takerRedeemMsg):(n.takerRedeemMsg.textContent=eo(t.redeem),br.hide(n.makerSwapMsg,n.takerSwapMsg,n.makerRedeemMsg),br.show(n.takerRedeemMsg)):(n.makerRedeemMsg.textContent=eo(t.redeem),br.hide(n.makerSwapMsg,n.takerSwapMsg,n.takerRedeemMsg),br.show(n.makerRedeemMsg));else{var c=no(t);n.takerSwapMsg.textContent=eo(c),br.hide(n.makerSwapMsg,n.makerRedeemMsg,n.takerRedeemMsg),br.show(n.takerSwapMsg)}else{var l=to(t);n.makerSwapMsg.textContent=eo(l),br.hide(n.takerSwapMsg,n.makerRedeemMsg,n.takerRedeemMsg),br.show(n.makerSwapMsg)}if(t.revoked){br.setVis(to(t),n.makerSwap),br.setVis(no(t),n.takerSwap);var u=new Date(t.stamp+Ja),d=Date.now()>u.getTime();br.setVis(ro(t)||no(t)&&t.active&&!t.refund&&!d,n.makerRedeem),br.setVis(ao(t)||ro(t)&&t.active&&!t.refund,n.takerRedeem);var h=Boolean(no(t));t.side===Hn&&(h=Boolean(to(t)),no(t)&&(h=h&&d)),br.setVis(t.refund||t.active&&!t.redeem&&!t.counterRedeem&&h,n.refund)}else br.setVis(to(t)||t.active,n.makerSwap),br.setVis(no(t)||t.active,n.takerSwap),br.setVis(ro(t)||t.active,n.makerRedeem),br.setVis(ao(t)||t.active,n.takerRedeem),br.setVis(t.refund,n.refund)}}},{key:"addNewMatchCard",value:function(e){var t=this.page,n=t.matchCardTmpl.cloneNode(!0);n.dataset.matchID=e.matchID,this.setImmutableMatchCardElements(n,e),this.setMutableMatchCardElements(n,e),t.matchBox.appendChild(n)}},{key:"showMatchCards",value:function(){var e=this,t=this.order;t&&t.matches&&(t.matches.sort((function(e,t){return e.stamp-t.stamp})),t.matches.forEach((function(t){return e.addNewMatchCard(t)})))}},{key:"showCancel",value:function(){var e=this.order,t=this.page,n=e.qty-e.filled,r=Yn(e)?Sn().assets[e.quoteID]:Sn().assets[e.baseID];t.cancelRemain.textContent=br.formatCoinValue(n,r.unitInfo),t.cancelUnit.textContent=r.unitInfo.conventional.unit.toUpperCase(),this.showForm(t.cancelForm)}},{key:"showForm",value:(r=o(b().mark((function e(t){var n,r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentForm=t,n=this.page,br.hide(n.cancelForm,n.accelerateForm),t.style.right="10000px",br.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,br.animate(500,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0px";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"submitCancel",value:(n=o(b().mark((function e(){var t,n,r,a,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=this.order,r={orderID:n.id},a=Sn().loading(t.cancelForm),e.next=6,Lr("/api/cancel",r);case 6:if(o=e.sent,a(),Sn().checkResponse(o)){e.next=10;break}return e.abrupt("return");case 10:t.status.textContent=vn(G),br.hide(t.forms),n.cancelling=!0;case 13:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setAccelerationButtonVis",value:function(){var e=this.order;if(e){var t=this.page;br.setVis(Sn().canAccelerateOrder(e),t.accelerateBttn,t.actionsLabel)}}},{key:"showAccelerateForm",value:(t=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Sn().loading(this.page.accelerateBttn),this.accelerateOrderForm.refresh(this.order),t(),this.showForm(this.page.accelerateForm);case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"handleOrderNote",value:function(e){var t=this.page,n=e.order;if(n.id===this.orderID){this.order=n;var r=t.cancelBttn;r&&n.status>zn&&br.hide(r),t.status.textContent=Jn(n);var a,o=Xa(n.matches||[]);try{for(o.s();!(a=o.n()).done;){var s=a.value;this.processMatch(s)}}catch(e){o.e(e)}finally{o.f()}this.setAccelerationButtonVis()}}},{key:"handleMatchNote",value:function(e){e.orderID===this.orderID&&(this.processMatch(e.match),this.setAccelerationButtonVis())}},{key:"processMatch",value:function(e){var t,n=null,r=Xa(br.applySelector(this.page.matchBox,".match-card"));try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a.dataset.matchID===e.matchID){n=a;break}}}catch(e){r.e(e)}finally{r.f()}n?this.setMutableMatchCardElements(n,e):this.addNewMatchCard(e)}}]),p}(Pr);function eo(e){return e.confs&&0!==e.confs.required?"".concat(e.confs.count," / ").concat(e.confs.required," ").concat(vn(pt)):""}function to(e){return e.side===Hn?e.swap:e.counterSwap}function no(e){return e.side===Hn?e.counterSwap:e.swap}function ro(e){return e.side===Hn?e.redeem:e.counterRedeem}function ao(e){return e.side===Hn?e.counterRedeem:e.redeem}function oo(e,t){var n=co[function(e){var t=Sn().user.assets[e];return t.token?t.token.parentID:e}(e)];if(n){var r=n[Qa];r&&(t.classList.remove("plainlink"),t.classList.add("subtlelink"),t.href=r(t.dataset.explorerCoin||""))}}function so(e){return e.startsWith(Za)?[e.substring(26),!0]:42===e.length?[e,!0]:[e,!1]}var io=(d(La={},0,(function(e){var t=r(so(e),2),n=t[0];return t[1]?"https://etherscan.io/address/".concat(n):"https://etherscan.io/tx/".concat(n)})),d(La,1,(function(e){var t=r(so(e),2),n=t[0];return t[1]?"https://goerli.etherscan.io/address/".concat(n):"https://goerli.etherscan.io/tx/".concat(n)})),La),co={42:(Wa={},d(Wa,0,(function(e){var t=r(e.split(":"),2),n=t[0],a=t[1];return void 0!==a?"https://explorer.dcrdata.org/tx/".concat(n,"/out/").concat(a):"https://explorer.dcrdata.org/tx/".concat(n)})),d(Wa,1,(function(e){var t=r(e.split(":"),2),n=t[0],a=t[1];return void 0!==a?"https://testnet.dcrdata.org/tx/".concat(n,"/out/").concat(a):"https://testnet.dcrdata.org/tx/".concat(n)})),d(Wa,2,(function(e){var t=r(e.split(":"),2),n=t[0],a=t[1];return void 0!==a?"http://127.0.0.1:17779/tx/".concat(n,"/out/").concat(a):"https://127.0.0.1:17779/tx/".concat(n)})),Wa),0:(qa={},d(qa,0,(function(e){return"https://mempool.space/tx/".concat(e.split(":")[0])})),d(qa,1,(function(e){return"https://mempool.space/testnet/tx/".concat(e.split(":")[0])})),qa),2:(Na={},d(Na,0,(function(e){return"https://ltc.bitaps.com/".concat(e.split(":")[0])})),d(Na,1,(function(e){return"https://sochain.com/tx/LTCTEST/".concat(e.split(":")[0])})),Na),20:(Ua={},d(Ua,0,(function(e){return"https://digiexplorer.info/tx/".concat(e.split(":")[0])})),d(Ua,1,(function(e){return"https://testnetexplorer.digibyteservers.io/tx/".concat(e.split(":")[0])})),Ua),60:io,60001:io,3:(Va={},d(Va,0,(function(e){return"https://dogeblocks.com/tx/".concat(e.split(":")[0])})),d(Va,1,(function(e){return"https://blockexplorer.one/dogecoin/testnet/tx/".concat(e.split(":")[0])})),Va),5:(_a={},d(_a,0,(function(e){return"https://blockexplorer.one/dash/mainnet/tx/".concat(e.split(":")[0])})),d(_a,1,(function(e){return"https://blockexplorer.one/dash/testnet/tx/".concat(e.split(":")[0])})),_a),133:(za={},d(za,0,(function(e){return"https://zcashblockexplorer.com/transactions/".concat(e.split(":")[0])})),d(za,1,(function(e){return"https://blockexplorer.one/zcash/testnet/tx/".concat(e.split(":")[0])})),za),147:d({},0,(function(e){return"https://explorer.zcl.zelcore.io/tx/".concat(e.split(":")[0])})),136:(ja={},d(ja,0,(function(e){return"https://explorer.firo.org/tx/".concat(e.split(":")[0])})),d(ja,1,(function(e){return"https://testexplorer.firo.org/tx/".concat(e.split(":")[0])})),ja),145:(Ha={},d(Ha,0,(function(e){return"https://bch.loping.net/tx/".concat(e.split(":")[0])})),d(Ha,1,(function(e){return"https://tbch4.loping.net/tx/".concat(e.split(":")[0])})),Ha),966:(Ga={},d(Ga,0,(function(e){var t=r(so(e),2),n=t[0];return t[1]?"https://polygonscan.com/address/".concat(n):"https://polygonscan.com/tx/".concat(n)})),d(Ga,1,(function(e){var t=r(so(e),2),n=t[0];return t[1]?"https://mumbai.polygonscan.com/address/".concat(n):"https://mumbai.polygonscan.com/tx/".concat(n)})),Ga)};function lo(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return uo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){i=!0,o=e})),f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function uo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ho,po,fo=[jt,Ht,Gt,Kt,Xt,Yt,Qt,Jt,Zt],vo=10,mo=0,go=function(e){En(re,e);var t,n,a,i,c,l,h,p,f,v,m,g,y,k,C,S,A,F,E,I,R,T,D,M,P,B,O,L,W,q,N,U,V,_,z,j,H,G,K,X,J,Z,$,ee,te,ne=(ee=re,te=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rn(ee);if(te){var n=Rn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return In(this,e)});function re(e){var t;s(this,re),d(An(t=ne.call(this)),"body",void 0),d(An(t),"page",void 0),d(An(t),"assetButtons",void 0),d(An(t),"newWalletForm",void 0),d(An(t),"reconfigForm",void 0),d(An(t),"walletCfgGuide",void 0),d(An(t),"unlockForm",void 0),d(An(t),"depositAddrForm",void 0),d(An(t),"keyup",void 0),d(An(t),"changeWalletPW",void 0),d(An(t),"displayed",void 0),d(An(t),"animation",void 0),d(An(t),"forms",void 0),d(An(t),"forceReq",void 0),d(An(t),"forceUrl",void 0),d(An(t),"currentForm",void 0),d(An(t),"restoreInfoCard",void 0),d(An(t),"selectedAssetID",void 0),d(An(t),"stakeStatus",void 0),d(An(t),"maxSend",void 0),d(An(t),"unapprovingTokenVersion",void 0),d(An(t),"ticketPage",void 0),t.body=e;var n=t.page=br.idDescendants(e);mo=Sn().user.net,br.cleanTemplates(n.restoreInfoCard,n.connectedIconTmpl,n.disconnectedIconTmpl,n.removeIconTmpl),t.restoreInfoCard=n.restoreInfoCard.cloneNode(!0),br.show(n.connectedIconTmpl,n.disconnectedIconTmpl,n.removeIconTmpl),t.forms=br.applySelector(n.forms,":scope > form"),n.forms.querySelectorAll(".form-closer").forEach((function(e){br.bind(e,"click",(function(){t.closePopups()}))})),br.bind(n.cancelForce,"click",(function(){t.closePopups()})),t.selectedAssetID=-1,br.cleanTemplates(n.iconSelectTmpl,n.balanceDetailRow,n.recentOrderTmpl,n.vspRowTmpl,n.ticketHistoryRowTmpl,n.votingChoiceTmpl,n.votingAgendaTmpl,n.tspendTmpl,n.tkeyTmpl),br.bind(n.createWallet,"click",(function(){return t.showNewWallet(t.selectedAssetID)})),br.bind(n.connectBttn,"click",(function(){return t.doConnect(t.selectedAssetID)})),br.bind(n.send,"click",(function(){return t.showSendForm(t.selectedAssetID)})),br.bind(n.receive,"click",(function(){return t.showDeposit(t.selectedAssetID)})),br.bind(n.unlockBttn,"click",(function(){return t.openWallet(t.selectedAssetID)})),br.bind(n.lockBttn,"click",(function(){return t.lock(t.selectedAssetID)})),br.bind(n.reconfigureBttn,"click",(function(){return t.showReconfig(t.selectedAssetID)})),br.bind(n.rescanWallet,"click",(function(){return t.rescanWallet(t.selectedAssetID)})),t.newWalletForm=new pa(n.newWalletForm,(function(e){var r={assetName:Sn().assets[e].name};t.assetUpdated(e,n.newWalletForm,vn(xe,r)),t.sortAssetButtons()})),t.reconfigForm=new va(n.reconfigInputs,!1),t.walletCfgGuide=br.tmplElement(n.reconfigForm,"walletCfgGuide"),t.unlockForm=new ba(n.unlockWalletForm,(function(e){return t.openWalletSuccess(e,n.unlockWalletForm)})),Ta(n.sendForm,n.submitSendForm,o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.stepSend();case 1:case"end":return e.stop()}}),e)})))),Ta(n.vSendForm,n.vSend,o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.send();case 1:case"end":return e.stop()}}),e)})))),br.bind(n.vCancelSend,"click",o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.cancelSend();case 1:case"end":return e.stop()}}),e)})))),Ta(n.reconfigForm,n.submitReconfig,(function(){return t.reconfig()})),n.forms.querySelectorAll(".form-closer").forEach((function(e){br.bind(e,"click",(function(){return t.closePopups()}))})),br.bind(n.forms,"mousedown",(function(e){br.mouseInElement(e,t.currentForm)||t.closePopups()})),t.keyup=function(e){"Escape"===e.key&&br.isDisplayed(t.page.forms)&&t.closePopups()},br.bind(document,"keyup",t.keyup),br.bind(n.downloadLogs,"click",o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.downloadLogs();case 1:case"end":return e.stop()}}),e)})))),br.bind(n.exportWallet,"click",o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.displayExportWalletAuth();case 1:case"end":return e.stop()}}),e)})))),br.bind(n.recoverWallet,"click",o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.showRecoverWallet();case 1:case"end":return e.stop()}}),e)})))),Ta(n.exportWalletAuth,n.exportWalletAuthSubmit,o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.exportWalletAuthSubmit();case 1:case"end":return e.stop()}}),e)})))),Ta(n.recoverWalletConfirm,n.recoverWalletSubmit,(function(){t.recoverWallet()})),Ta(n.confirmForce,n.confirmForceSubmit,o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.confirmForceSubmit();case 1:case"end":return e.stop()}}),e)})))),br.bind(n.disableWallet,"click",o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.showToggleWalletStatus(!0);case 1:case"end":return e.stop()}}),e)})))),br.bind(n.enableWallet,"click",o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.showToggleWalletStatus(!1);case 1:case"end":return e.stop()}}),e)})))),Ta(n.toggleWalletStatusConfirm,n.toggleWalletStatusSubmit,o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.toggleWalletStatus();case 1:case"end":return e.stop()}}),e)})))),br.bind(n.managePeers,"click",o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.showManagePeersForm();case 1:case"end":return e.stop()}}),e)})))),br.bind(n.addPeerSubmit,"click",o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.submitAddPeer();case 1:case"end":return e.stop()}}),e)})))),br.bind(n.unapproveTokenAllowance,"click",o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.showUnapproveTokenAllowanceTableForm();case 1:case"end":return e.stop()}}),e)})))),br.bind(n.unapproveTokenSubmit,"click",o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.submitUnapproveTokenAllowance();case 1:case"end":return e.stop()}}),e)})))),br.bind(n.showVSPs,"click",(function(){t.showVSPPicker()})),br.bind(n.vspDisplay,"click",(function(){t.showVSPPicker()})),Ta(n.vspPicker,n.customVspSubmit,o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.setCustomVSP();case 1:case"end":return e.stop()}}),e)})))),br.bind(n.purchaseTicketsBttn,"click",(function(){t.showPurchaseTicketsDialog()})),Ta(n.purchaseTicketsForm,n.purchaserSubmit,(function(){t.purchaseTickets()})),br.bind(n.purchaserInput,"change",(function(){t.purchaserInputChanged()})),br.bind(n.ticketHistory,"click",(function(){t.showTicketHistory()})),br.bind(n.ticketHistoryNextPage,"click",(function(){t.nextTicketPage()})),br.bind(n.ticketHistoryPrevPage,"click",(function(){t.prevTicketPage()})),br.bind(n.setVotes,"click",(function(){t.showSetVotesDialog()})),t.depositAddrForm=new Aa(n.deposit),br.bind(n.walletBal,"click",(function(){t.populateMaxSend()})),br.bind(n.sendAmt,"input",(function(){var e=Sn().assets[t.selectedAssetID].unitInfo,r=parseFloat(n.sendAmt.value||"0"),a=e.conventional.conversionFactor;br.showFiatValue(n.sendValue,r*a,Sn().fiatRatesMap[t.selectedAssetID],e)})),br.bind(n.maxSend,"click",(function(){t.populateMaxSend()})),br.bind(n.sendAddr,"input",o(b().mark((function e(){var r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Sn().assets[t.selectedAssetID],br.hide(n.validAddr),n.sendAddr.classList.remove("invalid"),a=n.sendAddr.value||"",r&&""!==a){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,t.validateSendAddress(a,r.id);case 8:e.sent?br.show(n.validAddr):n.sendAddr.classList.add("invalid");case 10:case"end":return e.stop()}}),e)})))),br.bind(n.showChangePW,"click",(function(){t.changeWalletPW=!t.changeWalletPW,t.setPWSettingViz(t.changeWalletPW)})),br.bind(n.changeWalletTypeSelect,"change",(function(){t.changeWalletType()})),br.bind(n.showChangeType,"click",(function(){br.isHidden(n.changeWalletType)?(br.show(n.changeWalletType,n.changeTypeHideIcon),br.hide(n.changeTypeShowIcon),n.changeTypeMsg.textContent=vn(ve)):t.showReconfig(t.selectedAssetID,!0)})),Sn().registerNoteFeeder({fiatrateupdate:function(e){t.handleRatesNote(e)},balance:function(e){t.handleBalanceNote(e)},walletstate:function(e){t.handleWalletStateNote(e)},walletconfig:function(e){t.handleWalletStateNote(e)},createwallet:function(e){t.handleCreateWalletNote(e)},walletnote:function(e){t.handleCustomWalletNote(e)}});var r=t.sortAssetButtons().id,a=Mr.fetchLocal(Mr.selectedAssetLK);return a&&(r=Number(a)),t.setSelectedAsset(r),t}return u(re,[{key:"closePopups",value:function(){br.hide(this.page.forms),this.animation&&this.animation.stop()}},{key:"safePost",value:($=o(b().mark((function e(t,n){var r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.selectedAssetID,e.next=3,Lr(t,n);case 3:if(a=e.sent,r===this.selectedAssetID){e.next=6;break}throw Error("asset changed during request. aborting");case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return $.apply(this,arguments)})},{key:"stepSend",value:(Z=o(b().mark((function e(){var t,n,r,a,o,s,i,c,l,u,d,h,p,f,v,m,g,y,k,w,x,C;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,br.hide(t.vSendErr,t.sendErr,t.vSendEstimates,t.txFeeNotAvailable),n=parseInt(t.sendForm.dataset.assetID||""),r=Sn().assets[n].token,a=t.subtractCheckBox.checked||!1,o=Sn().unitInfo(n).conventional.conversionFactor,s=Math.round(parseFloat(t.sendAmt.value||"")*o),""!==(i=t.sendAddr.value||"")){e.next=10;break}return e.abrupt("return",br.showFormError(t.sendErr,vn(Oe,{address:i})));case 10:if(c=Sn().assets[n],l=c.wallet,u=c.unitInfo,d=c.symbol,h=0,0==(512&l.traits)){e.next=36;break}return p={addr:t.sendAddr.value,assetID:n,subtract:a,value:s},f=Sn().loading(t.sendForm),e.next=17,Lr("/api/txfee",p);case 17:if(v=e.sent,f(),Sn().checkResponse(v)){e.next=29;break}return t.txFeeNotAvailable.dataset.tooltip=vn(Le,{err:v.msg}),br.show(t.txFeeNotAvailable),e.next=24,this.validateSendAddress(i,n);case 24:if(e.sent){e.next=27;break}return e.abrupt("return",br.showFormError(t.sendErr,vn(Oe,{address:i||""})));case 27:e.next=34;break;case 29:if(!v.ok){e.next=34;break}if(v.validaddress){e.next=32;break}return e.abrupt("return",br.showFormError(t.sendErr,vn(Oe,{address:t.sendAddr.value||""})));case 32:h=v.txfee,br.show(t.vSendEstimates);case 34:e.next=41;break;case 36:return e.next=38,this.validateSendAddress(i,n);case 38:if(e.sent){e.next=41;break}return e.abrupt("return",br.showFormError(t.sendErr,vn(Oe,{address:i||""})));case 41:return t.vSendSymbol.textContent=d.toUpperCase(),t.vSendLogo.src=br.logoPath(d),r?(m=Sn().assets[r.parentID],g=m.unitInfo,y=m.symbol,t.vSendFee.textContent=br.formatFullPrecision(h,g)+" "+y):t.vSendFee.textContent=br.formatFullPrecision(h,u),k=Sn().fiatRatesMap[n],br.showFiatValue(t.vSendFeeFiat,h,k,u),t.vSendDestinationAmt.textContent=br.formatFullPrecision(s-h,u),t.vTotalSend.textContent=br.formatFullPrecision(s,u),br.showFiatValue(t.vTotalSendFiat,s,k,u),t.vSendAddr.textContent=t.sendAddr.value||"",w=l.balance.available-s,t.balanceAfterSend.textContent=br.formatFullPrecision(w,u),br.showFiatValue(t.balanceAfterSendFiat,w,k,u),br.show(t.approxSign),a||(br.hide(t.approxSign),t.vSendDestinationAmt.textContent=br.formatFullPrecision(s,u),x=s,r||(x+=h),t.vTotalSend.textContent=br.formatFullPrecision(x,u),br.showFiatValue(t.vTotalSendFiat,x,k,u),C=l.balance.available-s,r||(C-=h),C<=0?(t.balanceAfterSend.textContent=br.formatFullPrecision(0,u),br.showFiatValue(t.balanceAfterSendFiat,0,k,u)):(t.balanceAfterSend.textContent=br.formatFullPrecision(C,u),br.showFiatValue(t.balanceAfterSendFiat,C,k,u))),br.hide(t.sendForm),e.next=58,this.showForm(t.vSendForm);case 58:case"end":return e.stop()}}),e,this)}))),function(){return Z.apply(this,arguments)})},{key:"cancelSend",value:(J=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,br.hide(t.vSendForm,t.sendErr),e.next=4,this.showForm(t.sendForm);case 4:case"end":return e.stop()}}),e,this)}))),function(){return J.apply(this,arguments)})},{key:"validateSendAddress",value:(X=o(b().mark((function e(t,n){var r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lr("/api/validateaddress",{addr:t,assetID:n});case 2:return r=e.sent,e.abrupt("return",Sn().checkResponse(r));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return X.apply(this,arguments)})},{key:"setPWSettingViz",value:function(e){var t=this.page;if(e)return br.hide(t.showIcon),br.show(t.hideIcon,t.changePW),void(t.switchPWMsg.textContent=vn(Y));br.hide(t.hideIcon,t.changePW),br.show(t.showIcon),t.switchPWMsg.textContent=vn(Q)}},{key:"assetVersionUsedByDEXes",value:function(){var e=this.selectedAssetID,t={},n=Sn().exchanges;for(var r in n){var a=n[r],o=a.assets[e];o&&(t[o.version]||(t[o.version]=[]),t[o.version].push(a.host))}return t}},{key:"submitUnapproveTokenAllowance",value:(K=o(b().mark((function e(){var t,n,r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,e.next=4,Lr("/api/unapprovetoken",{assetID:this.selectedAssetID,pass:t.unapproveTokenPW.value,version:this.unapprovingTokenVersion});case 4:if(n=e.sent,Sn().checkResponse(n)){e.next=9;break}return t.unapproveTokenErr.textContent=n.msg,br.show(t.unapproveTokenErr),e.abrupt("return");case 9:(r=co[this.selectedAssetID])&&r[mo]&&(t.unapproveTokenTxID.href=r[mo](n.txID)),t.unapproveTokenTxID.textContent=n.txID,br.hide(t.unapproveTokenSubmissionElements,t.unapproveTokenErr),br.show(t.unapproveTokenTxMsg);case 14:case"end":return e.stop()}}),e,this)}))),function(){return K.apply(this,arguments)})},{key:"showUnapproveTokenAllowanceForm",value:(G=o(b().mark((function e(t){var n,r,a,o,s,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,this.unapprovingTokenVersion=t,br.show(n.unapproveTokenSubmissionElements),br.hide(n.unapproveTokenTxMsg,n.unapproveTokenErr),br.setVis(!Mr.passwordIsCached(),n.unapproveTokenPWBox),(r=Sn().assets[this.selectedAssetID])&&r.token){e.next=8;break}return e.abrupt("return");case 8:if(a=Sn().assets[r.token.parentID]){e.next=11;break}return e.abrupt("return");case 11:return n.tokenAllowanceRemoveSymbol.textContent=r.symbol.toUpperCase(),n.tokenAllowanceRemoveVersion.textContent=t.toString(),e.next=16,Lr("/api/approvetokenfee",{assetID:this.selectedAssetID,version:t,approving:!1});case 16:o=e.sent,Sn().checkResponse(o)?(s="".concat(br.formatCoinValue(o.txFee,a.unitInfo)," ").concat(a.symbol.toUpperCase()),(i=Sn().fiatRatesMap[a.id])&&(s+=" (".concat(br.formatFiatConversion(o.txFee,i,a.unitInfo)," USD)")),n.unapprovalFeeEstimate.textContent=s):(n.unapproveTokenErr.textContent=o.msg,br.show(n.unapproveTokenErr)),this.showForm(n.unapproveTokenForm);case 19:case"end":return e.stop()}}),e,this)}))),function(e){return G.apply(this,arguments)})},{key:"showUnapproveTokenAllowanceTableForm",value:(H=o(b().mark((function e(){var t,n,r,a,o,s,i=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,(n=Sn().assets[this.selectedAssetID])&&n.wallet&&n.wallet.approved){e.next=4;break}return e.abrupt("return");case 4:for(;t.tokenVersionBody.firstChild;)t.tokenVersionBody.removeChild(t.tokenVersionBody.firstChild);t.tokenVersionTableAssetSymbol.textContent=n.symbol.toUpperCase(),r=this.assetVersionUsedByDEXes(),a=!1,o=b().mark((function e(o){var s,c,l,u;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(s=n.wallet.approved[o])&&s===wn.Approved){e.next=3;break}return e.abrupt("return","continue");case 3:a=!0,c=t.tokenVersionRow.cloneNode(!0),(l=br.parseTemplate(c)).version.textContent=o.toString(),r[o]&&(l.usedBy.textContent=r[o].join(", ")),u=i.page.removeIconTmpl.cloneNode(!0),br.bind(u,"click",(function(){i.showUnapproveTokenAllowanceForm(o)})),l.remove.appendChild(u),t.tokenVersionBody.appendChild(c);case 12:case"end":return e.stop()}}),e)})),s=0;case 10:if(!(s<=n.wallet.version)){e.next=18;break}return e.delegateYield(o(s),"t0",12);case 12:if("continue"!==e.t0){e.next=15;break}return e.abrupt("continue",15);case 15:s++,e.next=10;break;case 18:br.setVis(a,t.tokenVersionTable),br.setVis(!a,t.tokenVersionNone),this.showForm(t.unapproveTokenTableForm);case 21:case"end":return e.stop()}}),e,this)}))),function(){return H.apply(this,arguments)})},{key:"updateWalletPeersTable",value:(j=o(b().mark((function e(){var t,n,r,a,s,i,c=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,br.hide(t.peerSpinner),e.next=4,Lr("/api/getwalletpeers",{assetID:this.selectedAssetID});case 4:if(n=e.sent,Sn().checkResponse(n)){e.next=9;break}return t.managePeersErr.textContent=n.msg,br.show(t.managePeersErr),e.abrupt("return");case 9:for(;t.peersTableBody.firstChild;)t.peersTableBody.removeChild(t.peersTableBody.firstChild);(r=n.peers||[]).sort((function(e,t){return e.source-t.source})),a=vn(_e),s=vn(ze),i=vn(je),r.forEach((function(e){var n,r=t.peerTableRow.cloneNode(!0),l=br.parseTemplate(r);switch(l.addr.textContent=e.addr,e.source){case Cn.WalletDefault:l.source.textContent=a;break;case Cn.UserAdded:l.source.textContent=s;break;case Cn.Discovered:l.source.textContent=i}if(n=e.connected?c.page.connectedIconTmpl.cloneNode(!0):c.page.disconnectedIconTmpl.cloneNode(!0),l.connected.appendChild(n),e.source===Cn.UserAdded){var u=c.page.removeIconTmpl.cloneNode(!0);br.bind(u,"click",o(b().mark((function n(){var r;return b().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return br.hide(t.managePeersErr),n.next=3,Lr("/api/removewalletpeer",{assetID:c.selectedAssetID,addr:e.addr});case 3:if(r=n.sent,Sn().checkResponse(r)){n.next=8;break}return t.managePeersErr.textContent=r.msg,br.show(t.managePeersErr),n.abrupt("return");case 8:c.spinUntilPeersUpdate();case 9:case"end":return n.stop()}}),n)})))),l.remove.appendChild(u)}t.peersTableBody.appendChild(r)}));case 16:case"end":return e.stop()}}),e,this)}))),function(){return j.apply(this,arguments)})},{key:"showManagePeersForm",value:(z=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,e.next=3,this.updateWalletPeersTable();case 3:br.hide(t.managePeersErr),this.showForm(t.managePeersForm);case 5:case"end":return e.stop()}}),e,this)}))),function(){return z.apply(this,arguments)})},{key:"submitAddPeer",value:(_=o(b().mark((function e(){var t,n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,br.hide(t.managePeersErr),e.next=4,Lr("/api/addwalletpeer",{assetID:this.selectedAssetID,addr:t.addPeerInput.value});case 4:if(n=e.sent,Sn().checkResponse(n)){e.next=9;break}return t.managePeersErr.textContent=n.msg,br.show(t.managePeersErr),e.abrupt("return");case 9:this.spinUntilPeersUpdate(),t.addPeerInput.value="";case 11:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})},{key:"spinUntilPeersUpdate",value:(V=o(b().mark((function e(){var t,n=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.page,br.show(t.peerSpinner),setTimeout((function(){br.isDisplayed(t.peerSpinner)&&n.updateWalletPeersTable()}),1e4);case 3:case"end":return e.stop()}}),e,this)}))),function(){return V.apply(this,arguments)})},{key:"showToggleWalletStatus",value:function(e){var t=this.page;br.hide(t.toggleWalletStatusErr,t.walletStatusDisable,t.disableWalletMsg,t.walletStatusEnable,t.enableWalletMsg),e?br.show(t.walletStatusDisable,t.disableWalletMsg):br.show(t.walletStatusEnable,t.enableWalletMsg),this.showForm(t.toggleWalletStatusConfirm)}},{key:"toggleWalletStatus",value:(U=o(b().mark((function e(){var t,n,r,a,o,s,i,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,br.hide(t.toggleWalletStatusErr),n=Sn().assets[this.selectedAssetID],r=!n.wallet.disabled,a={assetID:this.selectedAssetID,disable:r},o={assetName:n.name},s=Sn().loading(t.toggleWalletStatusConfirm),e.next=10,Lr("/api/togglewalletstatus",a);case 10:if(i=e.sent,s(),Sn().checkResponse(i)){e.next=16;break}return i.code===Ur.activeOrdersErr?t.toggleWalletStatusErr.textContent=vn(Ie,o):t.toggleWalletStatusErr.textContent=i.msg,br.show(t.toggleWalletStatusErr),e.abrupt("return");case 16:c=vn(Fe,o),r||(c=vn(Ee,o)),this.assetUpdated(this.selectedAssetID,t.toggleWalletStatusConfirm,c);case 19:case"end":return e.stop()}}),e,this)}))),function(){return U.apply(this,arguments)})},{key:"showBox",value:(N=o(b().mark((function e(t,n){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.style.opacity="0",br.show(t),n&&n.focus(),e.next=5,br.animate(300,(function(e){t.style.opacity="".concat(e)}),"easeOut");case 5:t.style.opacity="1",this.displayed=t;case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return N.apply(this,arguments)})},{key:"showForm",value:(q=o(b().mark((function e(t){var n,r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,this.currentForm=t,this.forms.forEach((function(e){return br.hide(e)})),t.style.right="10000px",br.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,br.animate(300,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return q.apply(this,arguments)})},{key:"showSuccess",value:(W=o(b().mark((function e(t){var n,a,o,s,i,c,l,u,d,h=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.page).successMessage.textContent=t,this.currentForm=n.checkmarkForm,this.forms.forEach((function(e){return br.hide(e)})),br.show(n.forms,n.checkmarkForm),n.checkmarkForm.style.right="0",n.checkmark.style.fontSize="0px",a=Mr.isDark()?[223,226,225]:[51,51,51],o=r(a,3),s=o[0],i=o[1],c=o[2],l=16-s,u=163-i,d=16-c,this.animation=new wr(1200,(function(e){n.checkmark.style.fontSize="".concat(80*e,"px"),n.checkmark.style.color="rgb(".concat(s+e*l,", ").concat(i+e*u,", ").concat(c+e*d,")")}),"easeOutElastic",(function(){h.animation=new wr(1500,(function(){}),"",(function(){h.currentForm===n.checkmarkForm&&h.closePopups()}))}));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return W.apply(this,arguments)})},{key:"showNewWallet",value:(L=o(b().mark((function e(t){var n,r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,r=n.newWalletForm,this.newWalletForm.setAsset(t),a=this.newWalletForm.loadDefaults(),e.next=6,this.showForm(r);case 6:return e.next=8,a;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return L.apply(this,arguments)})},{key:"sortAssetButtons",value:function(){var e=this,t=this.page;this.assetButtons={},br.empty(t.assetSelect);var n=Vr(Object.values(Sn().assets));n.sort((function(e,t){return e.wallet&&!t.wallet?-1:!e.wallet&&t.wallet?1:e.symbol.localeCompare(t.symbol)}));var r,a=lo(n);try{var o=function(){var n=r.value,a=t.iconSelectTmpl.cloneNode(!0);t.assetSelect.appendChild(a);var o=br.parseTemplate(a);e.assetButtons[n.id]={tmpl:o,bttn:a},e.updateAssetButton(n.id),br.bind(a,"click",(function(){e.setSelectedAsset(n.id),Mr.storeLocal(Mr.selectedAssetLK,String(n.id))}))};for(a.s();!(r=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}return t.assetSelect.classList.remove("invisible"),n[0]}},{key:"updateAssetButton",value:function(e){var t,n=Sn().assets[e],r=this.assetButtons[e],a=r.bttn,o=r.tmpl;br.hide(o.fiat,o.noWallet),a.classList.add("nowallet"),(t=o.img).src||(t.src=br.logoPath(n.symbol));var s=n.symbol.split(".");if(2===s.length){var i,c=s[1];o.parentImg.classList.remove("d-hide"),(i=o.parentImg).src||(i.src=br.logoPath(c))}if(o.name.textContent=n.name,n.wallet){a.classList.remove("nowallet");var l=n.wallet.balance,u=n.unitInfo,d=l.available+l.locked+l.immature;o.balance.textContent=br.formatCoinValue(d,u);var h=Sn().fiatRatesMap[n.id];h&&(br.show(o.fiat),o.fiat.textContent=br.formatFiatConversion(d,h,u))}else br.show(o.noWallet)}},{key:"setSelectedAsset",value:function(e){var t,n=lo(this.page.assetSelect.children);try{for(n.s();!(t=n.n()).done;)t.value.classList.remove("selected")}catch(e){n.e(e)}finally{n.f()}this.assetButtons[e].bttn.classList.add("selected"),this.selectedAssetID=e,this.updateDisplayedAsset(e),this.showAvailableMarkets(e),this.showRecentActivity(e),this.updateTicketBuyer(e)}},{key:"updateDisplayedAsset",value:function(e){if(e===this.selectedAssetID){var t,n=Sn().assets[e],r=n.symbol,a=n.wallet,o=n.name,s=n.token,i=this.page,c=lo(document.querySelectorAll("[data-asset-name]"));try{for(c.s();!(t=c.n()).done;)t.value.textContent=o}catch(e){c.e(e)}finally{c.f()}if(i.assetLogo.src=br.logoPath(r),br.hide(i.balanceBox,i.fiatBalanceBox,i.createWalletBox,i.walletDetails,i.sendReceive,i.connectBttnBox,i.statusLocked,i.statusReady,i.statusOff,i.unlockBttnBox,i.lockBttnBox,i.connectBttnBox,i.peerCountBox,i.syncProgressBox,i.statusDisabled,i.tokenParentBox),s){var l=Sn().assets[s.parentID];i.tokenParentLogo.src=br.logoPath(l.symbol),i.tokenParentName.textContent=l.name,br.show(i.tokenParentBox)}if(a){this.updateDisplayedAssetBalance();var u=Sn().walletDefinition(e,a.type);i.walletType.textContent=u.tab;var d=function(e){var t=Sn().assets[e];if(t.token){var n=t.token.definition.configopts;return n&&n.length>0}if(!t.info)throw Error("this asset isn't an asset, I guess");var r=t.info.availablewallets,a=r[0].configopts;return r.length>1||a&&a.length>0}(e);br.setVis(d,i.passwordWrapper),a.disabled?br.show(i.statusDisabled):a.running?(br.show(i.sendReceive,i.peerCountBox,i.syncProgressBox),i.peerCount.textContent=String(a.peerCount),i.syncProgress.textContent="".concat((100*a.syncProgress).toFixed(1),"%"),a.open?(br.show(i.statusReady),!Sn().haveActiveOrders(e)&&a.encrypted&&br.show(i.lockBttnBox)):br.show(i.statusLocked,i.unlockBttnBox)):br.show(i.statusOff,i.connectBttnBox)}else br.show(i.createWalletBox);i.walletDetailsBox.classList.remove("invisible")}}},{key:"updateTicketBuyer",value:(O=o(b().mark((function e(t){var n,r,a,o,s,i,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ticketPage={number:0,history:[],scanned:!1},n=Sn().assets[t],r=n.wallet,a=n.unitInfo,o=this.page,br.hide(o.stakingBox,o.pickVSP,o.stakingSummary,o.stakingErr,o.vspDisplayBox,o.ticketPriceBox,o.purchaseTicketsBox,o.stakingRpcSpvMsg),null!=r&&r.running&&0!=(32768&r.traits)){e.next=6;break}return e.abrupt("return");case 6:return br.show(o.stakingBox),s=Sn().loading(o.stakingBox),e.next=10,this.safePost("/api/stakestatus",t);case 10:if(i=e.sent,s(),Sn().checkResponse(i)){e.next=19;break}if(!i.msg.includes("disconnected from consensus RPC")){e.next=16;break}return br.show(o.stakingRpcSpvMsg),e.abrupt("return");case 16:return br.show(o.stakingErr),o.stakingErr.textContent=i.msg,e.abrupt("return");case 19:br.show(o.stakingSummary,o.ticketPriceBox),c=i.status,this.stakeStatus=c,o.stakingAgendaCount.textContent=String(c.stances.agendas.length),o.stakingTspendCount.textContent=String(c.stances.tspends.length),o.purchaserCurrentPrice.textContent=br.formatFourSigFigs(c.ticketPrice/a.conventional.conversionFactor),o.purchaserBal.textContent=br.formatCoinValue(r.balance.available,a),this.updateTicketStats(c.stats,a,c.ticketPrice,c.votingSubsidy),this.setVSPViz(c.vsp);case 28:case"end":return e.stop()}}),e,this)}))),function(e){return O.apply(this,arguments)})},{key:"setVSPViz",value:function(e){var t=this.page,n=this.stakeStatus;if(br.hide(t.vspDisplayBox),e)return br.show(t.vspDisplayBox,t.purchaseTicketsBox),br.hide(t.pickVSP),void(t.vspURL.textContent=e);br.setVis(!n.isRPC,t.pickVSP),br.setVis(n.isRPC,t.purchaseTicketsBox)}},{key:"updateTicketStats",value:function(e,t,n,r){var a=this.page,o=this.stakeStatus.tickets.filter((function(e){return e.status<=3&&e.status>=1})).length;a.stakingTicketCount.textContent=String(o),a.totalTicketCount.textContent=String(e.ticketCount),a.totalTicketRewards.textContent=br.formatFourSigFigs(e.totalRewards/t.conventional.conversionFactor),a.totalTicketVotes.textContent=String(e.votes),n&&(a.ticketPrice.textContent=br.formatFourSigFigs(n/t.conventional.conversionFactor)),r&&(a.votingSubsidy.textContent=br.formatFourSigFigs(r/t.conventional.conversionFactor))}},{key:"showVSPPicker",value:(B=o(b().mark((function e(){var t,n,r,a,o,s,i,c,l=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.selectedAssetID,n=this.page,this.showForm(n.vspPicker),br.empty(n.vspPickerList),br.hide(n.stakingErr),r=Sn().loading(n.vspPicker),e.next=8,this.safePost("/api/listvsps",t);case 8:if(a=e.sent,r(),Sn().checkResponse(a)){e.next=14;break}return br.show(n.stakingErr),n.stakingErr.textContent=a.msg,e.abrupt("return");case 14:o=a.vsps,s=lo(o),e.prev=16,c=b().mark((function e(){var r,a,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=i.value,a=n.vspRowTmpl.cloneNode(!0),n.vspPickerList.appendChild(a),(o=br.parseTemplate(a)).url.textContent=r.url,o.feeRate.textContent=r.feePercentage.toFixed(2),o.voting.textContent=String(r.voting),br.bind(a,"click",(function(){br.hide(n.stakingErr),l.setVSP(t,r)}));case 8:case"end":return e.stop()}}),e)})),s.s();case 19:if((i=s.n()).done){e.next=23;break}return e.delegateYield(c(),"t0",21);case 21:e.next=19;break;case 23:e.next=28;break;case 25:e.prev=25,e.t1=e.catch(16),s.e(e.t1);case 28:return e.prev=28,s.f(),e.finish(28);case 31:case"end":return e.stop()}}),e,this,[[16,25,28,31]])}))),function(){return B.apply(this,arguments)})},{key:"showPurchaseTicketsDialog",value:function(){var e=this.page;e.purchaserInput.value="",e.purchaserAppPW.value="",br.hide(e.purchaserErr),br.setVis(!Mr.passwordIsCached(),e.purchaserAppPWBox),this.showForm(this.page.purchaseTicketsForm),e.purchaserInput.focus()}},{key:"purchaserInputChanged",value:function(){var e=this.page,t=parseInt(e.purchaserInput.value||"0");e.purchaserInput.value=t<=1?"1":String(t)}},{key:"purchaseTickets",value:(P=o(b().mark((function e(){var t,n,r,a,o,s,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,n=this.selectedAssetID,r=this.stakeStatus,!((a=parseInt(t.purchaserInput.value||"0"))<1)){e.next=4;break}return e.abrupt("return");case 4:return o=Sn().loading(t.purchaseTicketsForm),e.next=7,this.safePost("/api/purchasetickets",{assetID:n,n:a,appPW:t.purchaserAppPW.value||""});case 7:if(s=e.sent,o(),Sn().checkResponse(s)){e.next=13;break}return t.purchaserErr.textContent=s.msg,br.show(t.purchaserErr),e.abrupt("return");case 13:i=s.tickets,r.stats.ticketCount+=i.length,r.tickets=i.concat(r.tickets),this.updateTicketStats(r.stats,Sn().unitInfo(n)),this.showSuccess(vn(zt,{n:i.length.toLocaleString(navigator.languages)}));case 18:case"end":return e.stop()}}),e,this)}))),function(){return P.apply(this,arguments)})},{key:"setVSP",value:(M=o(b().mark((function e(t,n){var r,a,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.closePopups(),r=this.page,a=Sn().loading(r.stakingBox),e.next=5,this.safePost("/api/setvsp",{assetID:t,url:n.url});case 5:if(o=e.sent,a(),Sn().checkResponse(o)){e.next=11;break}return br.show(r.stakingErr),r.stakingErr.textContent=o.msg,e.abrupt("return");case 11:this.setVSPViz(n.url);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return M.apply(this,arguments)})},{key:"setCustomVSP",value:function(){var e=this.selectedAssetID,t={url:this.page.customVspUrl.value};this.setVSP(e,t)}},{key:"pageOfTickets",value:function(e){var t=this.stakeStatus,n=this.ticketPage,r=e*vo,a=[];if(r<t.tickets.length){if(a.push.apply(a,Vr(t.tickets.slice(r,r+vo))),a.length<vo){var o=vo-a.length;a.push.apply(a,Vr(n.history.slice(0,o)))}}else r-=t.tickets.length,a.push.apply(a,Vr(n.history.slice(r,r+vo)));return a}},{key:"displayTicketPage",value:function(e,t){var n=this.page,r=this.selectedAssetID,a=Sn().unitInfo(r),o=co[r][Sn().user.net];br.empty(n.ticketHistoryRows),n.ticketHistoryPage.textContent=String(e);var s,i=lo(t);try{var c=function(){var e=s.value,t=e.tx,r=e.status,i=n.ticketHistoryRowTmpl.cloneNode(!0);n.ticketHistoryRows.appendChild(i);var c=br.parseTemplate(i);c.age.textContent=br.timeSince(1e3*t.stamp),c.price.textContent=br.formatFullPrecision(t.ticketPrice,a),c.status.textContent=vn(fo[r]),c.hashStart.textContent=t.hash.slice(0,6),c.hashEnd.textContent=t.hash.slice(-6),br.bind(c.detailsLink,"click",(function(){return window.open(o(t.hash),"_blank")}))};for(i.s();!(s=i.n()).done;)c()}catch(e){i.e(e)}finally{i.f()}}},{key:"ticketPageN",value:(D=o(b().mark((function e(t){var n,r,a,o,s,i,c,l,u,d,h,p,f,v;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,r=this.stakeStatus,a=this.ticketPage,o=this.selectedAssetID,!((s=this.pageOfTickets(t)).length<vo)||a.scanned){e.next=18;break}return c=vo-s.length,l=a.history.length>0?a.history:r.tickets,u=l.length>0?l[l.length-1].tx.blockHeight:-1,d=l.filter((function(e){return e.tx.blockHeight===u})).length,h=Sn().loading(n.ticketHistoryForm),e.next=10,this.safePost("/api/ticketpage",{assetID:o,scanStart:u,n:c,skipN:d});case 10:if(p=e.sent,h(),Sn().checkResponse(p)){e.next=15;break}return console.error("error fetching ticket page",p.msg),e.abrupt("return");case 15:(i=this.ticketPage.history).push.apply(i,Vr(p.tickets)),s.push.apply(s,Vr(p.tickets)),p.tickets.length<c&&(this.ticketPage.scanned=!0);case 18:if(f=r.tickets.length+a.history.length,br.setVis(f>=vo,n.ticketHistoryPagination),br.setVis(f>0,n.ticketHistoryTable),br.setVis(0===f,n.noTicketsMessage),0!==s.length){e.next=25;break}return br.hide(n.ticketHistoryNextPage),e.abrupt("return");case 25:this.displayTicketPage(t,s),a.number=t,v=t*vo+s.length===f,br.setVis(!v||!a.scanned,n.ticketHistoryNextPage),br.setVis(t>0,n.ticketHistoryPrevPage);case 30:case"end":return e.stop()}}),e,this)}))),function(e){return D.apply(this,arguments)})},{key:"showTicketHistory",value:(T=o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.showForm(this.page.ticketHistoryForm),e.next=3,this.ticketPageN(this.ticketPage.number);case 3:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"nextTicketPage",value:(R=o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ticketPageN(this.ticketPage.number+1);case 2:case"end":return e.stop()}}),e,this)}))),function(){return R.apply(this,arguments)})},{key:"prevTicketPage",value:(I=o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ticketPageN(this.ticketPage.number-1);case 2:case"end":return e.stop()}}),e,this)}))),function(){return I.apply(this,arguments)})},{key:"showSetVotesDialog",value:function(){var e=this,t=this.page,n=this.stakeStatus,r=this.selectedAssetID,a=Sn().unitInfo(r);br.hide(t.votingFormErr);var s=co[r][Sn().user.net],i=function(){var n=o(b().mark((function n(r){var a,o;return b().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return br.hide(t.votingFormErr),a=Sn().loading(t.votingForm),n.next=4,e.safePost("/api/setvotes",r);case 4:if(o=n.sent,a(),Sn().checkResponse(o)){n.next=10;break}throw br.show(t.votingFormErr),t.votingFormErr.textContent=o.msg,Error(o.msg);case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),c=function(){var e=o(b().mark((function e(t,a){var o,s,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i({assetID:r,choices:d({},t,a)});case 2:o=lo(n.stances.agendas);try{for(o.s();!(s=o.n()).done;)(c=s.value).id===t&&(c.currentChoice=a)}catch(e){o.e(e)}finally{o.f()}case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();br.empty(t.votingAgendas);var l,u=lo(n.stances.agendas);try{var h=function(){var e=l.value,n=t.votingAgendaTmpl.cloneNode(!0);t.votingAgendas.appendChild(n);var r=br.parseTemplate(n);r.description.textContent=e.description;var a,o=lo(e.choices);try{var s=function(){var n=a.value;if("abstain"===n.id)return"continue";var o=t.votingChoiceTmpl.cloneNode(!0);r.choices.appendChild(o);var s,i=br.parseTemplate(o);i.id.textContent=(s=n.id).charAt(0).toUpperCase()+s.slice(1),i.id.dataset.tooltip=n.description,i.radio.value=n.id,i.radio.name=e.id,br.bind(i.radio,"change",(function(){i.radio.checked&&c(e.id,n.id)})),n.id===e.currentChoice&&(i.radio.checked=!0)};for(o.s();!(a=o.n()).done;)s()}catch(e){o.e(e)}finally{o.f()}Sn().bindTooltips(r.choices)};for(u.s();!(l=u.n()).done;)h()}catch(e){u.e(e)}finally{u.f()}var p=function(){var e=o(b().mark((function e(t,a){var o,s,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i({assetID:r,tSpendPolicy:d({},t,a)});case 2:o=lo(n.stances.tspends);try{for(o.s();!(s=o.n()).done;)(c=s.value).hash===t&&(c.currentPolicy=a)}catch(e){o.e(e)}finally{o.f()}case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();br.empty(t.votingTspends);var f,v=lo(n.stances.tspends);try{var m=function(){var e=f.value,n=t.tspendTmpl.cloneNode(!0);t.votingTspends.appendChild(n);for(var r=br.parseTemplate(n),o=function(){var t=c[i];t.name=e.hash,e.currentPolicy===t.value&&(t.checked=!0),br.bind(t,"change",(function(){var n;t.checked&&p(e.hash,null!==(n=t.value)&&void 0!==n?n:"")}))},i=0,c=[r.yes,r.no];i<c.length;i++)o();e.value>0?r.value.textContent=br.formatFourSigFigs(e.value/a.conventional.conversionFactor):br.hide(r.value),r.hash.textContent=e.hash,br.bind(r.explorerLink,"click",(function(){return window.open(s(e.hash),"_blank")}))};for(v.s();!(f=v.n()).done;)m()}catch(e){v.e(e)}finally{v.f()}var g=function(){var e=o(b().mark((function e(t,a){var o,s,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i({assetID:r,treasuryPolicy:d({},t,a)});case 2:o=lo(n.stances.treasuryKeys);try{for(o.s();!(s=o.n()).done;)(c=s.value).key===t&&(c.policy=a)}catch(e){o.e(e)}finally{o.f()}case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();br.empty(t.votingTKeys);var y,k=lo(n.stances.treasuryKeys);try{var w=function(){var e=y.value,n=t.tkeyTmpl.cloneNode(!0);t.votingTKeys.appendChild(n);for(var r=br.parseTemplate(n),a=function(){var t=s[o];t.name=e.key,e.policy===t.value&&(t.checked=!0),br.bind(t,"change",(function(){var n;t.checked&&g(e.key,null!==(n=t.value)&&void 0!==n?n:"")}))},o=0,s=[r.yes,r.no];o<s.length;o++)a();r.key.textContent=e.key};for(k.s();!(y=k.n()).done;)w()}catch(e){k.e(e)}finally{k.f()}this.showForm(t.votingForm)}},{key:"updateDisplayedAssetBalance",value:function(){var e=this.page,t=Sn().assets[this.selectedAssetID],n=t.wallet,a=t.unitInfo,o=t.id,s=n.balance;br.show(e.balanceBox,e.walletDetails);var i=s.locked+s.contractlocked+s.bondlocked,c=s.available+i+s.immature;e.balance.textContent=br.formatCoinValue(c,a),br.empty(e.balanceUnit),e.balanceUnit.appendChild(br.symbolize(t));var l=Sn().fiatRatesMap[o];l&&(br.show(e.fiatBalanceBox),e.fiatBalance.textContent=br.formatFiatConversion(c,l,a));var u=!1;br.empty(e.balanceDetailBox);var d=function(t,n,r){var o=e.balanceDetailRow.cloneNode(!0);u&&(o.classList.add("first-other"),u=!1),e.balanceDetailBox.appendChild(o);var s=br.parseTemplate(o);s.name.textContent=t,r&&(s.tooltipMsg.dataset.tooltip=r,br.show(s.tooltipMsg)),s.subBalance.textContent=br.formatCoinValue(n,a)};d(vn(Ct),s.available,""),d(vn(St),i,vn(It)),d(vn(At),s.immature,vn(Rt));var h=Object.entries(s.other||{});h.sort((function(e,t){return e[0].localeCompare(t[0])})),u=!0;var p,f=function(e){return e+" ("+vn(Te)+") "};s.orderlocked>0&&d(f(vn(qt)),s.orderlocked,vn(Nt)),s.contractlocked>0&&d(f(vn(Ft)),s.contractlocked,vn(Tt)),s.bondlocked>0&&d(f(vn(Et)),s.bondlocked,vn(Dt)),s.bondReserves>0&&d(f(vn(Bt)),s.bondReserves,vn(Ot)),s.reservesDeficit>0&&d(vn(Mt),s.reservesDeficit,vn(Pt));for(var v=0,m=h;v<m.length;v++){var g=r(m[v],2),y=g[0],k=g[1],b=r("Shielded"===(p=y)?[vn(Lt),vn(Wt)]:[p,""],2),w=b[0],x=b[1];k.locked&&(w=f(w)),d(w,k.amt,x)}e.purchaserBal.textContent=br.formatFourSigFigs(s.available/a.conventional.conversionFactor),Sn().bindTooltips(e.balanceDetailBox)}},{key:"showAvailableMarkets",value:function(e){for(var t=this.page,n=Sn().user.exchanges,a=[],o=0,s=Object.values(n);o<s.length;o++){var i=s[o];if(i.markets)for(var c=0,l=Object.values(i.markets);c<l.length;c++){var u=l[c];u.baseid!==e&&u.quoteid!==e||a.push([i.host,u])}}var d=function(e,t){var n=t.spot;if(!n)return 0;var r=Sn().unitInfo(e).conventional.conversionFactor;return(e===t.baseid?n.vol24:n.vol24*n.rate/Gn)/r};a.sort((function(t,n){var a=r(t,2),o=a[0],s=a[1],i=r(n,2),c=i[0],l=i[1];return s.spot||l.spot?d(e,l)-d(e,s):o.localeCompare(c)})),br.empty(t.availableMarkets);for(var h=function(){var a=r(f[p],2),o=a[0],s=a[1],i=s.spot,c=s.baseid,l=s.basesymbol,u=s.quoteid,h=s.quotesymbol,v=t.marketRow.cloneNode(!0);t.availableMarkets.appendChild(v);var m=br.parseTemplate(v);if(m.host.textContent=o,m.baseLogo.src=br.logoPath(l),m.quoteLogo.src=br.logoPath(h),br.empty(m.baseSymbol,m.quoteSymbol),m.baseSymbol.appendChild(br.symbolize(Sn().assets[c],!0)),m.quoteSymbol.appendChild(br.symbolize(Sn().assets[u],!0)),i){var g=Sn().conventionalRate(c,u,i.rate,n[o]);m.price.textContent=br.formatFourSigFigs(g);var y=function(e){return e.split(".")[0].toUpperCase()};m.priceQuoteUnit.textContent=y(h),m.priceBaseUnit.textContent=y(l),m.volume.textContent=br.formatFourSigFigs(d(e,s)),m.volumeUnit.textContent=y(e===c?l:h)}else br.hide(m.priceBox,m.volumeBox);br.bind(v,"click",(function(){return Sn().loadPage("markets",{host:o,base:c,quote:u})}))},p=0,f=a;p<f.length;p++)h();t.marketsOverviewBox.classList.remove("invisible")}},{key:"showRecentActivity",value:(E=o(b().mark((function e(t){var n,r,a,o,s,i,c,l,u,d,h,p,f,v,m,g;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,r=Sn().loading(n.orderActivityBox),a={n:20,assets:[t],hosts:[],statuses:[]},e.next=5,Lr("/api/orders",a);case 5:if(o=e.sent,r(),br.hide(n.noActivity,n.orderActivity),o.orders&&0!==o.orders.length){e.next=12;break}return br.show(n.noActivity),n.orderActivityBox.classList.remove("invisible"),e.abrupt("return");case 12:for(br.show(n.orderActivity),br.empty(n.recentOrders),s=0,i=o.orders;s<i.length;s++)c=i[s],l=n.recentOrderTmpl.cloneNode(!0),n.recentOrders.appendChild(l),u=br.parseTemplate(l),d=void 0,h=void 0,p=[Sn().unitInfo(c.baseID),Sn().unitInfo(c.quoteID)],f=p[0],v=p[1],c.sell?(m=[Sn().assets[c.baseID],Sn().assets[c.quoteID]],d=m[0],h=m[1],u.fromQty.textContent=br.formatCoinValue(c.qty,f),c.type===Un&&(u.toQty.textContent=br.formatCoinValue(c.qty/Gn*c.rate,v))):(g=[Sn().assets[c.quoteID],Sn().assets[c.baseID]],d=g[0],h=g[1],c.type===Vn?u.fromQty.textContent=br.formatCoinValue(c.qty,f):(u.fromQty.textContent=br.formatCoinValue(c.qty/Gn*c.rate,v),u.toQty.textContent=br.formatCoinValue(c.qty,f))),u.fromLogo.src=br.logoPath(d.symbol),br.empty(u.fromSymbol,u.toSymbol),u.fromSymbol.appendChild(br.symbolize(d,!0)),u.toLogo.src=br.logoPath(h.symbol),u.toSymbol.appendChild(br.symbolize(h,!0)),u.status.textContent=Jn(c),u.filled.textContent="".concat((Zn(c)/c.qty*100).toFixed(1),"%"),u.age.textContent=br.timeSince(c.submitTime),u.link.href="order/".concat(c.id),Sn().bindInternalNavigation(l);n.orderActivityBox.classList.remove("invisible");case 16:case"end":return e.stop()}}),e,this)}))),function(e){return E.apply(this,arguments)})},{key:"rescanWallet",value:(F=o(b().mark((function e(t){var n,r,a,o,s;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,br.hide(n.reconfigErr),r="/api/rescanwallet",a={assetID:t},o=Sn().loading(this.body),e.next=7,Lr(r,a);case 7:if(s=e.sent,o(),s.code!==Ur.activeOrdersErr){e.next=14;break}return this.forceUrl=r,this.forceReq=a,this.showConfirmForce(),e.abrupt("return");case 14:if(Sn().checkResponse(s)){e.next=17;break}return br.showFormError(n.reconfigErr,s.msg),e.abrupt("return");case 17:this.assetUpdated(t,n.reconfigForm,vn(we));case 18:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"showConfirmForce",value:function(){br.hide(this.page.confirmForceErr),this.showForm(this.page.confirmForce)}},{key:"showRecoverWallet",value:function(){br.hide(this.page.recoverWalletErr),this.showForm(this.page.recoverWalletConfirm)}},{key:"openWallet",value:(A=o(b().mark((function e(t){var n,r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Mr.passwordIsCached()){e.next=4;break}this.showOpen(t),e.next=9;break;case 4:return n={assetID:t},e.next=7,Lr("/api/openwallet",n);case 7:r=e.sent,Sn().checkResponse(r)?this.openWalletSuccess(t):this.showOpen(t,vn(it,{msg:r.msg}));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"showOpen",value:(S=o(b().mark((function e(t,n){var r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.page,this.unlockForm.refresh(Sn().assets[t]),n&&this.unlockForm.showErrorOnly(n),this.showForm(r.unlockWalletForm);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return S.apply(this,arguments)})},{key:"showReconfig",value:(C=o(b().mark((function e(t,n){var r,a,o,s,i,c,l,u,d,h,p,f,v,m,g;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.page,br.hide(o.changeWalletType,o.changeTypeHideIcon,o.reconfigErr,o.showChangeType,o.changeTypeHideIcon,o.reconfigErr,o.enableWallet,o.disableWallet),this.changeWalletPW=!1,this.setPWSettingViz(this.changeWalletPW),s=Sn().assets[t],i=Sn().currentWalletDefinition(t),c=s.token?[s.token.definition]:s.info?s.info.availablewallets:[],l=null===(r=Sn().user.extensionModeConfig)||void 0===r||null===(a=r.restrictedWallets[Pa(t)])||void 0===a?void 0:a.disableWalletType,c.length>1&&!l){br.empty(o.changeWalletTypeSelect),br.show(o.showChangeType,o.changeTypeShowIcon),o.changeTypeMsg.textContent=vn(fe),u=lo(c);try{for(u.s();!(d=u.n()).done;)h=d.value,p=document.createElement("option"),h.type===i.type&&(p.selected=!0),p.value=p.textContent=h.type,o.changeWalletTypeSelect.appendChild(p)}catch(e){u.e(e)}finally{u.f()}}return f=Sn().walletMap[t],br.setVis(4&f.traits,o.downloadLogs),br.setVis(32&f.traits,o.recoverWallet),br.setVis(256&f.traits,o.exportWallet),br.setVis(1&f.traits,o.rescanWallet),br.setVis(1024&f.traits&&!f.disabled,o.managePeers),br.setVis(8192&f.traits&&!f.disabled,o.unapproveTokenAllowance),br.setVis(0&f.traits,o.otherActionsLabel),f.disabled?br.show(o.enableWallet):br.show(o.disableWallet),this.showOrHideRecoverySupportMsg(f,i.seeded),o.recfgAssetLogo.src=br.logoPath(s.symbol),o.recfgAssetName.textContent=s.name,n||this.showForm(o.reconfigForm),v=Sn().loading(o.reconfigForm),e.next=25,Lr("/api/walletsettings",{assetID:t});case 25:if(m=e.sent,v(),Sn().checkResponse(m)){e.next=30;break}return br.showFormError(o.reconfigErr,m.msg),e.abrupt("return");case 30:g=Sn().haveActiveOrders(t),this.reconfigForm.update(s.id,i.configopts||[],g),this.setGuideLink(i.guidelink),this.reconfigForm.setConfig(m.map),this.updateDisplayedReconfigFields(i);case 35:case"end":return e.stop()}}),e,this)}))),function(e,t){return C.apply(this,arguments)})},{key:"showOrHideRecoverySupportMsg",value:function(e,t){this.setRecoverySupportMsgViz(t&&!e.running&&!e.disabled&&Boolean(32&e.traits),e.symbol)}},{key:"setRecoverySupportMsgViz",value:function(e,t){var n=this.page;if(e)return n.reconfigSupportMsg.textContent=vn(_t,{walletSymbol:t.toLocaleUpperCase()}),br.show(n.reconfigSupportMsg),n.submitReconfig.setAttribute("disabled",""),void n.submitReconfig.classList.add("grey");n.submitReconfig.removeAttribute("disabled"),n.submitReconfig.classList.remove("grey"),br.empty(n.reconfigSupportMsg),br.hide(n.reconfigSupportMsg)}},{key:"changeWalletType",value:function(){var e=this.page.changeWalletTypeSelect.value||"",t=Sn().walletDefinition(this.selectedAssetID,e);this.reconfigForm.update(this.selectedAssetID,t.configopts||[],!1);var n=Sn().walletMap[this.selectedAssetID],r=Sn().currentWalletDefinition(this.selectedAssetID);t.type!==r.type?this.setRecoverySupportMsgViz(!1,n.symbol):this.showOrHideRecoverySupportMsg(n,t.seeded),this.setGuideLink(t.guidelink),this.updateDisplayedReconfigFields(t)}},{key:"setGuideLink",value:function(e){br.hide(this.walletCfgGuide),""!==e&&(this.walletCfgGuide.href=e,br.show(this.walletCfgGuide))}},{key:"updateDisplayedReconfigFields",value:function(e){var t,n,r=null===(t=Sn().user.extensionModeConfig)||void 0===t||null===(n=t.restrictedWallets[Pa(this.selectedAssetID)])||void 0===n?void 0:n.disablePassword;e.seeded||"token"===e.type||r?(br.hide(this.page.showChangePW,this.reconfigForm.fileSelector),this.changeWalletPW=!1,this.setPWSettingViz(!1)):br.show(this.page.showChangePW,this.reconfigForm.fileSelector)}},{key:"showDeposit",value:(k=o(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.depositAddrForm.setAsset(t),this.showForm(this.page.deposit);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"showSendForm",value:(y=o(b().mark((function e(t){var n,r,a,o,s,i,c,l,u,d,h,p,f,v,m,g,y;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,r=n.sendForm,a=Sn().assets[t],o=a.wallet,s=a.unitInfo,i=a.symbol,c=a.token,br.hide(n.toggleSubtract),n.subtractCheckBox.checked=!1,(l=0!=(64&o.traits))&&br.show(n.toggleSubtract),br.hide(n.validAddr,n.sendErr,n.maxSendDisplay,n.sendTokenMsgBox),n.sendAddr.classList.remove("invalid"),n.sendAddr.value="",n.sendAmt.value="",u=Sn().fiatRatesMap[t],br.showFiatValue(n.sendValue,0,u,s),n.walletBal.textContent=br.formatFullPrecision(o.balance.available,s),n.sendLogo.src=br.logoPath(i),n.sendName.textContent=s.conventional.unit,c&&(d=Sn().assets[c.parentID],n.sendTokenParentLogo.src=br.logoPath(d.symbol),n.sendTokenParentName.textContent=d.name,br.show(n.sendTokenMsgBox)),!(o.balance.available>0&&0!=(512&o.traits))){e.next=25;break}return h={assetID:t,subtract:l,value:o.balance.available},p=Sn().loading(this.body),e.next=22,Lr("/api/txfee",h);case 22:f=e.sent,p(),Sn().checkResponse(f)&&(v=o.balance.available,c||(v-=f.txfee)<0&&(v=0),this.maxSend=v,n.maxSend.textContent=br.formatFullPrecision(v,s),br.showFiatValue(n.maxSendFiat,v,u,s),c?(m=Sn().assets[c.parentID],g=m.unitInfo,y=m.symbol,n.maxSendFee.textContent=br.formatFullPrecision(f.txfee,g)+" "+y,br.showFiatValue(n.maxSendFeeFiat,f.txfee,Sn().fiatRatesMap[c.parentID],s)):(n.maxSendFee.textContent=br.formatFullPrecision(f.txfee,s),br.showFiatValue(n.maxSendFeeFiat,f.txfee,u,s)),br.show(n.maxSendDisplay));case 25:br.showFiatValue(n.sendValue,0,u,s),n.walletBal.textContent=br.formatFullPrecision(o.balance.available,s),r.dataset.assetID=String(t),this.showForm(r);case 29:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"doConnect",value:(g=o(b().mark((function e(t){var n,r,a,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Sn().loading(this.body),e.next=3,Lr("/api/connectwallet",{assetID:t});case 3:r=e.sent,n(),Sn().checkResponse(r)||(a=Sn().assets[t].symbol,(o=this.page).errorModalMsg.textContent=vn(bt,{assetName:a,errMsg:r.msg}),this.showForm(o.errorModal)),this.updateDisplayedAsset(t);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"openWalletSuccess",value:(m=o(b().mark((function e(t,n){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assetUpdated(t,n,vn(Ce));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"assetUpdated",value:function(e,t,n){e===this.selectedAssetID&&(this.updateDisplayedAsset(e),t&&Object.is(this.currentForm,t)&&(n?this.showSuccess(n):this.closePopups()))}},{key:"populateMaxSend",value:(v=o(b().mark((function e(){var t,n,r,a,o,s,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.page,n=Sn().assets[this.selectedAssetID],r=n.id,a=n.unitInfo,o=n.wallet,s=Sn().fiatRatesMap[r],0==(64&o.traits)?(t.sendAmt.value=String(this.maxSend/a.conventional.conversionFactor),br.showFiatValue(t.sendValue,this.maxSend,s,a),t.subtractCheckBox.checked=!1):(i=o.balance.available,t.sendAmt.value=String(i/a.conventional.conversionFactor),br.showFiatValue(t.sendValue,i,s,a),t.subtractCheckBox.checked=!0);case 4:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"send",value:(f=o(b().mark((function e(){var t,n,r,a,o,s,i,c,l,u,d,h;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.page,o=parseInt(null!==(t=a.sendForm.dataset.assetID)&&void 0!==t?t:""),s=null!==(n=a.subtractCheckBox.checked)&&void 0!==n&&n,i=Sn().unitInfo(o).conventional.conversionFactor,c=a.vSendPw.value||"",a.vSendPw.value="",""!==c){e.next=9;break}return br.showFormError(a.vSendErr,vn(w)),e.abrupt("return");case 9:return l={assetID:o,address:a.sendAddr.value,subtract:s,value:Math.round(parseFloat(null!==(r=a.sendAmt.value)&&void 0!==r?r:"")*i),pw:c},u=Sn().loading(a.vSendForm),e.next=13,Lr("/api/send",l);case 13:if(d=e.sent,u(),Sn().checkResponse(d)){e.next=18;break}return br.showFormError(a.vSendErr,d.msg),e.abrupt("return");case 18:h=Sn().assets[o].name,this.assetUpdated(o,a.vSendForm,vn(ke,{assetName:h}));case 20:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"reconfig",value:(p=o(b().mark((function e(){var t,n,r,a,o,s,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,r=this.selectedAssetID,br.hide(n.reconfigErr),n.appPW.value||Mr.passwordIsCached()){e.next=6;break}return br.showFormError(n.reconfigErr,vn(x)),e.abrupt("return");case 6:return a=Sn().currentWalletDefinition(r).type,br.isHidden(n.changeWalletType)||(a=n.changeWalletTypeSelect.value||""),o=Sn().loading(n.reconfigForm),s={assetID:r,config:this.reconfigForm.map(r),appPW:null!==(t=n.appPW.value)&&void 0!==t?t:"",walletType:a},this.changeWalletPW&&(s.newWalletPW=n.newPW.value),e.next=13,this.safePost("/api/reconfigurewallet",s);case 13:if(i=e.sent,n.appPW.value="",n.newPW.value="",o(),Sn().checkResponse(i)){e.next=20;break}return br.showFormError(n.reconfigErr,i.msg),e.abrupt("return");case 20:this.assetUpdated(r,n.reconfigForm,vn(be)),this.updateTicketBuyer(r);case 22:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"lock",value:(h=o(b().mark((function e(t){var n,r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,r=Sn().loading(n.newWalletForm),e.next=4,Lr("/api/closewallet",{assetID:t});case 4:if(a=e.sent,r(),Sn().checkResponse(a)){e.next=8;break}return e.abrupt("return");case 8:this.updateDisplayedAsset(t);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"downloadLogs",value:(l=o(b().mark((function e(){var t,n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new URLSearchParams("")).append("assetid","".concat(this.selectedAssetID)),(n=new URL(window.location.href)).search=t.toString(),n.pathname="/wallets/logfile",window.open(n.toString());case 6:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"displayExportWalletAuth",value:(c=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.page,br.hide(t.exportWalletErr),t.exportWalletPW.value="",this.showForm(t.exportWalletAuth);case 4:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"exportWalletAuthSubmit",value:(i=o(b().mark((function e(){var t,n,r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n={assetID:this.selectedAssetID,pass:t.exportWalletPW.value},r=Sn().loading(t.forms),e.next=6,Lr("/api/restorewalletinfo",n);case 6:a=e.sent,r(),Sn().checkResponse(a)?(t.exportWalletPW.value="",this.displayRestoreWalletInfo(a.restorationinfo)):br.showFormError(t.exportWalletErr,a.msg);case 9:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"displayRestoreWalletInfo",value:(a=o(b().mark((function e(t){var n,r,a,o,s,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.page,br.empty(n.restoreInfoCardsList),r=lo(t);try{for(r.s();!(a=r.n()).done;)o=a.value,s=this.restoreInfoCard.cloneNode(!0),(i=br.parseTemplate(s)).name.textContent=o.target,i.seed.textContent=o.seed,i.seedName.textContent="".concat(o.seedName,":"),i.instructions.textContent=o.instructions,n.restoreInfoCardsList.appendChild(s)}catch(e){r.e(e)}finally{r.f()}this.showForm(n.restoreWalletInfo);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"recoverWallet",value:(n=o(b().mark((function e(){var t,n,r,a,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,br.hide(t.recoverWalletErr),n={assetID:this.selectedAssetID,appPW:t.recoverWalletPW.value},t.recoverWalletPW.value="",r="/api/recoverwallet",a=Sn().loading(t.forms),e.next=8,Lr(r,n);case 8:o=e.sent,a(),o.code===Ur.activeOrdersErr?(this.forceUrl=r,this.forceReq=n,this.showConfirmForce()):Sn().checkResponse(o)?this.closePopups():br.showFormError(t.recoverWalletErr,o.msg);case 11:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"confirmForceSubmit",value:(t=o(b().mark((function e(){var t,n,r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,this.forceReq.force=!0,n=Sn().loading(t.forms),e.next=5,Lr(this.forceUrl,this.forceReq);case 5:r=e.sent,n(),Sn().checkResponse(r)?this.closePopups():br.showFormError(t.confirmForceErr,r.msg);case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"handleBalanceNote",value:function(e){this.updateAssetButton(e.assetID),e.assetID===this.selectedAssetID&&this.updateDisplayedAssetBalance()}},{key:"handleRatesNote",value:function(e){this.updateAssetButton(this.selectedAssetID),e.fiatRates[this.selectedAssetID]&&this.updateDisplayedAssetBalance()}},{key:"handleWalletStateNote",value:function(e){this.updateAssetButton(e.wallet.assetID),this.assetUpdated(e.wallet.assetID),"WalletPeersUpdate"===e.topic&&e.wallet.assetID===this.selectedAssetID&&br.isDisplayed(this.page.managePeersForm)&&this.updateWalletPeersTable()}},{key:"handleCreateWalletNote",value:function(e){this.updateAssetButton(e.assetID),this.assetUpdated(e.assetID)}},{key:"handleCustomWalletNote",value:function(e){var t=e.payload;if(t.tip){var n=t;if(42===n.assetID){if(!this.stakeStatus)return;var r=n.data;if(Sn().walletMap[n.assetID].synced){var a=Sn().unitInfo(n.assetID);this.updateTicketStats(r.stats,a,r.ticketPrice,r.votingSubsidy)}}}}},{key:"unload",value:function(){br.unbind(document,"keyup",this.keyup)}}]),re}(Pr);function yo(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var ko="order",bo="match",wo="bondpost",xo="conn";function Co(){return"browser_notifications-".concat(window.location.host)}var So,Ao=(d(ho={},ko,nn),d(ho,bo,rn),d(ho,wo,an),d(ho,xo,on),ho);function Fo(){return"denied"===window.Notification.permission}function Eo(){return Io.apply(this,arguments)}function Io(){return(Io=o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Notification"in window){e.next=2;break}return e.abrupt("return");case 2:if("granted"!==Notification.permission){e.next=6;break}Ro(vn(tn)),e.next=10;break;case 6:if("denied"===Notification.permission){e.next=10;break}return e.next=9,Notification.requestPermission();case 9:Ro(vn(tn));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ro(e,t){if("granted"===window.Notification.permission)return new window.Notification(e,{body:t,icon:"/img/softened-icon.png"})}function To(){return Do.apply(this,arguments)}function Do(){return(Do=o(b().mark((function e(){var t,n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===So){e.next=2;break}return e.abrupt("return",So);case 2:return n=Co(),e.next=5,Mr.fetchLocal(n);case 5:if(e.t1=t=e.sent,e.t0=null!==e.t1,!e.t0){e.next=9;break}e.t0=void 0!==t;case 9:if(!e.t0){e.next=13;break}e.t2=t,e.next=14;break;case 13:e.t2={};case 14:return So=e.t2,e.abrupt("return",So);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Mo(e,t){return Po.apply(this,arguments)}function Po(){return(Po=o(b().mark((function e(t,n){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,To();case 2:So[t]=n,Mr.storeLocal(Co(),So);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}d(po={},ko,!0),d(po,bo,!0),d(po,wo,!0),d(po,xo,!0);var Bo=["bonds"];var Oo=function(e){En(S,e);var t,n,r,a,i,c,l,h,p,f,v,m,g,y,k,w,C=(k=S,w=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rn(k);if(w){var n=Rn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return In(this,e)});function S(e){var t;s(this,S),d(An(t=C.call(this)),"body",void 0),d(An(t),"currentDEX",void 0),d(An(t),"page",void 0),d(An(t),"forms",void 0),d(An(t),"fiatRateSources",void 0),d(An(t),"regAssetForm",void 0),d(An(t),"confirmRegisterForm",void 0),d(An(t),"newWalletForm",void 0),d(An(t),"walletWaitForm",void 0),d(An(t),"dexAddrForm",void 0),d(An(t),"appPassResetForm",void 0),d(An(t),"currentForm",void 0),d(An(t),"pwCache",void 0),d(An(t),"keyup",void 0),t.body=e;var n=t.page=br.idDescendants(e);t.forms=br.applySelector(n.forms,":scope > form"),t.fiatRateSources=br.applySelector(n.fiatRateSources,"input[type=checkbox]"),br.bind(n.darkMode,"click",(function(){Mr.setCookie(Mr.darkModeCK,n.darkMode.checked?"1":"0"),n.darkMode.checked?document.body.classList.add("dark"):document.body.classList.remove("dark")})),n.showPokes.checked="1"===Mr.fetchLocal(Mr.popupsLK),br.bind(n.showPokes,"click",(function(){var e=n.showPokes.checked||!1;Mr.storeLocal(Mr.popupsLK,e?"1":"0"),Sn().showPopups=e})),n.commitHash.textContent=Sn().commitHash.substring(0,7),br.bind(n.addADex,"click",(function(){t.dexAddrForm.refresh(),t.showForm(n.dexAddrForm)})),t.fiatRateSources.forEach((function(e){br.bind(e,"change",o(b().mark((function t(){var n;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Lr("/api/toggleratesource",{disable:!e.checked,source:e.value});case 2:return n=t.sent,Sn().checkResponse(n)||(e.checked=!e.checked),t.next=6,Sn().fetchUser();case 6:case"end":return t.stop()}}),t)}))))})),t.regAssetForm=new ga(n.regAssetForm,function(){var e=o(b().mark((function e(r){var a,o,s,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.confirmRegisterForm.setAsset(r),a=Sn().assets[r],!(o=a.wallet)){e.next=14;break}return s=t.currentDEX.bondAssets[a.symbol],e.next=7,t.getBondsFeeBuffer(r,n.regAssetForm);case 7:if(i=e.sent,!(o.synced&&o.balance.available>=2*s.amount+i)){e.next=11;break}return t.animateConfirmForm(n.regAssetForm),e.abrupt("return");case 11:return t.walletWaitForm.setWallet(o,i),t.slideSwap(n.walletWait),e.abrupt("return");case 14:t.newWalletForm.setAsset(r),t.slideSwap(n.newWalletForm);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.confirmRegisterForm=new ma(n.confirmRegForm,(function(){t.registerDEXSuccess()}),(function(){t.animateRegAsset(n.confirmRegForm)}),t.pwCache),t.newWalletForm=new pa(n.newWalletForm,(function(e){return t.newWalletCreated(e)}),t.pwCache,(function(){return t.animateRegAsset(n.newWalletForm)})),t.walletWaitForm=new ka(n.walletWait,(function(){t.animateConfirmForm(n.walletWait)}),(function(){t.animateRegAsset(n.walletWait)})),t.dexAddrForm=new xa(n.dexAddrForm,function(){var e=o(b().mark((function e(r,a){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.currentDEX=r,t.confirmRegisterForm.setExchange(r,a),t.walletWaitForm.setExchange(r),t.regAssetForm.setExchange(r),t.animateRegAsset(n.dexAddrForm);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),br.bind(n.importAccount,"click",(function(){return t.prepareAccountImport(n.authorizeAccountImportForm)})),Ta(n.authorizeAccountImportForm,n.authorizeImportAccountConfirm,(function(){return t.importAccount()})),br.bind(n.changeAppPW,"click",(function(){return t.showForm(n.changeAppPWForm)})),Ta(n.changeAppPWForm,n.submitNewPW,(function(){return t.changeAppPW()})),t.appPassResetForm=new Fa(n.resetAppPWForm,o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sn().loadPage("login");case 2:br.hide(n.forms);case 3:case"end":return e.stop()}}),e)})))),br.bind(n.resetAppPW,"click",(function(){t.appPassResetForm.refresh(),t.showForm(n.resetAppPWForm),t.appPassResetForm.focus()})),br.bind(n.accountFile,"change",(function(){return t.onAccountFileChange()})),br.bind(n.removeAccount,"click",(function(){return t.clearAccountFile()})),br.bind(n.addAccount,"click",(function(){return n.accountFile.click()})),br.bind(n.exportSeed,"click",(function(){br.hide(n.exportSeedErr),t.showForm(n.exportSeedAuth)})),Ta(n.exportSeedAuth,n.exportSeedSubmit,(function(){return t.submitExportSeedReq()}));var r=function(){br.hide(n.forms),n.exportSeedPW.value="",n.seedDiv.textContent=""};return br.bind(n.forms,"mousedown",(function(e){br.mouseInElement(e,t.currentForm)||r()})),t.keyup=function(e){"Escape"===e.key&&r()},br.bind(document,"keyup",t.keyup),n.forms.querySelectorAll(".form-closer").forEach((function(e){br.bind(e,"click",(function(){r()}))})),t.renderDesktopNtfnSettings(),t}return u(S,[{key:"updateNtfnSetting",value:function(){var e=o(b().mark((function e(t){var n,r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target,null!==(r=n.getAttribute("name"))){e.next=4;break}return e.abrupt("return");case 4:return a=n.checked,e.next=7,Mo(r,a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBrowserNtfnSettings",value:(y=o(b().mark((function e(t){var n,r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Sn().loading(t),e.next=3,To();case 3:return r=e.sent,n(),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)})},{key:"renderDesktopNtfnSettings",value:(g=o(b().mark((function e(){var t,n,r,a,s,i,c=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,e.next=3,this.getBrowserNtfnSettings(t.browserNotificationsForm);case 3:n=e.sent,r=Ao,(a=t.browserNtfnCheckboxTemplate).removeAttribute("id"),s=t.browserNtfnCheckboxContainer,br.empty(t.browserNtfnCheckboxContainer),Object.keys(r).forEach((function(e){var t=a.cloneNode(!0),o=n[e],i=br.tmplElement(t,"checkbox");br.tmplElement(t,"label").textContent=vn(r[e]),i.setAttribute("name",e),o&&i.setAttribute("checked","checked"),s.appendChild(t),br.bind(i,"click",c.updateNtfnSetting)})),i=t.browserNtfnEnabled,br.bind(i,"click",function(){var e=o(b().mark((function e(t){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Fo()){e.next=2;break}return e.abrupt("return");case 2:if(!(n=t.target).checked){e.next=7;break}return e.next=6,Eo();case 6:n.checked=!Fo();case 7:return e.next=9,c.updateNtfnSetting(t);case 9:n.dispatchEvent(new Event("change"));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),br.bind(i,"change",(function(e){var n=e.target,r=Fo();br.setVis(n.checked,t.browserNtfnCheckboxContainer),br.setVis(r,t.browserNtfnBlockedMsg),n.disabled=r})),i.checked="granted"===window.Notification.permission&&n.browserNtfnEnabled,i.dispatchEvent(new Event("change"));case 15:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"slideSwap",value:function(e){Ia(this.currentForm,e),this.currentForm=e}},{key:"getBondsFeeBuffer",value:(m=o(b().mark((function e(t,n){var r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Sn().loading(n),e.next=3,Lr("/api/bondsfeebuffer",{assetID:t});case 3:if(a=e.sent,r(),Sn().checkResponse(a)){e.next=7;break}return e.abrupt("return",0);case 7:return e.abrupt("return",a.feeBuffer);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return m.apply(this,arguments)})},{key:"newWalletCreated",value:(v=o(b().mark((function e(t){var n,r,a,o,s,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sn().fetchUser();case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return");case 5:return r=this.page,a=n.assets[t],o=a.wallet,s=this.currentDEX.bondAssets[a.symbol].amount,e.next=11,this.getBondsFeeBuffer(t,r.newWalletForm);case 11:if(i=e.sent,!(o.synced&&o.balance.available>=2*s+i)){e.next=16;break}return e.next=15,this.animateConfirmForm(r.newWalletForm);case 15:return e.abrupt("return");case 16:this.walletWaitForm.setWallet(o,i),this.slideSwap(r.walletWait);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"onAccountFileChange",value:(f=o(b().mark((function e(){var t,n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,(n=t.accountFile.files)&&n.length){e.next=4;break}return e.abrupt("return");case 4:t.selectedAccount.textContent=n[0].name,br.show(t.removeAccount),br.hide(t.addAccount);case 7:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"clearAccountFile",value:function(){var e=this.page;e.accountFile.value="",e.selectedAccount.textContent=vn(ie),br.hide(e.removeAccount),br.show(e.addAccount)}},{key:"prepareAccountImport",value:(p=o(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.page.importAccountErr.textContent="",this.showForm(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"importAccount",value:(h=o(b().mark((function e(){var t,n,r,a,o,s,i,c,l,u,d,h;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,n=t.importAccountAppPass.value,t.importAccountAppPass.value="",r="",!t.accountFile.value){e.next=12;break}if((a=t.accountFile.files)&&a.length){e.next=9;break}return console.error("importAccount: no file specified"),e.abrupt("return");case 9:return e.next=11,a[0].text();case 11:r=e.sent;case 12:e.prev=12,o=JSON.parse(r),e.next=21;break;case 16:return e.prev=16,e.t0=e.catch(12),t.importAccountErr.textContent=e.t0.message,br.show(t.importAccountErr),e.abrupt("return");case 21:if(void 0!==o){e.next=24;break}return br.showFormError(t.importAccountErr,vn(X)),e.abrupt("return");case 24:return i=(s=o).bonds,c=void 0===i?[]:i,l=yo(s,Bo),u={pw:n,account:l,bonds:c},d=Sn().loading(this.body),e.next=29,Lr("/api/importaccount",u);case 29:if(h=e.sent,d(),Sn().checkResponse(h)){e.next=34;break}return br.showFormError(t.importAccountErr,h.msg),e.abrupt("return");case 34:return e.next=36,Sn().fetchUser();case 36:br.hide(t.forms),window.location.reload();case 38:case"end":return e.stop()}}),e,this,[[12,16]])}))),function(){return h.apply(this,arguments)})},{key:"submitExportSeedReq",value:(l=o(b().mark((function e(){var t,n,r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=t.exportSeedPW.value,r=Sn().loading(this.body),e.next=5,Lr("/api/exportseed",{pass:n});case 5:if(a=e.sent,r(),Sn().checkResponse(a)){e.next=10;break}return br.showFormError(t.exportSeedErr,a.msg),e.abrupt("return");case 10:t.exportSeedPW.value="",t.seedDiv.textContent=a.seed.match(/.{1,32}/g).map((function(e){var t;return null===(t=e.match(/.{1,8}/g))||void 0===t?void 0:t.join(" ")})).join("\n"),this.showForm(t.authorizeSeedDisplay);case 13:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"showForm",value:(c=o(b().mark((function e(t){var n,r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,this.currentForm=t,this.forms.forEach((function(e){return br.hide(e)})),t.style.right="10000px",br.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,br.animate(300,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"getCertFile",value:(i=o(b().mark((function e(){var t,n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="",!this.dexAddrForm.page.certFile.value){e.next=7;break}if(!(n=this.dexAddrForm.page.certFile.files)||!n.length){e.next=7;break}return e.next=6,n[0].text();case 6:t=e.sent;case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"registerDEXSuccess",value:(a=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,br.hide(t.forms),e.next=4,Sn().fetchUser();case 4:window.location.reload();case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"changeAppPW",value:(r=o(b().mark((function e(){var t,n,r,a,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,br.hide(t.changePWErrMsg),n=function(){t.appPW.value="",t.newAppPW.value="",t.confirmNewPW.value=""},t.appPW.value&&t.newAppPW.value&&t.confirmNewPW.value){e.next=7;break}return br.showFormError(t.changePWErrMsg,vn(x)),n(),e.abrupt("return");case 7:if(t.newAppPW.value===t.confirmNewPW.value){e.next=11;break}return br.showFormError(t.changePWErrMsg,vn(K)),n(),e.abrupt("return");case 11:return r=Sn().loading(t.changeAppPW),a={appPW:t.appPW.value,newAppPW:t.newAppPW.value},n(),e.next=16,Lr("/api/changeapppass",a);case 16:if(o=e.sent,r(),Sn().checkResponse(o)){e.next=21;break}return br.showFormError(t.changePWErrMsg,o.msg),e.abrupt("return");case 21:br.hide(t.forms);case 22:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"unload",value:function(){br.unbind(document,"keyup",this.keyup)}},{key:"animateRegAsset",value:(n=o(b().mark((function e(t){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:br.hide(t),n=this.page.regAssetForm,this.currentForm=n,this.regAssetForm.animate(),br.show(n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"animateConfirmForm",value:(t=o(b().mark((function e(t){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.confirmRegisterForm.animate(),n=this.page.confirmRegForm,this.currentForm=n,br.hide(t),br.show(n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),S}(Pr);function Lo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wo=function(){function e(t,n,r){s(this,e),d(this,"base",void 0),d(this,"baseSymbol",void 0),d(this,"quote",void 0),d(this,"quoteSymbol",void 0),d(this,"buys",void 0),d(this,"sells",void 0),this.base=t.base,this.baseSymbol=n,this.quote=t.quote,this.quoteSymbol=r,this.buys=t.book.buys||[],this.sells=t.book.sells||[]}return u(e,[{key:"add",value:function(e){if(0!==e.qtyAtomic){var t=e.sell?this.sells:this.buys;t.splice(function(e,t,n){for(var r=0;r<e.length;r++)if(e[r].rate<t===n)return r;return e.length}(t,e.rate,!e.sell),0,e)}else window.log("zeroqty","zero quantity order encountered",e)}},{key:"remove",value:function(e){this.removeFromSide(this.sells,e)||this.removeFromSide(this.buys,e)}},{key:"removeFromSide",value:function(e,t){var n=r(this.findOrder(e,t),2),a=n[0],o=n[1];return!!a&&(e.splice(o,1),!0)}},{key:"findOrder",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n].token===t)return[e[n],n];return[null,-1]}},{key:"updateRemaining",value:function(e,t,n){this.updateRemainingSide(this.sells,e,t,n)||this.updateRemainingSide(this.buys,e,t,n)}},{key:"updateRemainingSide",value:function(e,t,n,r){var a=this.findOrder(e,t)[0];return!!a&&(a.qty=n,a.qtyAtomic=r,!0)}},{key:"setEpoch",value:function(e){var t=function(t){return void 0===t.epoch||0===t.epoch||t.epoch===e};this.sells=this.sells.filter(t),this.buys=this.buys.filter(t)}},{key:"empty",value:function(){return!this.sells.length&&!this.buys.length}},{key:"count",value:function(){return this.sells.length+this.buys.length}},{key:"bestGapOrder",value:function(e){var t,n=null,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Lo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(!a.epoch)return a;n||(n=a)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"bestGapBuy",value:function(){return this.bestGapOrder(this.buys)}},{key:"bestGapSell",value:function(){return this.bestGapOrder(this.sells)}}]),e}();function qo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function No(e,t,n){if(e||!t.error){if(void 0!==n[e])for(var r=0;r<n[e].length;r++)n[e][r](t)}else{var a=t.error;console.error("websocket error (code ".concat(a.code,"): ").concat(a.message))}}var Uo=0;const Vo=new(function(){function e(){s(this,e),d(this,"uri",void 0),d(this,"connection",void 0),d(this,"handlers",void 0),d(this,"queue",void 0),d(this,"maxQlength",void 0),d(this,"reloader",void 0),this.handlers={},this.queue=[],this.maxQlength=5}return u(e,[{key:"registerRoute",value:function(e,t){this.handlers[e]=this.handlers[e]||[],this.handlers[e].push(t)}},{key:"deregisterRoute",value:function(e){this.handlers[e]=[]}},{key:"request",value:function(e,t){if(this.connection&&this.connection.readyState===window.WebSocket.OPEN){Uo++;var n=JSON.stringify({route:e,type:1,id:Uo,payload:t});window.log("ws","sending",n),this.connection.send(n)}else{for(;this.queue.length>this.maxQlength-1;)this.queue.shift();this.queue.push([e,t])}}},{key:"close",value:function(e){window.log("ws","close, reason:",e,this.handlers),this.handlers={},this.connection&&this.connection.close()}},{key:"connect",value:function(e,t){var n=this;this.uri=e,this.reloader=t;var a=0;!function o(){window.log("ws","connecting to ".concat(e));var s=n.connection=new window.WebSocket(e);if(s){var i=setTimeout((function(){s&&s.close()}),500);s.onmessage=function(e){var t=JSON.parse(e.data);No(t.route,t.payload,n.handlers)},s.onclose=function(e){window.log("ws","onclose"),clearTimeout(i),s=n.connection=null,No("close",null,n.handlers),a++;var t=Math.min(Math.pow(1.25,a),10);console.error("websocket disconnected (".concat(e.code,"), trying again in ").concat(t.toFixed(1)," seconds")),setTimeout((function(){o()}),1e3*t)},s.onopen=function(){window.log("ws","onopen"),clearTimeout(i),a>0&&(a=0,t()),No("open",null,n.handlers);var e=n.queue;n.queue=[];var o,s=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return qo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}(e);try{for(s.s();!(o=s.n()).done;){var c=r(o.value,2),l=c[0],u=c[1];n.request(l,u)}}catch(e){s.e(e)}finally{s.f()}},s.onerror=function(e){window.log("ws","onerror:",e),No("error",e,n.handlers)}}}()}}]),e}());function _o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_o(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function jo(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ho(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ho(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){i=!0,o=e})),f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function Ho(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Go=br.bind,Ko="book",Xo="book_order",Yo="unbook_order",Qo="update_remaining",Jo="epoch_order",Zo="candles",$o="candle_update",es=document.createElement("span");es.classList.add("ico-check");var ts,ns="buygreen-bg",rs="sellred-bg",as="5m",os=new Intl.NumberFormat(document.documentElement.lang,{minimumFractionDigits:1,maximumFractionDigits:2}),ss=4294967295,is=function(e){En(K,e);var t,n,r,a,i,c,l,h,p,f,v,m,g,y,k,w,x,A,F,E,I,R,T,D,_,G=(D=K,_=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rn(D);if(_){var n=Rn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return In(this,e)});function K(e,t){var n;s(this,K),d(An(n=G.call(this)),"page",void 0),d(An(n),"main",void 0),d(An(n),"maxLoaded",void 0),d(An(n),"maxOrderUpdateCounter",void 0),d(An(n),"market",void 0),d(An(n),"currentForm",void 0),d(An(n),"openAsset",void 0),d(An(n),"openFunc",void 0),d(An(n),"currentCreate",void 0),d(An(n),"maxEstimateTimer",void 0),d(An(n),"book",void 0),d(An(n),"cancelData",void 0),d(An(n),"metaOrders",void 0),d(An(n),"preorderCache",void 0),d(An(n),"currentOrder",void 0),d(An(n),"depthLines",void 0),d(An(n),"activeMarkerRate",void 0),d(An(n),"hovers",void 0),d(An(n),"ogTitle",void 0),d(An(n),"depthChart",void 0),d(An(n),"candleChart",void 0),d(An(n),"candleDur",void 0),d(An(n),"balanceWgt",void 0),d(An(n),"marketList",void 0),d(An(n),"quoteUnits",void 0),d(An(n),"baseUnits",void 0),d(An(n),"unlockForm",void 0),d(An(n),"newWalletForm",void 0),d(An(n),"depositAddrForm",void 0),d(An(n),"keyup",void 0),d(An(n),"secondTicker",void 0),d(An(n),"candlesLoading",void 0),d(An(n),"accelerateOrderForm",void 0),d(An(n),"recentMatches",void 0),d(An(n),"recentMatchesSortKey",void 0),d(An(n),"recentMatchesSortDirection",void 0),d(An(n),"stats",void 0),d(An(n),"loadingAnimations",void 0),d(An(n),"approvingBaseToken",void 0),d(An(n),"mmRunning",void 0),ts=Sn().user.net;var r=n.page=br.idDescendants(e);if(n.main=e,!n.main.parentElement)return In(n);n.maxOrderUpdateCounter=0,n.metaOrders={},n.recentMatches=[],n.preorderCache={},n.depthLines={hover:[],input:[]},n.hovers=[],n.recentMatchesSortKey="age",n.recentMatchesSortDirection=-1,n.ogTitle=document.title;var a={click:function(e){n.reportDepthClick(e)},volume:function(e){n.reportDepthVolume(e)},mouse:function(e){n.reportDepthMouse(e)},zoom:function(e){n.reportDepthZoom(e)}};n.depthChart=new Zr(r.depthChart,a,Mr.fetchLocal(Mr.depthZoomLK));var i={mouse:function(e){n.reportMouseCandle(e)}};n.candleChart=new $r(r.candlesChart,i),n.accelerateOrderForm=new wa(r.accelerateForm,(function(){})),n.candleDur=Mr.fetchLocal(Mr.lastCandleDurationLK)||"1h";var c=br.tmplElement(r.notRegistered,"registerBttn");Go(c,"click",(function(){Sn().loadPage("register",{host:n.market.dex.host})})),r.walletInfoTmpl.removeAttribute("id");var l=r.walletInfoTmpl,u=r.walletInfoTmpl.cloneNode(!0);l.after(u);var h=n.balanceWgt=new us(l,u),p=h.base.stateIcons.icons,f=h.quote.stateIcons.icons;Go(h.base.tmpl.connect,"click",(function(){n.showOpen(n.market.base,n.walletUnlocked)})),Go(h.quote.tmpl.connect,"click",(function(){n.showOpen(n.market.quote,n.walletUnlocked)})),Go(h.base.tmpl.expired,"click",(function(){n.showOpen(n.market.base,n.walletUnlocked)})),Go(h.quote.tmpl.expired,"click",(function(){n.showOpen(n.market.quote,n.walletUnlocked)})),Go(p.sleeping,"click",(function(){n.showOpen(n.market.base,n.walletUnlocked)})),Go(f.sleeping,"click",(function(){n.showOpen(n.market.quote,n.walletUnlocked)})),Go(p.locked,"click",(function(){n.showOpen(n.market.base,n.walletUnlocked)})),Go(f.locked,"click",(function(){n.showOpen(n.market.quote,n.walletUnlocked)})),Go(p.disabled,"click",(function(){n.showToggleWalletStatus(n.market.base)})),Go(f.disabled,"click",(function(){n.showToggleWalletStatus(n.market.quote)})),Go(h.base.tmpl.newWalletBttn,"click",(function(){n.showCreate(n.market.base)})),Go(h.quote.tmpl.newWalletBttn,"click",(function(){n.showCreate(n.market.quote)})),Go(h.base.tmpl.walletAddr,"click",(function(){n.showDeposit(n.market.base.id)})),Go(h.quote.tmpl.walletAddr,"click",(function(){n.showDeposit(n.market.quote.id)})),n.depositAddrForm=new Aa(r.deposit),Ta(r.toggleWalletStatusConfirm,r.toggleWalletStatusSubmit,o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.toggleWalletStatus();case 1:case"end":return e.stop()}}),e)})))),Dn(r),br.cleanTemplates(r.rowTemplate,r.durBttnTemplate,r.booleanOptTmpl,r.rangeOptTmpl,r.orderOptTmpl,r.userOrderTmpl),n.quoteUnits=e.querySelectorAll("[data-unit=quote]"),n.baseUnits=e.querySelectorAll("[data-unit=base]"),Go(r.approveBaseBttn,"click",(function(){n.showTokenApprovalForm(!0)})),Go(r.approveQuoteBttn,"click",(function(){n.showTokenApprovalForm(!1)})),Go(r.approveTokenButton,"click",(function(){n.sendTokenApproval()})),Go(r.buyBttn,"click",(function(){n.setBuy()})),Go(r.sellBttn,"click",(function(){n.setSell()})),Go(r.limitBttn,"click",(function(){fs(r.marketBttn,r.limitBttn),n.setOrderVisibility(),r.rateField.value&&(n.depthLines.input=[{rate:parseFloat(r.rateField.value||"0"),color:n.isSell()?n.depthChart.theme.sellLine:n.depthChart.theme.buyLine}],n.drawChartLines())})),Go(r.marketBttn,"click",(function(){fs(r.limitBttn,r.marketBttn),n.setOrderVisibility(),n.setMarketBuyOrderEstimate(),n.depthLines.input=[],n.drawChartLines()})),Go(r.maxOrd,"click",(function(){if(n.isSell()){var e=n.market.maxSell;if(!e)return;r.lotField.value=String(e.swap.lots)}else r.lotField.value=String(n.market.maxBuys[n.adjustedRate()].swap.lots);n.lotChanged()})),br.disableMouseWheel(r.rateField,r.lotField,r.qtyField,r.mktBuyField),Vo.registerRoute(Ko,(function(e){n.handleBookRoute(e)})),Vo.registerRoute(Xo,(function(e){n.handleBookOrderRoute(e)})),Vo.registerRoute(Yo,(function(e){n.handleUnbookOrderRoute(e)})),Vo.registerRoute(Qo,(function(e){n.handleUpdateRemainingRoute(e)})),Vo.registerRoute(Jo,(function(e){n.handleEpochOrderRoute(e)})),Vo.registerRoute(Zo,(function(e){n.handleCandlesRoute(e)})),Vo.registerRoute($o,(function(e){n.handleCandleUpdateRoute(e)})),Vo.registerRoute("epoch_match_summary",(function(e){n.handleEpochMatchSummary(e)})),n.unlockForm=new ba(r.unlockWalletForm,o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.openFunc();case 1:case"end":return e.stop()}}),e)})))),n.newWalletForm=new pa(r.newWalletForm,o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.createWallet();case 1:case"end":return e.stop()}}),e)})))),Ta(r.orderForm,r.submitBttn,o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.stepSubmit();case 1:case"end":return e.stop()}}),e)})))),Ta(r.verifyForm,r.vSubmit,o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.submitOrder();case 1:case"end":return e.stop()}}),e)})))),br.bind(r.vUnlockSubmit,"click",o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.submitEstimateUnlock();case 1:case"end":return e.stop()}}),e)})))),Ta(r.cancelForm,r.cancelSubmit,o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.submitCancel();case 1:case"end":return e.stop()}}),e)})))),br.bind(r.vFeeDetails,"click",(function(){return n.showForm(r.vDetailPane)})),br.bind(r.closeDetailPane,"click",(function(){return n.showVerifyForm()})),r.recentMatchesTable.querySelectorAll("[data-ordercol]").forEach((function(e){return Go(e,"click",(function(){return v(e.dataset.ordercol||"")}))}));var v=function(e){m(),n.recentMatchesSortKey===e?n.recentMatchesSortDirection*=-1:(n.recentMatchesSortKey=e,n.recentMatchesSortDirection=1),n.refreshRecentMatchesTable(),g()},m=function(){r.recentMatchesTable.querySelectorAll("[data-ordercol]").forEach((function(e){return e.classList.remove("sorted-asc","sorted-dsc")}))},g=function(){var e=n.recentMatchesSortKey,t=1===n.recentMatchesSortDirection?"sorted-asc":"sorted-dsc";br.safeSelector(r.recentMatchesTable,"[data-ordercol=".concat(e,"]")).classList.add(t)};g();var y=function(){br.hide(r.forms),r.vPass.value=""};Go(r.forms,"mousedown",(function(e){if(br.isDisplayed(r.vDetailPane)&&!br.mouseInElement(e,r.vDetailPane))return n.showVerifyForm();br.mouseInElement(e,n.currentForm)||y()})),n.keyup=function(e){"Escape"===e.key&&y()},Go(document,"keyup",n.keyup),r.forms.querySelectorAll(".form-closer").forEach((function(e){br.bind(e,"click",(function(){y()}))})),Go(r.lotField,"change",(function(){n.lotChanged()})),Go(r.lotField,"keyup",(function(){n.lotChanged()})),Go(r.qtyField,"change",(function(){n.quantityChanged(!0)})),Go(r.qtyField,"keyup",(function(){n.quantityChanged(!1)})),Go(r.mktBuyField,"change",(function(){n.marketBuyChanged()})),Go(r.mktBuyField,"keyup",(function(){n.marketBuyChanged()})),Go(r.rateField,"change",(function(){n.rateFieldChanged()})),Go(r.rateField,"keyup",(function(){n.previewQuoteAmt(!0)})),Go(r.marketSearchV1,"change",(function(){n.filterMarkets()})),Go(r.marketSearchV1,"keyup",(function(){n.filterMarkets()}));var k=function(e){br.setVis(!e,r.disclaimer,r.disclaimerAck),br.setVis(e,r.showDisclaimer)};Go(r.disclaimerAck,"click",(function(){Mr.storeLocal(Mr.orderDisclaimerAckedLK,!0),k(!0)})),Go(r.showDisclaimer,"click",(function(){Mr.storeLocal(Mr.orderDisclaimerAckedLK,!1),k(!1)})),k(Mr.fetchLocal(Mr.orderDisclaimerAckedLK));var w=function(){n.depthLines.hover=[],n.drawChartLines()};Go(r.buyRows,"mouseleave",w),Go(r.sellRows,"mouseleave",w),Go(r.userOrders,"mouseleave",(function(){n.activeMarkerRate=null,n.setDepthMarkers()}));var x=r.marketStatsV1,C=x.cloneNode(!0);C.classList.add("listopen"),br.hide(x,C),C.removeAttribute("id"),Sn().headerSpace.appendChild(C),n.stats=[{row:x,tmpl:br.parseTemplate(x)},{row:C,tmpl:br.parseTemplate(C)}];var S=function(){Mr.storeLocal(Mr.leftMarketDockLK,"0"),r.leftMarketDock.classList.remove("default"),r.leftMarketDock.classList.add("stashed");var e,t=jo(n.stats);try{for(t.s();!(e=t.n()).done;)e.value.row.classList.remove("listopen")}catch(e){t.e(e)}finally{t.f()}},A=function(){Mr.storeLocal(Mr.leftMarketDockLK,"1"),r.leftMarketDock.classList.remove("default","stashed");var e,t=jo(n.stats);try{for(t.s();!(e=t.n()).done;)e.value.row.classList.add("listopen")}catch(e){t.e(e)}finally{t.f()}};br.bind(r.leftHider,"click",(function(){return S()})),br.bind(r.marketReopener,"click",(function(){return A()}));var F,E=jo(n.stats);try{for(E.s();!(F=E.n()).done;){var I=F.value;br.bind(I.tmpl.marketSelect,"click",(function(){0===r.leftMarketDock.clientWidth?A():S()}))}}catch(e){E.e(e)}finally{E.f()}n.marketList=new cs(r.marketListV1);var R,T=jo(n.marketList.markets);try{var D=function(){var e=R.value;Go(e.node,"click",(function(){var t,r,a,o,s=e.mkt,i=s.quoteid,c=s.baseid,l=s.xc.host;(null===(t=n.market)||void 0===t||null===(r=t.base)||void 0===r?void 0:r.id)===c&&(null===(a=n.market)||void 0===a||null===(o=a.quote)||void 0===o?void 0:o.id)===i||(n.startLoadingAnimations(),n.setMarket(l,c,i))}))};for(T.s();!(R=T.n()).done;)D()}catch(e){T.e(e)}finally{T.f()}return"1"!==Mr.fetchLocal(Mr.leftMarketDockLK)&&S(),Sn().registerNoteFeeder({order:function(e){n.handleOrderNote(e)},match:function(e){n.handleMatchNote(e)},epoch:function(e){n.handleEpochNote(e)},conn:function(e){n.handleConnNote(e)},balance:function(e){n.handleBalanceNote(e)},bondpost:function(e){n.handleBondUpdate(e)},spots:function(e){n.handlePriceUpdate(e)},walletstate:function(e){n.handleWalletState(e)}}),n.loadingAnimations={},n.startLoadingAnimations(),n.secondTicker=window.setInterval((function(){for(var e=0,t=Object.values(n.metaOrders);e<t.length;e++){var a=t[e];a.details.age.textContent=br.timeSince(a.ord.submitTime)}var o,s=jo(br.applySelector(r.recentMatchesLiveList,"[data-tmpl=age]"));try{for(s.s();!(o=s.n()).done;){var i,c=o.value;c.textContent=br.timeSince(parseFloat(null!==(i=c.dataset.sinceStamp)&&void 0!==i?i:"0"))}}catch(e){s.e(e)}finally{s.f()}}),1e3),n.init(t),n}return u(K,[{key:"init",value:(T=o(b().mark((function e(t){var n,r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=t&&t.host&&void 0!==t.base&&void 0!==t.quote?ds(t.host,parseInt(t.base),parseInt(t.quote)):Mr.fetchLocal(Mr.lastMarketLK))&&this.marketList.exists(n.host,n.base,n.quote)||(r=this.marketList.first())&&(n={host:r.mkt.xc.host,base:r.mkt.baseid,quote:r.mkt.quoteid}),n?this.setMarket(n.host,n.base,n.quote):this.balanceWgt.setBalanceVisibility(!1),this.setRegistrationStatusVisibility();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return T.apply(this,arguments)})},{key:"startLoadingAnimations",value:function(){var e=this.page,t=this.loadingAnimations,n=this.depthChart,r=this.candleChart;n.canvas.classList.add("invisible"),r.canvas.classList.add("invisible"),t.candles&&t.candles.stop(),t.candles=new ea(e.candlesChart,{message:vn(Pe)}),t.depth&&t.depth.stop(),t.depth=new ea(e.depthChart,{message:vn(Be)})}},{key:"isSell",value:function(){return this.page.sellBttn.classList.contains("selected")}},{key:"isLimit",value:function(){return this.page.limitBttn.classList.contains("selected")}},{key:"setBuy",value:function(){var e=this.page;fs(e.sellBttn,e.buyBttn),e.submitBttn.classList.remove(rs),e.submitBttn.classList.add(ns),e.maxLbl.textContent=vn(M),this.setOrderBttnText(),this.setOrderVisibility(),this.drawChartLines()}},{key:"setSell",value:function(){var e=this.page;fs(e.buyBttn,e.sellBttn),e.submitBttn.classList.add(rs),e.submitBttn.classList.remove(ns),e.maxLbl.textContent=vn(P),this.setOrderBttnText(),this.setOrderVisibility(),this.drawChartLines()}},{key:"hasPendingBonds",value:function(){return Object.keys(this.market.dex.auth.pendingBonds||[]).length>0}},{key:"setCurrMarketPrice",value:function(){var e=this.market;if(e){var t=Sn().exchanges[e.dex.host],n=t.markets[e.cfg.name];if(n.spot){var r,a=jo(this.stats);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=t.assets[n.baseid].unitInfo.conventional.conversionFactor;o.tmpl.volume.textContent=br.formatFourSigFigs(n.spot.vol24/s),gs(o.tmpl,t,n)}}catch(e){a.e(e)}finally{a.f()}this.page.obPrice.textContent=br.formatFourSigFigs(n.spot.rate/this.market.rateConversionFactor),this.page.obPrice.classList.remove("sellcolor","buycolor"),this.page.obPrice.classList.add(n.spot.change24>=0?"buycolor":"sellcolor"),br.setVis(n.spot.change24>=0,this.page.obUp),br.setVis(n.spot.change24<0,this.page.obDown)}}}},{key:"setMarketDetails",value:function(){if(this.market){var e,t=jo(this.stats);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=this.market,a=r.baseCfg,o=r.quoteCfg;n.tmpl.baseIcon.src=br.logoPath(a.symbol),n.tmpl.quoteIcon.src=br.logoPath(o.symbol),br.empty(n.tmpl.baseSymbol,n.tmpl.quoteSymbol),n.tmpl.baseSymbol.appendChild(br.symbolize(a,!0)),n.tmpl.quoteSymbol.appendChild(br.symbolize(o,!0))}}catch(e){t.e(e)}finally{t.f()}}}},{key:"setHighLow",value:function(){var e=0,t=0,n=this.market.cfg.spot;if(n&&n.low24&&n.high24)e=n.high24,t=n.low24;else{var r,a=null===(r=this.market)||void 0===r?void 0:r.candleCaches[as];if(!a){if(this.candleDur!==as)return void this.requestCandles(as);var o,s=jo(this.stats);try{for(s.s();!(o=s.n()).done;){var i=o.value;i.tmpl.high.textContent="-",i.tmpl.low.textContent="-"}}catch(e){s.e(e)}finally{s.f()}return}for(var c=(new Date).getTime()-864e5,l=a.candles.length-1;l>=0;l--){var u=a.candles[l];if(u.endStamp<c)break;(0===t||u.lowRate>0&&u.lowRate<t)&&(t=u.lowRate),u.highRate>e&&(e=u.highRate)}}var d,h=Sn().unitInfo(this.market.cfg.quoteid,this.market.dex).conventional.conversionFactor,p=jo(this.stats);try{for(p.s();!(d=p.n()).done;){var f=d.value;f.tmpl.high.textContent=e>0?br.formatFourSigFigs(e/h):"-",f.tmpl.low.textContent=t>0?br.formatFourSigFigs(t/h):"-"}}catch(e){p.e(e)}finally{p.f()}}},{key:"assetsAreSupported",value:function(){var e,t,n,r,a=this.market,o=a.base,s=a.quote,i=a.baseCfg,c=a.quoteCfg;if(!o||!s){var l=o?c.symbol:i.symbol;return{isSupported:!1,text:vn(B,{asset:l.toUpperCase()})}}var u=o.token?null===(e=Sn().assets[o.token.parentID].info)||void 0===e?void 0:e.versions:null===(t=o.info)||void 0===t?void 0:t.versions,d=s.token?null===(n=Sn().assets[s.token.parentID].info)||void 0===n?void 0:n.versions:null===(r=s.info)||void 0===r?void 0:r.versions,h="";return u.includes(i.version)?d.includes(c.version)||(h=vn(O,{asset:s.symbol.toUpperCase(),version:c.version+""})):h=vn(O,{asset:o.symbol.toUpperCase(),version:i.version+""}),{isSupported:u.includes(i.version)&&d.includes(c.version),text:h}}},{key:"setOrderVisibility",value:function(){var e=this.page;this.isLimit()?(br.show(e.priceBox,e.tifBox,e.qtyBox,e.maxBox),br.hide(e.mktBuyBox),this.previewQuoteAmt(!0)):(br.hide(e.tifBox,e.maxBox,e.priceBox),this.isSell()?(br.hide(e.mktBuyBox),br.show(e.qtyBox),this.previewQuoteAmt(!0)):(br.show(e.mktBuyBox),br.hide(e.qtyBox),this.previewQuoteAmt(!1)))}},{key:"resolveOrderFormVisibility",value:(R=o(b().mark((function e(){var t,n,r,a=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=function(){var e=o(b().mark((function e(){var t,n,r,o,s,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.assetsAreSupported().isSupported){e.next=2;break}return e.abrupt("return",!1);case 2:if(a.market&&!(a.market.dex.auth.effectiveTier<1)){e.next=4;break}return e.abrupt("return",!1);case 4:if(t=a.tokenAssetApprovalStatuses(),n=t.baseAssetApprovalStatus,r=t.quoteAssetApprovalStatus,n===wn.Approved&&r===wn.Approved){e.next=7;break}return e.abrupt("return",!1);case 7:if(o=a.market,s=o.base,i=o.quote,s&&Sn().assets[s.id].wallet&&i&&Sn().assets[i.id].wallet){e.next=11;break}return e.abrupt("return",!1);case 11:if(!a.mmRunning){e.next=13;break}return e.abrupt("return",!1);case 13:return e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.t0=br,e.next=5,n();case 5:if(e.t1=e.sent,e.t2=t.orderForm,e.t3=t.orderTypeBttns,e.t0.setVis.call(e.t0,e.t1,e.t2,e.t3),!Sn().user.experimental||void 0!==this.mmRunning){e.next=14;break}return e.next=12,Sn().getMarketMakingStatus();case 12:r=e.sent,this.mmRunning=r.running;case 14:this.mmRunning&&(br.show(t.mmRunning),br.hide(t.orderForm,t.orderTypeBttns));case 15:case"end":return e.stop()}}),e,this)}))),function(){return R.apply(this,arguments)})},{key:"setLoaderMsgVisibility",value:function(){var e=this.page,t=this.assetsAreSupported(),n=t.isSupported,r=t.text;n?br.hide(e.loaderMsg):(e.loaderMsg.textContent=r,br.show(e.loaderMsg),br.hide(e.notRegistered),br.hide(e.noWallet))}},{key:"showTokenApprovalForm",value:(I=o(b().mark((function e(t){var n,r,a,o,s,i,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,br.show(n.tokenApprovalSubmissionElements),br.hide(n.tokenApprovalTxMsg,n.approveTokenErr),br.setVis(!Mr.passwordIsCached(),n.tokenApprovalPWBox),n.tokenApprovalPW.value="",r=t?this.market.base:this.market.quote,this.approvingBaseToken=t,n.approveTokenSymbol.textContent=r.symbol.toUpperCase(),r.token){e.next=11;break}return console.error("".concat(r.id," should be a token")),e.abrupt("return");case 11:if((a=Sn().assets[r.token.parentID])&&a.info){e.next=15;break}return console.error("".concat(r.token.parentID," asset not found")),e.abrupt("return");case 15:if(o=this.market.dex.assets[r.id]){e.next=19;break}return console.error("".concat(r.id," asset not found in dex ").concat(this.market.dex.host)),e.abrupt("return");case 19:return e.next=22,Lr("/api/approvetokenfee",{assetID:r.id,version:o.version,approving:!0});case 22:s=e.sent,Sn().checkResponse(s)?(i="".concat(br.formatCoinValue(s.txFee,a.unitInfo)," ").concat(a.symbol.toUpperCase()),(c=Sn().fiatRatesMap[a.id])&&(i+=" (".concat(br.formatFiatConversion(s.txFee,c,a.unitInfo)," USD)")),n.approvalFeeEstimate.textContent=i):(n.approveTokenErr.textContent=s.msg,br.show(n.approveTokenErr)),this.showForm(n.approveTokenForm);case 25:case"end":return e.stop()}}),e,this)}))),function(e){return I.apply(this,arguments)})},{key:"sendTokenApproval",value:(E=o(b().mark((function e(){var t,n,r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=this.approvingBaseToken?this.market.base:this.market.quote,e.next=5,Lr("/api/approvetoken",{assetID:n.id,dexAddr:this.market.dex.host,pass:t.tokenApprovalPW.value});case 5:if(r=e.sent,Sn().checkResponse(r)){e.next=10;break}return t.approveTokenErr.textContent=r.msg,br.show(t.approveTokenErr),e.abrupt("return");case 10:t.tokenApprovalTxID.innerText=r.txID,(a=co[n.id])&&a[ts]&&(t.tokenApprovalTxID.href=a[ts](r.txID)),br.hide(t.tokenApprovalSubmissionElements),br.show(t.tokenApprovalTxMsg);case 15:case"end":return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:"tokenAssetApprovalStatuses",value:function(){var e=this.market,t=e.base,n=e.quote,r=wn.Approved,a=wn.Approved;if(null!=t&&t.token){var o,s=Sn().assets[t.id],i=this.market.dex.assets[t.id].version;null!=s&&null!==(o=s.wallet)&&void 0!==o&&o.approved&&void 0!==s.wallet.approved[i]&&(r=s.wallet.approved[i])}if(null!=n&&n.token){var c,l=Sn().assets[n.id],u=this.market.dex.assets[n.id].version;null!=l&&null!==(c=l.wallet)&&void 0!==c&&c.approved&&void 0!==l.wallet.approved[u]&&(a=l.wallet.approved[u])}return{baseAssetApprovalStatus:r,quoteAssetApprovalStatus:a}}},{key:"setTokenApprovalVisibility",value:function(){var e=this.page,t=this.tokenAssetApprovalStatuses(),n=t.baseAssetApprovalStatus,r=t.quoteAssetApprovalStatus;if(n===wn.Approved&&r===wn.Approved)return br.hide(e.tokenApproval),e.sellBttn.removeAttribute("disabled"),void e.buyBttn.removeAttribute("disabled");n!==wn.Approved&&r===wn.Approved&&(e.sellBttn.setAttribute("disabled","disabled"),e.buyBttn.removeAttribute("disabled"),this.setBuy(),br.show(e.approvalRequiredSell),br.hide(e.approvalRequiredBuy,e.approvalRequiredBoth)),n===wn.Approved&&r!==wn.Approved&&(e.buyBttn.setAttribute("disabled","disabled"),e.sellBttn.removeAttribute("disabled"),this.setSell(),br.show(e.approvalRequiredBuy),br.hide(e.approvalRequiredSell,e.approvalRequiredBoth)),n!==wn.Approved&&r!==wn.Approved&&(br.show(e.approvalRequiredBoth),br.hide(e.approvalRequiredSell,e.approvalRequiredBuy)),br.show(e.tokenApproval),e.approvalPendingBaseSymbol.textContent=e.baseTokenAsset.textContent=this.market.base.symbol.toUpperCase(),e.approvalPendingQuoteSymbol.textContent=e.quoteTokenAsset.textContent=this.market.quote.symbol.toUpperCase(),br.setVis(n===wn.NotApproved,e.approveBaseBttn),br.setVis(r===wn.NotApproved,e.approveQuoteBttn),br.setVis(n===wn.Pending,e.approvalPendingBase),br.setVis(r===wn.Pending,e.approvalPendingQuote)}},{key:"setRegistrationStatusView",value:function(e,t,n){var r=this.page;r.regStatusTitle.textContent=e,r.regStatusConfsDisplay.textContent=t,r.registrationStatus.classList.remove("completed","error","waiting"),r.registrationStatus.classList.add(n)}},{key:"updateRegistrationStatusView",value:function(){var e=this.page,t=this.market.dex;if(e.regStatusDex.textContent=t.host,e.postingBondsDex.textContent=t.host,t.auth.effectiveTier>=1)this.setRegistrationStatusView(vn(ce),"","completed");else{var n=(t.auth.pendingBonds||[]).map((function(e){var n=t.bondAssets[e.symbol].confs;return"".concat(e.confs," / ").concat(n)})).join(", ");this.setRegistrationStatusView(vn(se),n,"waiting")}}},{key:"setRegistrationStatusVisibility",value:function(){var e=this,t=this.page,n=this.market;if(n&&n.dex&&n.dex.connectionStatus===bn.Connected)if(this.updateRegistrationStatusView(),n.dex.auth.effectiveTier>=1){var r=function(){var n=o(b().mark((function n(){return b().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:br.hide(t.registrationStatus,t.bondRequired,t.bondCreationPending),e.resolveOrderFormVisibility();case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();if(br.isHidden(t.orderForm))return void setTimeout(r,5e3);r()}else n.dex.viewOnly?(t.unregisteredDex.textContent=n.dex.host,br.show(t.notRegistered)):this.hasPendingBonds()?br.show(t.registrationStatus):n.dex.auth.targetTier>0?br.show(t.bondCreationPending):(t.acctTier.textContent="".concat(n.dex.auth.effectiveTier),t.dexSettingsLink.href="/dexsettings/".concat(n.dex.host),br.show(t.bondRequired))}},{key:"setOrderBttnText",value:function(){this.isSell()?this.page.submitBttn.textContent=vn(S,{asset:br.shortSymbol(this.market.baseCfg.unitInfo.conventional.unit)}):this.page.submitBttn.textContent=vn(C,{asset:br.shortSymbol(this.market.baseCfg.unitInfo.conventional.unit)})}},{key:"setCandleDurBttns",value:function(){var e=this,t=this.page,n=this.market;br.empty(t.durBttnBox);var r,a=jo(n.dex.candleDurs);try{var o=function(){var n=r.value,a=t.durBttnTemplate.cloneNode(!0);a.textContent=n,br.bind(a,"click",(function(){return e.candleDurationSelected(n)})),t.durBttnBox.appendChild(a)};for(a.s();!(r=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}this.loadCandles()}},{key:"setMarket",value:(F=o(b().mark((function e(t,n,r){var a,o,s,i,c,l,u,d,h,p,f,v,m,g,y;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Sn().user.exchanges[t],(o=this.page).lotField.value="",o.qtyField.value="",o.rateField.value="",this.depthChart.clear(),br.empty(this.page.buyRows),br.empty(this.page.sellRows),this.recentMatches=[],br.empty(o.recentMatchesLiveList),this.balanceWgt.setBalanceVisibility(!1),br.hide(o.notRegistered,o.bondRequired,o.noWallet),a&&a.markets&&a.connectionStatus===bn.Connected){e.next=16;break}return o.chartErrMsg.textContent=vn(L),br.show(o.chartErrMsg),e.abrupt("return");case 16:s=jo(this.stats);try{for(s.s();!(i=s.n()).done;)c=i.value,br.show(c.row)}catch(e){s.e(e)}finally{s.f()}l=a.assets[n],u=a.assets[r],d=[Sn().unitInfo(n,a),Sn().unitInfo(r,a)],p=d[1],f=Gn/(h=d[0]).conventional.conversionFactor*p.conventional.conversionFactor,br.hide(o.maxOrd,o.chartErrMsg),this.maxEstimateTimer&&(window.clearTimeout(this.maxEstimateTimer),this.maxEstimateTimer=null),v=hs(l.symbol,u.symbol),m=Sn().assets[n],g=Sn().assets[r],y={dex:a,sid:v,cfg:a.markets[v],base:m,quote:g,baseUnitInfo:h,quoteUnitInfo:p,maxSell:null,maxBuys:{},maxSellRequested:!1,candleCaches:{},baseCfg:l,quoteCfg:u,rateConversionFactor:f,sellBalance:0,buyBalance:0},this.market=y,o.lotSize.textContent=br.formatCoinValue(y.cfg.lotsize,y.baseUnitInfo),o.rateStep.textContent=br.formatCoinValue(y.cfg.ratestep/f),null!=m&&m.wallet&&null!=g&&g.wallet?this.balanceWgt.setWallets(t,n,r):br.setVis(!0,o.noWallet),this.setMarketDetails(),this.setCurrMarketPrice(),Vo.request("loadmarket",ds(t,n,r)),Mr.storeLocal(Mr.lastMarketLK,{host:t,base:n,quote:r}),this.marketList.select(t,n,r),this.setLoaderMsgVisibility(),this.setTokenApprovalVisibility(),this.setRegistrationStatusVisibility(),this.resolveOrderFormVisibility(),this.setOrderBttnText(),this.setCandleDurBttns(),this.previewQuoteAmt(!1),this.updateTitle(),this.loadUserOrders();case 46:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return F.apply(this,arguments)})},{key:"reportDepthClick",value:function(e){this.page.rateField.value=String(e),this.rateFieldChanged()}},{key:"reportDepthVolume",value:function(e){var t=this.page,n=this.market,r=n.baseUnitInfo,a=n.quoteUnitInfo;t.sellBookedBase.textContent=br.formatCoinValue(e.sellBase*r.conventional.conversionFactor,r),t.sellBookedQuote.textContent=br.formatCoinValue(e.sellQuote*a.conventional.conversionFactor,a),t.buyBookedBase.textContent=br.formatCoinValue(e.buyBase*r.conventional.conversionFactor,r),t.buyBookedQuote.textContent=br.formatCoinValue(e.buyQuote*a.conventional.conversionFactor,a)}},{key:"reportDepthMouse",value:function(e){for(;this.hovers.length;)this.hovers.shift().classList.remove("hover");var t=this.page;if(e){br.show(t.hoverData,t.depthHoverData);for(var n=0,r=Object.values(this.metaOrders);n<r.length;n++){var a=r[n],o=a.div,s=a.ord;s.status===zn&&e.hoverMarkers.indexOf(s.rate)>-1&&(o.classList.add("hover"),this.hovers.push(o))}t.hoverPrice.textContent=br.formatCoinValue(e.rate),t.hoverVolume.textContent=br.formatCoinValue(e.depth),t.hoverVolume.style.color=e.dotColor}else br.hide(t.hoverData,t.depthHoverData)}},{key:"reportDepthZoom",value:function(e){Mr.storeLocal(Mr.depthZoomLK,e)}},{key:"reportMouseCandle",value:function(e){var t=this.page;e?(br.show(t.hoverData,t.candleHoverData),t.candleStart.textContent=br.formatCoinValue(e.startRate/this.market.rateConversionFactor),t.candleEnd.textContent=br.formatCoinValue(e.endRate/this.market.rateConversionFactor),t.candleHigh.textContent=br.formatCoinValue(e.highRate/this.market.rateConversionFactor),t.candleLow.textContent=br.formatCoinValue(e.lowRate/this.market.rateConversionFactor),t.candleVol.textContent=br.formatCoinValue(e.matchVolume,this.market.baseUnitInfo)):br.hide(t.hoverData,t.candleHoverData)}},{key:"parseOrder",value:function(){var e=this.page,t=e.qtyField,n=this.isLimit(),r=this.isSell(),a=this.market,o=a.baseUnitInfo.conventional.conversionFactor;return n||r||(t=e.mktBuyField,o=a.quoteUnitInfo.conventional.conversionFactor),{host:a.dex.host,isLimit:n,sell:r,base:a.base.id,quote:a.quote.id,qty:ps(t.value||"",o),rate:ps(e.rateField.value||"",a.rateConversionFactor),tifnow:e.tifNow.checked||!1,options:{}}}},{key:"previewQuoteAmt",value:function(e){var t=this.page;if(this.market.base&&this.market.quote){var n=this.parseOrder(),r=this.adjustedRate();if(t.orderErr.textContent="",r&&(n.sell?this.preSell():this.preBuy()),this.depthLines.input=[],r&&this.isLimit()&&(this.depthLines.input=[{rate:n.rate/this.market.rateConversionFactor,color:n.sell?this.depthChart.theme.sellLine:this.depthChart.theme.buyLine}]),this.drawChartLines(),!e||!r||!n.qty)return t.orderPreview.textContent="",void this.drawChartLines();var a=Sn().assets[n.quote],o=n.qty*n.rate/Gn,s=br.formatCoinValue(o,this.market.quoteUnitInfo);t.orderPreview.textContent=vn(W,{total:s,asset:a.symbol.toUpperCase()}),this.isSell()?this.preSell():this.preBuy()}}},{key:"preSell",value:function(){var e=this,t=this.market,n=Sn().assets[t.base.id].wallet;n.balance.available<t.cfg.lotsize?this.setMaxOrder(null):t.maxSell?this.setMaxOrder(t.maxSell.swap):t.maxSellRequested||(t.maxSellRequested=!0,this.scheduleMaxEstimate("/api/maxsell",{},0,(function(r){t.maxSellRequested=!1,t.maxSell=r.maxSell,t.sellBalance=n.balance.available,e.setMaxOrder(r.maxSell.swap)})))}},{key:"preBuy",value:function(){var e=this,t=this.market,n=this.adjustedRate(),r=Sn().assets[t.quote.id].wallet;if(r){var a=t.cfg.lotsize*(n/Gn);if(r.balance.available<a)this.setMaxOrder(null);else if(t.maxBuys[n])this.setMaxOrder(t.maxBuys[n].swap);else{var o=Object.keys(t.maxBuys).length?350:0;this.scheduleMaxEstimate("/api/maxbuy",{rate:n},o,(function(r){t.maxBuys[n]=r.maxBuy,t.buyBalance=Sn().assets[t.quote.id].wallet.balance.available,e.setMaxOrder(r.maxBuy.swap)}))}}}},{key:"scheduleMaxEstimate",value:function(e,t,n,r){var a=this,s=this.page;this.maxLoaded||(this.maxLoaded=Sn().loading(s.maxOrd));var i=[this.market.base.id,this.market.quote.id],c=i[0],l=i[1],u=[Sn().assets[c].wallet,Sn().assets[l].wallet],d=u[0],h=u[1];if(d&&d.running&&h&&h.running){this.maxEstimateTimer&&window.clearTimeout(this.maxEstimateTimer),br.show(s.maxOrd,s.maxLotBox),br.hide(s.maxAboveZero),s.maxFromLots.textContent=vn(q),s.maxFromLotsLbl.textContent="",this.maxOrderUpdateCounter++;var p=this.maxOrderUpdateCounter;this.maxEstimateTimer=window.setTimeout(o(b().mark((function n(){var o;return b().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a.maxEstimateTimer=null,p===a.maxOrderUpdateCounter){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,Lr(e,zo({host:a.market.dex.host,base:c,quote:l},t));case 5:if(o=n.sent,p===a.maxOrderUpdateCounter){n.next=8;break}return n.abrupt("return");case 8:if(Sn().checkResponse(o)){n.next=13;break}return console.warn("max order estimate not available:",o),s.maxFromLots.textContent=vn(N),a.maxLoaded&&(a.maxLoaded(),a.maxLoaded=null),n.abrupt("return");case 13:r(o);case 14:case"end":return n.stop()}}),n)}))),n)}}},{key:"setMaxOrder",value:function(e){var t=this.page;this.maxLoaded&&(this.maxLoaded(),this.maxLoaded=null),br.show(t.maxOrd,t.maxLotBox,t.maxAboveZero);var n=this.isSell(),r=0;if(e&&(r=e.lots),t.maxFromLots.textContent=r.toString(),t.maxFromLotsLbl.textContent=vn(1===r?J:Z),e){var a=n?this.market.base:this.market.quote;t.maxFromAmt.textContent=br.formatCoinValue(e.value||0,a.unitInfo),t.maxFromTicker.textContent=a.symbol.toUpperCase()}else br.hide(t.maxAboveZero)}},{key:"validateOrder",value:function(e){var t=this.page;return e.isLimit&&!e.rate?(br.show(t.orderErr),t.orderErr.textContent=vn(U),!1):!!e.qty||(br.show(t.orderErr),t.orderErr.textContent=vn(V),!1)}},{key:"handleBook",value:function(e){var t,n=this.market,r=n.cfg,a=n.baseUnitInfo,o=n.quoteUnitInfo,s=n.baseCfg,i=n.quoteCfg;this.book=new Wo(e,s.symbol,i.symbol),this.loadTable();var c,l=jo(e.book.epoch||[]);try{for(l.s();!(c=l.n()).done;){var u=c.value;u.rate>0&&this.book.add(u),this.addTableOrder(u)}}catch(e){l.e(e)}finally{l.f()}if(!this.book)return this.depthChart.clear(),br.empty(this.page.buyRows),void br.empty(this.page.sellRows);br.show(this.page.epochLine),this.loadingAnimations.depth&&this.loadingAnimations.depth.stop(),this.depthChart.canvas.classList.remove("invisible"),this.depthChart.set(this.book,r.lotsize,r.ratestep,a,o),this.recentMatches=null!==(t=e.book.recentMatches)&&void 0!==t?t:[],this.refreshRecentMatchesTable()}},{key:"midGapConventional",value:function(){var e=this.midGap();if(!e)return e;var t=this.market,n=t.baseUnitInfo,r=t.quoteUnitInfo;return e*n.conventional.conversionFactor/r.conventional.conversionFactor}},{key:"midGap",value:function(){var e=this.book;if(e)return e.buys&&e.buys.length?e.sells&&e.sells.length?(e.buys[0].msgRate+e.sells[0].msgRate)/2/Gn:e.buys[0].msgRate/Gn:e.sells&&e.sells.length?e.sells[0].msgRate/Gn:null}},{key:"setMarketBuyOrderEstimate",value:function(){var e=this.market,t=e.cfg.lotsize,n=Sn().user.exchanges[e.dex.host].markets[e.sid].buybuffer,r=this.midGapConventional();r&&(this.page.minMktBuy.textContent=br.formatCoinValue(t*n*r,e.baseUnitInfo))}},{key:"maxUserOrderCount",value:function(){var e=this.market,t=e.dex.host,n=e.cfg.name;return Math.max(10,Sn().orders(t,n).length)}},{key:"loadUserOrders",value:(A=o(b().mark((function e(){var t,n,r,a,o,s,i,c,l,u,d,h,p;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s in t=this.market,n=t.base,r=t.quote,a=t.dex.host,o=t.cfg.name,this.metaOrders)delete this.metaOrders[s];if(n&&r){e.next=4;break}return e.abrupt("return",this.resolveUserOrders([]));case 4:if(!((i=Sn().orders(a,o)).length>=10)){e.next=7;break}return e.abrupt("return",this.resolveUserOrders(i));case 7:return c={hosts:[a],market:{baseID:n.id,quoteID:r.id},n:this.maxUserOrderCount()},e.next=10,Lr("/api/orders",c);case 10:l=e.sent,u=l.orders||[],d=jo(i),e.prev=13,p=b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=h.value,u.some((function(e){return e.id===t.id}))||u.push(t);case 2:case"end":return e.stop()}}),e)})),d.s();case 16:if((h=d.n()).done){e.next=20;break}return e.delegateYield(p(),"t0",18);case 18:e.next=16;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(13),d.e(e.t1);case 25:return e.prev=25,d.f(),e.finish(25);case 28:return e.abrupt("return",this.resolveUserOrders(l.orders||[]));case 29:case"end":return e.stop()}}),e,this,[[13,22,25,28]])}))),function(){return A.apply(this,arguments)})},{key:"refreshActiveOrders",value:function(){var e=Sn().orders(this.market.dex.host,hs(this.market.baseCfg.symbol,this.market.quoteCfg.symbol));return this.resolveUserOrders(e)}},{key:"resolveUserOrders",value:function(e){var t,n,r,a=this,o=this.page,s=this.metaOrders,i=this.market,c=i.cfg,l=function(e){return e.status<jn||Qn(e)},u=jo(e);try{for(u.s();!(r=u.n()).done;){var d=r.value;s[d.id]={ord:d}}}catch(e){u.e(e)}finally{u.f()}var h=Object.keys(s).map((function(e){return s[e]}));h.sort((function(e,t){var n=[l(e.ord),l(t.ord)],r=n[0],a=n[1];return r&&!a?-1:!r&&a?1:t.ord.submitTime-e.ord.submitTime}));var p=this.maxUserOrderCount();for(var f in h.length>p&&(h=h.slice(0,p)),s)delete s[f];br.empty(o.userOrders),br.setVis(null===(t=h)||void 0===t?void 0:t.length,o.userOrders),br.setVis(!(null!==(n=h)&&void 0!==n&&n.length),o.userNoOrders);var v,m=!1,g=jo(h);try{var y=function(){var e=v.value,t=o.userOrderTmpl.cloneNode(!0);o.userOrders.appendChild(t);var n=br.parseTemplate(t),r=br.parseTemplate(n.header),u=br.parseTemplate(n.details);e.div=t,e.header=r,e.details=u;var d,h=e.ord,p=h.id,f=l(h);p&&(s[p]=e),!h.readyToTick&&Qn(h)&&(n.header.classList.add("unready-user-order"),m=!0),r.sideLight.classList.add(h.sell?"sell":"buy"),f||r.sideLight.classList.add("inactive"),u.side.textContent=e.header.side.textContent=Kn(h),u.side.classList.add(h.sell?"sellcolor":"buycolor"),r.side.classList.add(h.sell?"sellcolor":"buycolor"),u.qty.textContent=e.header.qty.textContent=br.formatCoinValue(h.qty,i.baseUnitInfo),d=h.type===Vn?a.marketOrderRateString(h,i):br.formatRateFullPrecision(h.rate,i.baseUnitInfo,i.quoteUnitInfo,c.ratestep),u.rate.textContent=e.header.rate.textContent=d,r.baseSymbol.textContent=i.baseUnitInfo.conventional.unit,u.type.textContent=i.quoteUnitInfo.conventional.unit,a.updateMetaOrder(e),br.bind(t,"mouseenter",(function(){a.activeMarkerRate=h.rate,a.setDepthMarkers()}));var g,y=function(e){e.stopPropagation(),a.showCancel(t,p)},k=function(e){e.stopPropagation(),a.showAccelerate(h)};p?(ar(h)&&(br.show(u.cancelBttn),Go(u.cancelBttn,"click",(function(e){y(e)}))),Go(u.accelerateBttn,"click",(function(e){k(e)})),Sn().canAccelerateOrder(h)&&br.show(u.accelerateBttn),u.link.href="order/".concat(p),Sn().bindInternalNavigation(t)):(br.hide(u.accelerateBttn),br.hide(u.cancelBttn),br.hide(u.link)),br.bind(n.header,"click",(function(){if(br.isDisplayed(n.details))return br.hide(n.details),r.expander.classList.add("ico-arrowdown"),void r.expander.classList.remove("ico-arrowup");br.show(n.details),r.expander.classList.remove("ico-arrowdown"),r.expander.classList.add("ico-arrowup"),g&&g.remove()})),br.bind(n.header,"mouseenter",(function(){if(!br.isDisplayed(n.details)){g&&g.remove();var e=document.createElement("div");g=e,document.body.appendChild(e),e.className="user-order-floaty-menu";var r=br.layoutMetrics(n.header),s=r.bodyTop+r.height;e.style.top="".concat(s-1,"px"),e.style.left="".concat(r.bodyLeft,"px");var i=a.metaOrders[p].ord,c=function(t,n){var r=t.cloneNode(!0);e.appendChild(r),br.show(r),br.bind(r,"click",(function(e){n(e)}))};ar(i)&&c(u.cancelBttn,(function(e){y(e)})),Sn().canAccelerateOrder(i)&&c(u.accelerateBttn,(function(e){k(e)})),e.appendChild(u.link.cloneNode(!0));var l=o.orderScroller.scrollTop,d=function n(r){var a=o.orderScroller.scrollTop-l;e.style.top="".concat(s+a,"px"),br.mouseInElement(r,e)||br.mouseInElement(r,t)||(e.remove(),g=null,document.removeEventListener("mousemove",n),o.orderScroller.removeEventListener("scroll",n))};document.addEventListener("mousemove",d),o.orderScroller.addEventListener("scroll",d)}})),Sn().bindTooltips(t)};for(g.s();!(v=g.n()).done;)y()}catch(e){g.e(e)}finally{g.f()}br.setVis(m,o.unreadyOrdersMsg),this.setDepthMarkers()}},{key:"marketOrderRateString",value:function(e,t){var n;if(null===(n=e.matches)||void 0===n||!n.length)return vn(Xe);var r=br.formatRateFullPrecision(tr(e),t.baseUnitInfo,t.quoteUnitInfo,t.cfg.ratestep);return e.matches.length>1&&(r="~ "+r),r}},{key:"updateMetaOrder",value:function(e){var t=e.header,n=e.details,r=e.ord;r.status<=zn||Qn(r)?t.activeLight.classList.add("active"):t.activeLight.classList.remove("active"),n.status.textContent=t.status.textContent=Jn(r),n.age.textContent=br.timeSince(r.submitTime),n.filled.textContent="".concat((Zn(r)/r.qty*100).toFixed(1),"%"),n.settled.textContent="".concat(($n(r)/r.qty*100).toFixed(1),"%")}},{key:"setDepthMarkers",value:function(){for(var e={buys:[],sells:[]},t=this.market.rateConversionFactor,n=0,r=Object.values(this.metaOrders);n<r.length;n++){var a=r[n].ord;a.rate&&a.status===zn&&(a.sell?e.sells.push({rate:a.rate/t,active:a.rate===this.activeMarkerRate}):e.buys.push({rate:a.rate/t,active:a.rate===this.activeMarkerRate}))}this.depthChart.setMarkers(e),this.book&&this.depthChart.draw()}},{key:"updateTitle",value:function(){var e=this.midGapConventional(),t=this.market,n=t.baseUnitInfo.conventional.unit,r=t.quoteUnitInfo.conventional.unit;document.title=e?"".concat(br.formatCoinValue(e)," | ").concat(n).concat(r," | ").concat(this.ogTitle):"".concat(n).concat(r," | ").concat(this.ogTitle)}},{key:"handleBookRoute",value:function(e){Sn().log("book","handleBookRoute:",e);var t=e.payload,n=this.market,r=n.baseCfg,a=n.quoteCfg;t.base===r.id&&t.quote===a.id&&(this.handleBook(t),this.updateTitle(),this.baseUnits.forEach((function(e){br.empty(e),"noparent"===e.dataset.unitFormat?e.textContent=r.unitInfo.conventional.unit:e.appendChild(br.symbolize(r))})),this.quoteUnits.forEach((function(e){br.empty(e),"noparent"===e.dataset.unitFormat?e.textContent=a.unitInfo.conventional.unit:e.appendChild(br.symbolize(a))})),this.setMarketBuyOrderEstimate())}},{key:"handleBookOrderRoute",value:function(e){if(Sn().log("book","handleBookOrderRoute:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){var t=e.payload;t.rate>0&&this.book.add(t),this.addTableOrder(t),this.updateTitle(),this.depthChart.draw()}}},{key:"handleUnbookOrderRoute",value:function(e){if(Sn().log("book","handleUnbookOrderRoute:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){var t=e.payload;this.book.remove(t.token),this.removeTableOrder(t),this.updateTitle(),this.depthChart.draw()}}},{key:"handleUpdateRemainingRoute",value:function(e){if(Sn().log("book","handleUpdateRemainingRoute:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){var t=e.payload;this.book.updateRemaining(t.token,t.qty,t.qtyAtomic),this.updateTableOrder(t),this.depthChart.draw()}}},{key:"handleEpochOrderRoute",value:function(e){if(Sn().log("book","handleEpochOrderRoute:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){var t=e.payload;t.msgRate>0&&this.book.add(t),t.qtyAtomic>0&&this.addTableOrder(t),this.depthChart.draw()}}},{key:"handleCandlesRoute",value:function(e){if(this.candlesLoading&&(clearTimeout(this.candlesLoading.timer),this.candlesLoading.loaded(),this.candlesLoading=null),e.host===this.market.dex.host&&e.marketID===this.market.cfg.name){var t=e.payload.dur;this.market.candleCaches[t]=e.payload,this.setHighLow(),this.candleDur===t&&(this.loadingAnimations.candles&&this.loadingAnimations.candles.stop(),this.candleChart.canvas.classList.remove("invisible"),this.candleChart.setCandles(e.payload,this.market.cfg,this.market.baseUnitInfo,this.market.quoteUnitInfo))}}},{key:"handleEpochMatchSummary",value:function(e){this.addRecentMatches(e.payload.matchSummaries),this.refreshRecentMatchesTable()}},{key:"handleCandleUpdateRoute",value:function(e){if(e.host===this.market.dex.host){var t=e.payload,n=t.dur,r=t.candle,a=this.market.candleCaches[n];if(a){var o=a.candles;0===o.length?o.push(r):o[o.length-1].startStamp===r.startStamp?o[o.length-1]=r:o.push(r),this.candleDur===n&&this.candleChart.draw()}}}},{key:"showForm",value:(x=o(b().mark((function e(t){var n,r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentForm=t,n=this.page,br.hide.apply(br,Vr(Array.from(n.forms.children))),t.style.right="10000px",br.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,br.animate(500,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"showOpen",value:(w=o(b().mark((function e(t,n){var r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.page,this.openAsset=t,this.openFunc=n,this.unlockForm.refresh(Sn().assets[t.id]),this.showForm(r.unlockWalletForm),r.uwAppPass.focus();case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return w.apply(this,arguments)})},{key:"showToggleWalletStatus",value:function(e){var t=this.page;this.openAsset=e,br.hide(t.toggleWalletStatusErr,t.walletStatusDisable,t.disableWalletMsg),br.show(t.walletStatusEnable,t.enableWalletMsg),this.showForm(t.toggleWalletStatusConfirm)}},{key:"toggleWalletStatus",value:(k=o(b().mark((function e(){var t,n,r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,br.hide(t.toggleWalletStatusErr),n={assetID:this.openAsset.id,disable:!1},r=Sn().loading(t.toggleWalletStatusConfirm),e.next=7,Lr("/api/togglewalletstatus",n);case 7:if(a=e.sent,r(),Sn().checkResponse(a)){e.next=13;break}return t.toggleWalletStatusErr.textContent=a.msg,br.show(t.toggleWalletStatusErr),e.abrupt("return");case 13:br.hide(this.page.forms),this.balanceWgt.updateAsset(this.openAsset.id);case 15:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"showVerify",value:function(){this.preorderCache={};var e,t=this.page,n=this.currentOrder=this.parseOrder(),r=n.sell,a=Sn().assets[n.base],o=Sn().assets[n.quote],s=r?o:a,i=r?a:o,c=function(e){switch(e.dataset.icon){case"from":if(i.token){var t=Sn().assets[i.token.parentID];e.src=br.logoPath(t.symbol)}else e.src=br.logoPath(i.symbol);break;case"to":if(s.token){var n=Sn().assets[s.token.parentID];e.src=br.logoPath(n.symbol)}else e.src=br.logoPath(s.symbol)}},l=jo(br.applySelector(t.vDetailPane,"[data-icon]"));try{for(l.s();!(e=l.n()).done;)c(e.value)}catch(e){l.e(e)}finally{l.f()}var u,d=jo(br.applySelector(t.vFeeSummary,"[data-icon]"));try{for(d.s();!(u=d.n()).done;)c(u.value)}catch(e){d.e(e)}finally{d.f()}br.hide(t.vUnlockPreorder,t.vPreorderErr),br.show(t.vPreorder),t.vBuySell.textContent=vn(r?Se:Ae);var h=vn(r?P:M);if(t.vSideSubmit.textContent=h,t.vOrderHost.textContent=n.host,n.isLimit){br.show(t.verifyLimit),br.hide(t.verifyMarket);var p="Limit ".concat(h," Order");t.vOrderType.textContent=n.tifnow?p+" (immediate)":p,t.vRate.textContent=br.formatCoinValue(n.rate/this.market.rateConversionFactor),t.vQty.textContent=br.formatCoinValue(n.qty,a.unitInfo);var f=n.rate/Gn*n.qty;t.vTotal.textContent=br.formatCoinValue(f,o.unitInfo),this.showFiatValue(o.id,f,t.vFiatTotal)}else{br.hide(t.verifyLimit),br.show(t.verifyMarket),t.vOrderType.textContent="Market ".concat(h," Order");var v=n.sell?this.market.baseUnitInfo:this.market.quoteUnitInfo;t.vmFromTotal.textContent=br.formatCoinValue(n.qty,v),t.vmFromAsset.textContent=i.symbol.toUpperCase(),this.showFiatValue(i.id,n.qty,t.vmFromTotalFiat);var m=this.midGap();if(m){br.show(t.vMarketEstimate);var g=n.sell?n.qty*m:n.qty/m;t.vmToTotal.textContent=br.formatCoinValue(g,s.unitInfo),t.vmToAsset.textContent=s.symbol.toUpperCase(),this.showFiatValue(s.id,g,t.vmTotalFiat)}else br.hide(t.vMarketEstimate)}r?(t.vHeader.classList.add(rs),t.vHeader.classList.remove(ns),t.vSubmit.classList.add(rs),t.vSubmit.classList.remove(ns)):(t.vHeader.classList.add(ns),t.vHeader.classList.remove(rs),t.vSubmit.classList.add(ns),t.vSubmit.classList.remove(rs)),this.showVerifyForm(),t.vPass.focus(),a.wallet.open&&o.wallet.open?this.preOrder(n):(br.hide(t.vPreorder),Mr.passwordIsCached()?this.unlockWalletsForEstimates(""):br.show(t.vUnlockPreorder))}},{key:"showFiatValue",value:function(e,t,n){if(n){var r=Sn().fiatRatesMap[e];n.textContent=br.formatFiatConversion(t,r,Sn().unitInfo(e)),r?br.show(n.parentElement):br.hide(n.parentElement)}}},{key:"showVerifyForm",value:(y=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.page,br.hide(t.vErr),this.showForm(t.verifyForm);case 3:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"submitEstimateUnlock",value:(g=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page.vUnlockPass.value||"",e.next=3,this.unlockWalletsForEstimates(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"unlockWalletsForEstimates",value:(m=o(b().mark((function e(t){var n,r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,r=Sn().loading(n.verifyForm),e.next=4,this.attemptWalletUnlock(t);case 4:if(a=e.sent,r(),!a){e.next=8;break}return e.abrupt("return",this.setPreorderErr(a));case 8:br.show(n.vPreorder),br.hide(n.vUnlockPreorder),this.preOrder(this.parseOrder());case 11:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"attemptWalletUnlock",value:(v=o(b().mark((function e(t){var n,r,a,o,s,i,c,l,u;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.market,r=n.base,a=n.quote,o=[],r.wallet.open||o.push(r.id),a.wallet.open||o.push(a.id),s={pass:t,assetID:-1},i=0,c=o;case 6:if(!(i<c.length)){e.next=17;break}return l=c[i],s.assetID=l,e.next=11,Lr("/api/openwallet",s);case 11:if(u=e.sent,Sn().checkResponse(u)){e.next=14;break}return e.abrupt("return",u.msg);case 14:i++,e.next=6;break;case 17:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"fetchPreorder",value:(f=o(b().mark((function e(t){var n,r,a,o,s;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,r=JSON.stringify(t.options),!(a=this.preorderCache[r])){e.next=5;break}return e.abrupt("return",a);case 5:return br.hide(n.vPreorderErr),o=Sn().loading(n.verifyForm),e.next=9,Lr("/api/preorder",vs(t));case 9:if(s=e.sent,o(),Sn().checkResponse(s)){e.next=13;break}return e.abrupt("return",{err:s.msg});case 13:return this.preorderCache[r]=s.estimate,e.abrupt("return",s.estimate);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"setPreorderErr",value:function(e){var t=this.page;br.hide(t.vPreorder),br.show(t.vPreorderErr),t.vPreorderErrTip.dataset.tooltip=e}},{key:"showPreOrderAdvancedOptions",value:function(){var e=this.page;br.hide(e.showAdvancedOptions),br.show(e.hideAdvancedOptions,e.vOtherOrderOpts)}},{key:"hidePreOrderAdvancedOptions",value:function(){var e=this.page;br.hide(e.hideAdvancedOptions,e.vOtherOrderOpts),br.show(e.showAdvancedOptions)}},{key:"reloadOrderOpts",value:function(e,t,n,r){var a=this.page;br.empty(a.vDefaultOrderOpts,a.vOtherOrderOpts);var o,s=function(t,n){var o=function(e,t,n,r){var a,o,s=r&&t.sell||!r&&!t.sell,i=(a=t.host,o=s?t.base:t.quote,Sn().exchanges[a].assets[o].symbol);switch(!0){case!!e.boolean:return new Bn(e,i,t.options,n).node;case!!e.xyRange:return new On(e,i,t.options,n).node;default:console.error("no option type specified",e)}return console.error("unknown option type",e),document.createElement("div")}(t,e,r,n);t.showByDefault?a.vDefaultOrderOpts.appendChild(o):a.vOtherOrderOpts.appendChild(o)},i=jo(t.options||[]);try{for(i.s();!(o=i.n()).done;)s(o.value,!0)}catch(e){i.e(e)}finally{i.f()}var c,l=jo(n.options||[]);try{for(l.s();!(c=l.n()).done;)s(c.value,!1)}catch(e){l.e(e)}finally{l.f()}Sn().bindTooltips(a.vDefaultOrderOpts),Sn().bindTooltips(a.vOtherOrderOpts)}},{key:"preOrder",value:(p=o(b().mark((function e(t){var n,r,a=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.page,r=function(){var e=o(b().mark((function e(){var s,i,c,l,u;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.fetchPreorder(t);case 2:if(!(s=e.sent).err){e.next=5;break}return e.abrupt("return",a.setPreorderErr(s.err));case 5:i=s,br.hide(n.vPreorderErr),br.show(n.vPreorder),c=i.swap,l=i.redeem,c.options=c.options||[],l.options=l.options||[],a.setFeeEstimates(c,l,t),u=function(){var e=o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r();case 2:br.animate(400,(function(e){n.vFeeSummary.style.backgroundColor="rgba(128, 128, 128, ".concat(.5-.5*e,")")}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),br.bind(n.showAdvancedOptions,"click",(function(){a.showPreOrderAdvancedOptions()})),br.bind(n.hideAdvancedOptions,"click",(function(){a.hidePreOrderAdvancedOptions()})),a.reloadOrderOpts(t,c,l,u);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r();case 3:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"setFeeEstimates",value:function(e,t,n){var r=this.page,a=this.market;if(e.estimate&&t.estimate){br.show(r.vPreorderEstimates);var o=a.baseUnitInfo,s=a.quoteUnitInfo,i=a.rateConversionFactor,c=function(e){return e<.05?"< 0.1":os.format(e)},l=1,u=1,d=o,h=s;if(a.base.token){var p=Sn().assets[a.base.token.parentID];d=p.unitInfo;var f=Sn().fiatRatesMap[a.base.id],v=Sn().fiatRatesMap[p.id];l=f&&v?v/f*o.conventional.conversionFactor/p.unitInfo.conventional.conversionFactor:0}if(a.quote.token){var m=Sn().assets[a.quote.token.parentID];h=m.unitInfo;var g=Sn().fiatRatesMap[a.quote.id],y=Sn().fiatRatesMap[m.id];u=g&&y?y/g*s.conventional.conversionFactor/m.unitInfo.conventional.conversionFactor:0}var k=d,b=h,w=l,x=u;if(this.currentOrder.sell){var C=[k,b];b=C[0],k=C[1];var S=[w,x];x=S[0],w=S[1]}var A=e.estimate.value||0,F=x>0?A/x:A,E=e.estimate.realisticBestCase/F*100;r.vSwapFeesLowPct.textContent=x<=0?"":"(".concat(c(E),"%)"),r.vSwapFeesLow.textContent=br.formatCoinValue(e.estimate.realisticBestCase,b);var I=e.estimate.realisticWorstCase/F*100;r.vSwapFeesHighPct.textContent=x<=0?"":"(".concat(c(I),"%)"),r.vSwapFeesHigh.textContent=br.formatCoinValue(e.estimate.realisticWorstCase,b);var R=e.estimate.maxFees/F*100;r.vSwapFeesMaxPct.textContent=x<=0?"":"(".concat(c(R),"%)"),r.vSwapFeesMax.textContent=br.formatCoinValue(e.estimate.maxFees,b);var T=this.midGap()||n.rate/i,D=n.sell?A*T:A/T,M=w>0?D/w:D,P=t.estimate.realisticBestCase/M*100;r.vRedeemFeesLowPct.textContent=w<=0?"":"(".concat(c(P),"%)"),r.vRedeemFeesLow.textContent=br.formatCoinValue(t.estimate.realisticBestCase,k);var B=t.estimate.realisticWorstCase/M*100;r.vRedeemFeesHighPct.textContent=w<=0?"":"(".concat(c(B),"%)"),r.vRedeemFeesHigh.textContent=br.formatCoinValue(t.estimate.realisticWorstCase,k),l&&u?(br.show(r.vFeeSummaryPct),br.hide(r.vFeeSummary),r.vFeeSummaryLow.textContent=c(E+P),r.vFeeSummaryHigh.textContent=c(I+B)):(br.hide(r.vFeeSummaryPct),br.show(r.vFeeSummary),r.summarySwapFeesLow.textContent=r.vSwapFeesLow.textContent,r.summarySwapFeesHigh.textContent=r.vSwapFeesHigh.textContent,r.summaryRedeemFeesLow.textContent=r.vRedeemFeesLow.textContent,r.summaryRedeemFeesHigh.textContent=r.vRedeemFeesHigh.textContent)}else br.hide(r.vPreorderEstimates)}},{key:"submitCancel",value:(h=o(b().mark((function e(){var t,n,r,a,o,s;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=this.cancelData,r=n.order,a={orderID:r.id},o=Sn().loading(t.cancelSubmit),e.next=7,Lr("/api/cancel",a);case 7:if(s=e.sent,o(),Sn().checkResponse(s)){e.next=13;break}return t.cancelErr.textContent=s.msg,br.show(t.cancelErr),e.abrupt("return");case 13:br.hide(n.bttn,t.forms),r.cancelling=!0;case 15:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"showCancel",value:function(e,t){var n=this.metaOrders[t].ord,r=this.page,a=n.qty-n.filled,o=Yn(n)?this.market.quote:this.market.base;r.cancelRemain.textContent=br.formatCoinValue(a,o.unitInfo),r.cancelUnit.textContent=o.symbol.toUpperCase(),br.hide(r.cancelErr),this.showForm(r.cancelForm),this.cancelData={bttn:br.tmplElement(e,"cancelBttn"),order:n}}},{key:"showAccelerate",value:function(e){var t=Sn().loading(this.main);this.accelerateOrderForm.refresh(e),t(),this.showForm(this.page.accelerateForm)}},{key:"showCreate",value:function(e){var t=this.page;this.currentCreate=e,this.newWalletForm.setAsset(e.id),this.showForm(t.newWalletForm)}},{key:"stepSubmit",value:function(){var e=this.page,t=this.market;if(br.hide(e.orderErr),this.validateOrder(this.parseOrder())){var n=Sn().walletMap[t.base.id],r=Sn().walletMap[t.quote.id];return n?r?void this.showVerify():(e.orderErr.textContent=vn(z,{asset:t.quote.symbol}),void br.show(e.orderErr)):(e.orderErr.textContent=vn(z,{asset:t.base.symbol}),void br.show(e.orderErr))}}},{key:"showDeposit",value:(l=o(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.depositAddrForm.setAsset(t),this.showForm(this.page.deposit);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"handlePriceUpdate",value:function(e){this.market&&(e.host===this.market.dex.host&&e.spots[this.market.cfg.name]&&this.setCurrMarketPrice(),this.marketList.updateSpots(e))}},{key:"handleWalletState",value:(c=o(b().mark((function e(t){var n,r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.market){e.next=2;break}return e.abrupt("return");case 2:if(t.wallet.assetID===(null===(n=this.market.base)||void 0===n?void 0:n.id)||t.wallet.assetID===(null===(r=this.market.quote)||void 0===r?void 0:r.id)){e.next=4;break}return e.abrupt("return");case 4:this.setTokenApprovalVisibility(),this.resolveOrderFormVisibility();case 6:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"handleBondUpdate",value:(i=o(b().mark((function e(t){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.dex,this.market){e.next=3;break}return e.abrupt("return");case 3:if(n===this.market.dex.host){e.next=5;break}return e.abrupt("return");case 5:if("AccountRegistered"!==t.topic){e.next=8;break}return e.next=8,Sn().fetchUser();case 8:this.market.dex=Sn().exchanges[n],this.setRegistrationStatusVisibility();case 10:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"handleMatchNote",value:function(e){var t=this.metaOrders[e.orderID];if(!t)return this.refreshActiveOrders();if(t.ord.type===Vn&&0===e.match.status){var n=Sn().order(e.orderID);n&&(t.details.rate.textContent=t.header.rate.textContent=this.marketOrderRateString(n,this.market))}Sn().canAccelerateOrder(t.ord)?br.show(t.details.accelerateBttn):br.hide(t.details.accelerateBttn)}},{key:"handleOrderNote",value:function(e){var t=e.order,n=this.metaOrders[t.id],r="AsyncOrderFailure"===e.topic||"AsyncOrderSubmitted"===e.topic;if(!n||r||"OrderLoaded"===e.topic&&t.readyToTick)return this.refreshActiveOrders();var a=n.ord.status;n.ord=t,"MissedCancel"===e.topic&&br.show(n.details.cancelBttn),t.filled===t.qty&&br.hide(n.details.cancelBttn),Sn().canAccelerateOrder(t)?br.show(n.details.accelerateBttn):br.hide(n.details.accelerateBttn),this.updateMetaOrder(n),(a===_n&&t.status===zn||a===zn&&t.status>zn)&&this.setDepthMarkers()}},{key:"handleEpochNote",value:function(e){if(Sn().log("book","handleEpochNote:",e),this.market&&e.host===this.market.dex.host&&e.marketID===this.market.sid){this.book&&(this.book.setEpoch(e.epoch),this.depthChart.draw()),this.clearOrderTableEpochs();for(var t=0,n=Object.values(this.metaOrders);t<n.length;t++){var r=n[t],a=r.ord,o=r.details,s=r.header,i=e.epoch>a.epoch;switch(!0){case a.type===Un&&a.status===_n&&i:var c=0===a.tif?vn(j):vn(H);o.status.textContent=s.status.textContent=c,a.status=0===a.tif?jn:zn;break;case a.type===Vn&&a.status===_n:o.status.textContent=s.status.textContent=vn(j),a.status=jn}}}}},{key:"recentMatchesSortCompare",value:function(){var e=this;switch(this.recentMatchesSortKey){case"rate":return function(t,n){return e.recentMatchesSortDirection*(t.rate-n.rate)};case"qty":return function(t,n){return e.recentMatchesSortDirection*(t.qty-n.qty)};case"age":return function(t,n){return e.recentMatchesSortDirection*(t.stamp-n.stamp)}}}},{key:"refreshRecentMatchesTable",value:function(){var e=this.page,t=this.recentMatches;if(br.empty(e.recentMatchesLiveList),t){var n=this.recentMatchesSortCompare();t.sort(n);var r,a=jo(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=e.recentMatchesTemplate.cloneNode(!0),i=br.parseTemplate(s);Sn().bindTooltips(s),i.rate.textContent=br.formatCoinValue(o.rate/this.market.rateConversionFactor),i.qty.textContent=br.formatCoinValue(o.qty,this.market.baseUnitInfo),i.age.textContent=br.timeSince(o.stamp),i.age.dataset.sinceStamp=String(o.stamp),s.classList.add(o.sell?"sellcolor":"buycolor"),e.recentMatchesLiveList.append(s)}}catch(e){a.e(e)}finally{a.f()}}}},{key:"addRecentMatches",value:function(e){this.recentMatches=[].concat(Vr(e),Vr(this.recentMatches)).slice(0,100)}},{key:"handleBalanceNote",value:function(e){this.preorderCache={};var t=this.market;if(t&&t.dex&&t.dex.connectionStatus===bn.Connected){var n=this.balanceWgt;e.assetID!==n.base.id&&e.assetID!==n.quote.id||n.setBalanceVisibility(!0);var r=e.balance.available;switch(e.assetID){case t.baseCfg.id:if(!t.maxSell)break;"number"==typeof t.sellBalance&&t.sellBalance!==r&&(t.maxSell=null),this.isSell()&&this.preSell();break;case t.quoteCfg.id:if(!Object.keys(t.maxBuys).length)break;"number"==typeof t.buyBalance&&t.buyBalance!==r&&(t.maxBuys={}),this.isSell()||this.preBuy()}}}},{key:"submitOrder",value:(a=o(b().mark((function e(){var t,n,r,a,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,br.hide(t.orderErr,t.vErr),n=this.currentOrder,r=t.vPass.value,t.vPass.value="",a={order:vs(n),pw:r},this.validateOrder(n)){e.next=8;break}return e.abrupt("return");case 8:return t.vSubmit.classList.add("d-hide"),t.vLoader.classList.remove("d-hide"),e.next=12,Lr("/api/tradeasync",a);case 12:if(o=e.sent,t.vSubmit.classList.remove("d-hide"),t.vLoader.classList.add("d-hide"),Sn().checkResponse(o)){e.next=19;break}return t.vErr.textContent=o.msg,br.show(t.vErr),e.abrupt("return");case 19:br.hide(t.forms),this.refreshActiveOrders();case 21:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"createWallet",value:(r=o(b().mark((function e(){var t,n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sn().fetchUser();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:n=t.assets[this.currentCreate.id],br.hide(this.page.forms),this.balanceWgt.updateAsset(n.id),br.setVis(!(this.market.base.wallet&&this.market.quote.wallet),this.page.noWallet),this.resolveOrderFormVisibility();case 10:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"walletUnlocked",value:(n=o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:br.hide(this.page.forms),this.balanceWgt.updateAsset(this.openAsset.id);case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"lotChanged",value:function(){var e=this.page,t=parseInt(e.lotField.value||"0");if(t<=0)return e.lotField.value="0",e.qtyField.value="",void this.previewQuoteAmt(!1);var n=this.market.cfg.lotsize;e.lotField.value=String(t),e.qtyField.value=String(t*n/this.market.baseUnitInfo.conventional.conversionFactor),this.previewQuoteAmt(!0)}},{key:"quantityChanged",value:function(e){var t=this.page,n=this.parseOrder();if(n.qty<0)return t.lotField.value="0",t.qtyField.value="",void this.previewQuoteAmt(!1);var r=this.market.cfg.lotsize,a=Math.floor(n.qty/r),o=a*r;t.lotField.value=String(a),(n.isLimit||n.sell)&&(e&&(t.qtyField.value=String(o/this.market.baseUnitInfo.conventional.conversionFactor)),this.previewQuoteAmt(!0))}},{key:"marketBuyChanged",value:function(){var e=this.page,t=ps(e.mktBuyField.value||"",this.market.quoteUnitInfo.conventional.conversionFactor),n=this.midGap();if(!n||!t)return e.mktBuyLots.textContent="0",void(e.mktBuyScore.textContent="0");var r=this.market.cfg.lotsize,a=t/n;e.mktBuyLots.textContent=(a/r).toFixed(1),e.mktBuyScore.textContent=br.formatCoinValue(a,this.market.baseUnitInfo)}},{key:"rateFieldChanged",value:function(){var e=this.adjustedRate();if(e<=0)return this.depthLines.input=[],this.drawChartLines(),void(this.page.rateField.value="0");var t=this.parseOrder(),n=e/this.market.rateConversionFactor;this.page.rateField.value=String(n),this.depthLines.input=[{rate:n,color:t.sell?this.depthChart.theme.sellLine:this.depthChart.theme.buyLine}],this.drawChartLines(),this.previewQuoteAmt(!0)}},{key:"adjustedRate",value:function(){var e=this.page.rateField.value;if(!e)return NaN;var t=ps(e,this.market.rateConversionFactor);return t-t%this.market.cfg.ratestep}},{key:"loadTable",value:function(){this.loadTableSide(!0),this.loadTableSide(!1)}},{key:"binOrdersByRateAndEpoch",value:function(e){if(!e||!e.length)return[];var t=[],n=[],r=[],a=e[0].msgRate;e[0].epoch?n.push(e[0]):r.push(e[0]);for(var o=1;o<e.length;o++)e[o].msgRate!==a&&(t.push(r),t.push(n),n=[],r=[],a=e[o].msgRate),e[o].epoch?n.push(e[o]):r.push(e[o]);return t.push(r),t.push(n),t.filter((function(e){return e.length>0}))}},{key:"loadTableSide",value:function(e){var t=this,n=e?this.book.sells:this.book.buys,r=e?this.page.sellRows:this.page.buyRows;br.empty(r),n&&n.length&&this.binOrdersByRateAndEpoch(n).forEach((function(e){r.appendChild(t.orderTableRow(e))}))}},{key:"addTableOrder",value:function(e){var t=e.sell?this.page.sellRows:this.page.buyRows,n=t.firstChild;if(0!==e.rate){for(n&&0===n.manager.getRate()&&(n=n.nextSibling);n;){if(0===n.manager.compare(e))return void n.manager.insertOrder(e);if(n.manager.compare(e)>0){var r=this.orderTableRow([e]);return void t.insertBefore(r,n)}n=n.nextSibling}var a=this.orderTableRow([e]);t.appendChild(a)}else{if(0===e.qtyAtomic)return;n&&0===n.manager.getRate()?n.manager.insertOrder(e):(n=this.orderTableRow([e]),t.insertBefore(n,t.firstChild))}}},{key:"removeTableOrder",value:function(e){for(var t=e.token,n=0,r=[this.page.sellRows,this.page.buyRows];n<r.length;n++)for(var a=r[n],o=0,s=Array.from(a.children);o<s.length;o++)if(s[o].manager.removeOrder(t))return}},{key:"updateTableOrder",value:function(e){for(var t=0,n=[this.page.sellRows,this.page.buyRows];t<n.length;t++)for(var r=n[t],a=0,o=Array.from(r.children);a<o.length;a++)if(o[a].manager.updateOrderQty(e))return}},{key:"clearOrderTableEpochs",value:function(){this.clearOrderTableEpochSide(this.page.sellRows),this.clearOrderTableEpochSide(this.page.buyRows)}},{key:"clearOrderTableEpochSide",value:function(e){for(var t=0,n=Array.from(e.children);t<n.length;t++)n[t].manager.removeEpochOrders()}},{key:"orderTableRow",value:function(e){var t=this,n=this.page.rowTemplate.cloneNode(!0),r=this.market,a=r.baseUnitInfo,o=r.quoteUnitInfo,s=r.rateConversionFactor,i=r.cfg.ratestep,c=new ms(n,e,a,o,i);return n.manager=c,Go(n,"click",(function(){t.reportDepthClick(n.manager.getRate()/s)})),0!==n.manager.getRate()&&br.bind(n,"mouseenter",(function(){var e=t.depthChart;t.depthLines.hover=[{rate:n.manager.getRate()/s,color:n.manager.isSell()?e.theme.sellLine:e.theme.buyLine}],t.drawChartLines()})),n}},{key:"handleConnNote",value:(t=o(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.marketList.setConnectionStatus(t),t.connectionStatus!==bn.Connected){e.next=6;break}return e.next=4,Sn().fetchUser();case 4:return e.next=6,Sn().loadPage("markets");case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"filterMarkets",value:function(){var e,t=null===(e=this.page.marketSearchV1.value)||void 0===e?void 0:e.toLowerCase(),n=t?function(e){return e.name.includes(t)}:function(){return!0};this.marketList.setFilter(n)}},{key:"drawChartLines",value:function(){this.depthChart.setLines([].concat(Vr(this.depthLines.hover),Vr(this.depthLines.input))),this.depthChart.draw()}},{key:"candleDurationSelected",value:function(e){var t,n;null!==(t=this.market)&&void 0!==t&&null!==(n=t.dex)&&void 0!==n&&n.candleDurs.includes(e)||(e="1h"),this.candleDur=e,this.loadCandles(),Mr.storeLocal(Mr.lastCandleDurationLK,e)}},{key:"loadCandles",value:function(){var e,t=jo(br.kids(this.page.durBttnBox));try{for(t.s();!(e=t.n()).done;){var n=e.value;n.textContent===this.candleDur?n.classList.add("selected"):n.classList.remove("selected")}}catch(e){t.e(e)}finally{t.f()}var r=this.market,a=r.candleCaches,o=r.cfg,s=r.baseUnitInfo,i=r.quoteUnitInfo,c=a[this.candleDur];c?this.candleChart.setCandles(c,o,s,i):this.requestCandles()}},{key:"requestCandles",value:function(e){var t=this;this.candlesLoading={loaded:function(){},timer:window.setTimeout((function(){t.candlesLoading&&(t.candlesLoading=null,console.error("candles not received"))}),1e4)};var n=this.market,r=n.dex,a=n.baseCfg,o=n.quoteCfg;Vo.request("loadcandles",{host:r.host,base:a.id,quote:o.id,dur:e||this.candleDur})}},{key:"unload",value:function(){Vo.request("unmarket",{}),Vo.deregisterRoute(Ko),Vo.deregisterRoute(Xo),Vo.deregisterRoute(Yo),Vo.deregisterRoute(Qo),Vo.deregisterRoute(Jo),Vo.deregisterRoute(Zo),Vo.deregisterRoute($o),this.depthChart.unattach(),this.candleChart.unattach(),br.unbind(document,"keyup",this.keyup),clearInterval(this.secondTicker)}}]),K}(Pr),cs=function(){function e(t){s(this,e),d(this,"div",void 0),d(this,"rowTmpl",void 0),d(this,"markets",void 0),d(this,"selected",void 0),this.div=t,this.rowTmpl=br.idel(t,"marketTmplV1"),br.cleanTemplates(this.rowTmpl),this.reloadMarketsPane()}return u(e,[{key:"updateSpots",value:function(e){var t,n=jo(this.markets);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.mkt.xc.host===e.host){var a=Sn().exchanges[r.mkt.xc.host],o=a.markets[r.mkt.name];gs(r.tmpl,a,o)}}}catch(e){n.e(e)}finally{n.f()}}},{key:"reloadMarketsPane",value:function(){br.empty(this.div),this.markets=[];for(var e,t,n,r,a,o=0,s=function(){for(var e=[],t=Sn().assets,n=function(e,n){return n.map((function(n){var r=t[n.baseid],a=r?r.name:n.basesymbol,o=Sn().unitInfo(n.baseid,e);return Object.assign({xc:e,baseName:a,bui:o},n)}))},r=0,a=Object.values(Sn().exchanges);r<a.length;r++){var o=a[r];e.push.apply(e,Vr(n(o,Object.values(o.markets||{}))))}return e.sort((function(e,t){if(!e.spot)return t.spot?1:e.name===t.name?e.xc.host.localeCompare(t.xc.host):e.name.localeCompare(t.name);if(!t.spot)return-1;var n=e.spot.vol24/e.lotsize;return t.spot.vol24/t.lotsize-n})),e}();o<s.length;o++){var i=s[o];this.markets.push((e=i,void 0,void 0,void 0,void 0,t=Sn().unitInfo(e.baseid,e.xc),n=Sn().unitInfo(e.quoteid,e.xc),r=Gn/t.conventional.conversionFactor*n.conventional.conversionFactor,a=new ls(this.rowTmpl,e,r),this.div.appendChild(a.node),a))}Sn().bindTooltips(this.div)}},{key:"find",value:function(e,t,n){var r,a=jo(this.markets);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.mkt.xc.host===e&&o.mkt.baseid===t&&o.mkt.quoteid===n)return o}}catch(e){a.e(e)}finally{a.f()}return null}},{key:"exists",value:function(e,t,n){return null!==this.find(e,t,n)}},{key:"first",value:function(){return this.markets[0]}},{key:"select",value:function(e,t,n){var r=this.find(e,t,n);if(!r)return console.error("select: no market row for ".concat(e,", ").concat(t,"-").concat(n));var a,o=jo(this.markets);try{for(o.s();!(a=o.n()).done;)a.value.node.classList.remove("selected")}catch(e){o.e(e)}finally{o.f()}this.selected=r,this.selected.node.classList.add("selected")}},{key:"setConnectionStatus",value:function(e){var t,n=jo(this.markets);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.mkt.xc.host===e.host&&(e.connectionStatus===bn.Connected?br.hide(r.tmpl.disconnectedIco):br.show(r.tmpl.disconnectedIco))}}catch(e){n.e(e)}finally{n.f()}}},{key:"setFilter",value:function(e){var t,n=jo(this.markets);try{for(n.s();!(t=n.n()).done;){var r=t.value;e(r)?br.show(r.node):br.hide(r.node)}}catch(e){n.e(e)}finally{n.f()}}}]),e}(),ls=u((function e(t,n,r){s(this,e),d(this,"node",void 0),d(this,"mkt",void 0),d(this,"name",void 0),d(this,"baseID",void 0),d(this,"quoteID",void 0),d(this,"lotSize",void 0),d(this,"tmpl",void 0),d(this,"rateConversionFactor",void 0),this.mkt=n,this.name=n.name,this.baseID=n.baseid,this.quoteID=n.quoteid,this.lotSize=n.lotsize,this.rateConversionFactor=r,this.node=t.cloneNode(!0);var a,o,i,c,l=this.tmpl=br.parseTemplate(this.node);l.baseIcon.src=br.logoPath(n.basesymbol),l.quoteIcon.src=br.logoPath(n.quotesymbol),l.baseSymbol.appendChild(br.symbolize(n.xc.assets[n.baseid],!0)),l.quoteSymbol.appendChild(br.symbolize(n.xc.assets[n.quoteid],!0)),l.baseName.textContent=n.baseName,l.host.textContent=n.xc.host,l.host.style.color=(i=n.xc.host,(c=Object.keys(Sn().exchanges)).sort(),a=c.indexOf(i),o=ys[a%ys.length],"hsl(".concat(360*o,", 35%, 50%)")),l.host.dataset.tooltip=n.xc.host,gs(l,n.xc,n),this.mkt.xc.connectionStatus!==bn.Connected&&br.show(l.disconnectedIco)})),us=function(){function e(t,n){var r=this;s(this,e),d(this,"base",void 0),d(this,"quote",void 0),d(this,"dex",void 0),br.hide(t,n);var a=br.parseTemplate(t);this.base={id:0,parentID:ss,cfg:null,node:t,tmpl:a,iconBox:a.walletState,stateIcons:new Cr(a.walletState)},a.balanceRowTmpl.remove();var o=br.parseTemplate(n);this.quote={id:0,parentID:ss,cfg:null,node:n,tmpl:o,iconBox:o.walletState,stateIcons:new Cr(o.walletState)},o.balanceRowTmpl.remove(),Sn().registerNoteFeeder({balance:function(e){r.updateAsset(e.assetID)},walletstate:function(e){r.updateAsset(e.wallet.assetID)},createwallet:function(e){r.updateAsset(e.assetID)}})}return u(e,[{key:"setBalanceVisibility",value:function(e){e?br.show(this.base.node,this.quote.node):br.hide(this.base.node,this.quote.node)}},{key:"setWallets",value:function(e,t,n){var r=function(e){var t=Sn().assets[e];return null!=t&&t.token?t.token.parentID:ss};this.dex=Sn().user.exchanges[e],this.base.id=t,this.base.parentID=r(t),this.base.cfg=this.dex.assets[t],this.quote.id=n,this.quote.parentID=r(n),this.quote.cfg=this.dex.assets[n],this.updateWallet(this.base),this.updateWallet(this.quote),this.setBalanceVisibility(this.dex.connectionStatus===bn.Connected)}},{key:"updateWallet",value:function(e){var t=e.cfg,n=e.tmpl,r=e.iconBox,a=e.stateIcons,o=e.id;if(t){var s=Sn().assets[o];if(br.hide(n.newWalletRow,n.expired,n.unsupported,n.connect,n.spinner,n.walletState,n.balanceRows,n.walletAddr),n.logo.src=br.logoPath(t.symbol),n.addWalletSymbol.textContent=t.symbol.toUpperCase(),br.empty(n.symbol),n.symbol.appendChild(br.symbolize(Sn().assets[o],!0)),s){br.show(r);var i=s.wallet;if(a.readWallet(i),!i)return s.walletCreationPending?void br.show(n.spinner):void br.show(n.newWalletRow);br.show(n.walletAddr);var c=i.balance;if(c||i.running||i.disabled){if(!c)return Sn().fetchBalance(o),void br.show(n.spinner);br.show(n.balanceRows),br.empty(n.balanceRows);var l=function(t,r,a,o){var s=n.balanceRowTmpl.cloneNode(!0);n.balanceRows.appendChild(s);var i=br.parseTemplate(s);i.title.textContent=t,i.bal.textContent=br.formatCoinValue(r,a),o&&(i.bal.append(o),e.parentBal=i.bal)};if(l(vn(Re),c.available,s.unitInfo),l(vn(Te),c.locked+c.contractlocked+c.bondlocked,s.unitInfo),l(vn(De),c.immature,s.unitInfo),s.token){var u=Sn().assets[s.token.parentID],d=u.wallet.balance,h=u.unitInfo,p=u.symbol,f=document.createElement("img");f.src=br.logoPath(p),f.classList.add("micro-icon","ms-1"),l(vn(Me),d.available,h,f)}(new Date).getTime()-new Date(c.stamp).getTime()>36e5&&!i.disabled?(br.show(n.expired),i.running&&Sn().fetchBalance(o)):br.hide(n.expired)}else br.show(n.connect)}else br.show(n.unsupported)}}},{key:"updateParent",value:function(e){var t,n=Sn().assets[e.parentID],r=n.wallet.balance,a=n.unitInfo;null!==(t=e.parentBal)&&void 0!==t&&t.firstChild&&(e.parentBal.firstChild.textContent=br.formatCoinValue(r.available,a))}},{key:"updateAsset",value:function(e){e===this.base.id?this.updateWallet(this.base):e===this.quote.id&&this.updateWallet(this.quote),e===this.base.parentID&&this.updateParent(this.base),e===this.quote.parentID&&this.updateParent(this.quote)}}]),e}();function ds(e,t,n){return{host:e,base:t,quote:n}}function hs(e,t){return"".concat(e,"_").concat(t)}function ps(e,t){return e?Math.round(parseFloat(e)*t):0}function fs(e,t){e.classList.remove("selected"),t.classList.add("selected")}function vs(e){for(var t={},n=0,a=Object.entries(e.options);n<a.length;n++){var o=r(a[n],2),s=o[0],i=o[1];t[s]=JSON.stringify(i)}return Object.assign({},e,{options:t})}var ms=function(){function e(t,n,r,a,o){s(this,e),d(this,"tableRow",void 0),d(this,"orderBin",void 0),d(this,"sell",void 0),d(this,"msgRate",void 0),d(this,"epoch",void 0),d(this,"baseUnitInfo",void 0),this.tableRow=t,this.orderBin=n,this.sell=n[0].sell,this.msgRate=n[0].msgRate,this.epoch=!!n[0].epoch,this.baseUnitInfo=r;var i=br.formatRateFullPrecision(this.msgRate,r,a,o);this.setRateEl(i),this.setEpochEl(),this.updateQtyNumOrdersEl()}return u(e,[{key:"setEpochEl",value:function(){var e=br.tmplElement(this.tableRow,"epoch");this.isEpoch()&&e.appendChild(es.cloneNode())}},{key:"setRateEl",value:function(e){var t=br.tmplElement(this.tableRow,"rate");if(0===this.msgRate)t.innerText="market";else{var n=this.isSell()?"sellcolor":"buycolor";t.innerText=e,t.classList.add(n)}}},{key:"updateQtyNumOrdersEl",value:function(){var e=this.orderBin.reduce((function(e,t){return e+t.qtyAtomic}),0),t=this.orderBin.length,n=br.tmplElement(this.tableRow,"qty"),r=br.tmplElement(this.tableRow,"numorders");n.innerText=br.formatFullPrecision(e,this.baseUnitInfo),t>1?(r.removeAttribute("hidden"),r.innerText=String(t),r.title="quantity is comprised of ".concat(t," orders")):r.setAttribute("hidden","true")}},{key:"insertOrder",value:function(e){this.orderBin.push(e),this.updateQtyNumOrdersEl()}},{key:"updateOrderQty",value:function(e){for(var t=e.token,n=e.qty,r=e.qtyAtomic,a=0;a<this.orderBin.length;a++)if(this.orderBin[a].token===t)return this.orderBin[a].qty=n,this.orderBin[a].qtyAtomic=r,this.updateQtyNumOrdersEl(),!0;return!1}},{key:"removeOrder",value:function(e){var t=this.orderBin.findIndex((function(t){return t.token===e}));return!(t<0||(this.orderBin.splice(t,1),this.orderBin.length?this.updateQtyNumOrdersEl():this.tableRow.remove(),0))}},{key:"removeEpochOrders",value:function(e){this.orderBin=this.orderBin.filter((function(t){return!(t.epoch&&t.epoch!==e)})),this.orderBin.length?this.updateQtyNumOrdersEl():this.tableRow.remove()}},{key:"getRate",value:function(){return this.msgRate}},{key:"isEpoch",value:function(){return this.epoch}},{key:"isSell",value:function(){return this.sell}},{key:"compare",value:function(e){return this.getRate()===e.msgRate&&this.isEpoch()===!!e.epoch?0:this.getRate()!==e.msgRate?this.getRate()>e.msgRate===e.sell?1:-1:this.isEpoch()?1:-1}}]),e}();function gs(e,t,n){if(n.spot){e.price.textContent=br.formatFourSigFigs(Sn().conventionalRate(n.baseid,n.quoteid,n.spot.rate,t));var r=n.spot.change24>0?"+":"";e.change.classList.remove("buycolor","sellcolor"),e.change.classList.add(n.spot.change24>=0?"buycolor":"sellcolor"),e.change.textContent="".concat(r).concat((100*n.spot.change24).toFixed(1),"%")}}var ys=[.5,1/4,3/4,1/8,5/8,3/8,7/8];function ks(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return bs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bs(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function bs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ws=function(e){En(p,e);var t,n,r,a,i,c,l,h=(c=p,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rn(c);if(l){var n=Rn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return In(this,e)});function p(e){var t;s(this,p),d(An(t=h.call(this)),"main",void 0),d(An(t),"offset",void 0),d(An(t),"loading",void 0),d(An(t),"currentForm",void 0),d(An(t),"orderTmpl",void 0),d(An(t),"filterState",void 0),d(An(t),"page",void 0),t.main=e,t.offset="",t.loading=!1;var n=t.page=br.idDescendants(e);t.orderTmpl=n.rowTmpl,t.orderTmpl.remove();var r=t.filterState={hosts:[],assets:[],statuses:[]},a=new URLSearchParams(window.location.search),o=function(e,t){var n=a.get(t);if(n&&0!==n.length){var o=n.split(",");n&&(r[t]=o),e.querySelectorAll("input").forEach((function(e){o.indexOf(e.value)>=0&&(e.checked=!0)}))}};o(n.hostFilter,"hosts"),o(n.assetFilter,"assets"),o(n.statusFilter,"statuses");var i=[],c=function(e,n){var a=e.querySelector(".apply-bttn");i.push(a),br.bind(a,"click",(function(){t.submitFilter(),i.forEach((function(e){return br.hide(e)}))})),e.querySelectorAll("input").forEach((function(t){br.bind(t,"change",(function(){!function(e,t){if(e.length!==t.length)return!1;var n,r=ks(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(-1===t.indexOf(a))return!1}}catch(e){r.e(e)}finally{r.f()}return!0}(xs(e),r[n])?br.show(a):br.hide(a)}))}))};return c(n.hostFilter,"hosts"),c(n.assetFilter,"assets"),c(n.statusFilter,"statuses"),br.bind(t.main,"scroll",(function(){t.loading||n.ordersTable.offsetHeight-t.main.offsetHeight-t.main.scrollTop<0&&t.nextPage()})),n.forms.querySelectorAll(".form-closer").forEach((function(e){br.bind(e,"click",(function(){br.hide(n.forms)}))})),br.bind(n.forms,"mousedown",(function(e){br.mouseInElement(e,t.currentForm)||br.hide(n.forms)})),br.bind(n.exportOrders,"click",(function(){t.exportOrders()})),n.showArchivedDateField.addEventListener("change",(function(){n.showArchivedDateField.checked?br.show(n.archivedDateField):br.hide(n.archivedDateField,n.deleteArchivedRecordsErr)})),br.bind(n.deleteArchivedRecords,"click",(function(){var e=t.page;e.showArchivedDateField.checked=!1,e.saveMatchesToFile.checked=!1,e.saveOrdersToFile.checked=!1,e.deleteArchivedRecordsErr.textContent="",e.archivedRecordsLocation.textContent="",e.deleteArchivedRecordsMsg.textContent="",br.hide(e.deleteArchivedResult,e.deleteArchivedRecordsErr,e.deleteArchivedRecordsMsg,e.archivedRecordsLocation,e.archivedDateField),t.showForm(e.deleteArchivedRecordsForm)})),br.bind(n.deleteArchivedRecordsSubmit,"click",(function(){var e=0;n.showArchivedDateField.checked&&(e=Date.parse(n.olderThan.value||""),isNaN(e)||e<=0)?br.showFormError(n.deleteArchivedRecordsErr,vn(qe)):t.deleteArchivedRecords(e)})),t.submitFilter(),t}return u(p,[{key:"showForm",value:(i=o(b().mark((function e(t){var n,r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentForm=t,n=this.page,br.hide(n.deleteArchivedRecordsForm),t.style.right="10000px",br.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,br.animate(500,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0px";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"setOrders",value:function(e){br.empty(this.page.tableBody),this.appendOrders(e)}},{key:"appendOrders",value:function(e){var t,n=this.page.tableBody,r=ks(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,o=this.orderTmpl.cloneNode(!0),s=br.parseTemplate(o),i=void 0,c=void 0,l=void 0,u=void 0,d=void 0,h="",p=Sn().exchanges[a.host]||void 0,f=[Sn().unitInfo(a.baseID,p),Sn().unitInfo(a.quoteID,p)],v=f[0],m=f[1];if(a.sell){var g=[a.baseSymbol,a.quoteSymbol];i=g[0],c=g[1];var y=[v.conventional.unit,m.conventional.unit];l=y[0],u=y[1],d=br.formatCoinValue(a.qty,v),a.type===Un&&(h=br.formatCoinValue(a.qty/Gn*a.rate,m))}else{var k=[a.quoteSymbol,a.baseSymbol];i=k[0],c=k[1];var b=[m.conventional.unit,v.conventional.unit];l=b[0],u=b[1],a.type===Vn?d=br.formatCoinValue(a.qty,v):(d=br.formatCoinValue(a.qty/Gn*a.rate,m),h=br.formatCoinValue(a.qty,v))}var w="".concat(v.conventional.unit,"-").concat(m.conventional.unit);s.host.textContent="".concat(w," @ ").concat(a.host),s.fromQty.textContent=d,s.fromLogo.src=br.logoPath(i),s.fromSymbol.textContent=l,s.toQty.textContent=h,s.toLogo.src=br.logoPath(c),s.toSymbol.textContent=u,s.type.textContent="".concat(Xn(a)," ").concat(Kn(a));var x=br.formatCoinValue(Sn().conventionalRate(a.baseID,a.quoteID,a.rate,p));a.type===Vn&&(x=er(a)),s.rate.textContent=x,s.status.textContent=Jn(a),s.filled.textContent="".concat((Zn(a)/a.qty*100).toFixed(1),"%"),s.settled.textContent="".concat(($n(a)/a.qty*100).toFixed(1),"%");var C=new Date(a.submitTime).toLocaleString();s.time.textContent="".concat(br.timeSince(a.submitTime)," ago, ").concat(C),br.tmplElement(o,"link").href="order/".concat(a.id),Sn().bindInternalNavigation(o),n.appendChild(o)}}catch(e){r.e(e)}finally{r.f()}50===e.length?this.offset=e[e.length-1].id:this.offset=""}},{key:"submitFilter",value:(a=o(b().mark((function e(){var t,n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,this.offset="",(n=this.filterState).hosts=xs(t.hostFilter),n.assets=xs(t.assetFilter).map((function(e){return parseInt(e)})),n.statuses=xs(t.statusFilter).map((function(e){return parseInt(e)})),e.t0=this,e.next=9,this.fetchOrders();case 9:e.t1=e.sent,e.t0.setOrders.call(e.t0,e.t1);case 11:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"fetchOrders",value:(r=o(b().mark((function e(){var t,n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Sn().loading(this.main),e.next=3,Lr("/api/orders",this.currentFilter());case 3:return n=e.sent,t(),e.abrupt("return",n.orders);case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"exportOrders",value:function(){this.offset="";var e=this.currentFilter(),t=new URL(window.location.href),n=new URLSearchParams(""),r=function(t){e[t].forEach((function(e){n.append(t,e)}))};r("hosts"),r("assets"),r("statuses"),t.search=n.toString(),t.pathname="/orders/export",window.open(t.toString())}},{key:"deleteArchivedRecords",value:(n=o(b().mark((function e(t){var n,r,a,o,s,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,r=n.saveMatchesToFile.checked||!1,a=n.saveOrdersToFile.checked||!1,o={olderThanMs:t,saveMatchesToFile:r,saveOrdersToFile:a},s=Sn().loading(this.main),e.next=7,Lr("/api/deletearchivedrecords",o);case 7:if(i=e.sent,s(),Sn().checkResponse(i)){e.next=11;break}return e.abrupt("return",br.showFormError(n.deleteArchivedRecordsErr,i.msg));case 11:i.archivedRecordsDeleted>0?(n.deleteArchivedRecordsMsg.textContent=vn(Ue,{nRecords:i.archivedRecordsDeleted}),(r||a)&&(n.archivedRecordsLocation.textContent=vn(Ve,{path:i.archivedRecordsPath}),br.show(n.archivedRecordsLocation)),this.submitFilter()):n.deleteArchivedRecordsMsg.textContent=vn(Ne),br.show(n.deleteArchivedResult,n.deleteArchivedRecordsMsg);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"currentFilter",value:function(){var e,t,n=this.filterState;return{hosts:n.hosts,assets:null===(e=n.assets)||void 0===e?void 0:e.map((function(e){return parseInt(e)})),statuses:null===(t=n.statuses)||void 0===t?void 0:t.map((function(e){return parseInt(e)})),n:50,offset:this.offset}}},{key:"nextPage",value:(t=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.offset&&!this.loading){e.next=2;break}return e.abrupt("return");case 2:return this.loading=!0,br.show(this.page.orderLoader),e.next=6,this.fetchOrders();case 6:t=e.sent,this.loading=!1,br.hide(this.page.orderLoader),this.appendOrders(t);case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),p}(Pr);function xs(e){var t=[];return e.querySelectorAll("input").forEach((function(e){e.checked&&t.push(e.value)})),t}function Cs(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ss(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ss(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){i=!0,o=e})),f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function Ss(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function As(e,t,n){return"".concat(e,"-").concat(t,"-").concat(n)}var Fs=function(e){En(w,e);var t,n,a,i,c,l,h,p,f,v,m,g,y,k=(g=w,y=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rn(g);if(y){var n=Rn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return In(this,e)});function w(e){var t;s(this,w),d(An(t=k.call(this)),"page",void 0),d(An(t),"currentForm",void 0),d(An(t),"keyup",void 0),d(An(t),"currentNewMarket",void 0),d(An(t),"newWalletForm",void 0),d(An(t),"botConfigs",void 0);var n=t.page=br.idDescendants(e);return n.forms.querySelectorAll(".form-closer").forEach((function(e){br.bind(e,"click",(function(){t.closePopups()}))})),t.keyup=function(e){"Escape"===e.key&&t.closePopups()},t.newWalletForm=new pa(n.newWalletForm,(function(){t.addBotSubmit()})),br.bind(n.addBotBtn,"click",(function(){t.showAddBotForm()})),br.bind(n.startBotsBtn,"click",(function(){t.showPWSubmitForm()})),br.bind(n.stopBotsBtn,"click",(function(){t.stopBots()})),br.bind(n.hostSelect,"change",(function(){t.selectMarketHost()})),Ta(n.addBotForm,n.addBotSubmit,(function(){t.addBotSubmit()})),Ta(n.pwForm,n.pwSubmit,(function(){return t.startBots()})),Dn(n),br.cleanTemplates(n.orderOptTmpl,n.booleanOptTmpl,n.rangeOptTmpl,n.assetRowTmpl,n.botTableRowTmpl),br.bind(n.baseSelect,"click",(function(e){return t.selectMarketAssetClicked(e,!0)})),br.bind(n.quoteSelect,"click",(function(e){return t.selectMarketAssetClicked(e,!1)})),t.setup(),t}return u(w,[{key:"setup",value:(m=o(b().mark((function e(){var t,n,r,a,o,s,i=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,e.next=3,Sn().getMarketMakingStatus();case 3:return n=e.sent,r=n.running,e.next=7,Sn().getMarketMakingConfig();case 7:if(a=e.sent,o=this.botConfigs=a.botConfigs||[],Sn().registerNoteFeeder({botstartstop:function(e){i.handleBotStartStopNote(e)},mmstartstop:function(e){i.handleMMStartStopNote(e)},balance:function(e){i.handleBalanceNote(e)}}),s=!o||0===o.length,br.setVis(s,t.noBotsHeader),br.setVis(!s,t.botTable),!s){e.next=15;break}return e.abrupt("return");case 15:br.setVis(r,t.stopBotsBtn),br.setVis(!r,t.startBotsBtn,t.addBotBtn),this.setupBotTable(o,r,n.runningBots);case 18:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"handleBotStartStopNote",value:function(e){for(var t=this.page.botTableBody.children,n=As(e.host,e.base,e.quote),r=0;r<t.length;r++){var a=t[r];if(a.id===n){var o=br.parseTemplate(a);return void this.setTableRowRunning(o,void 0,e.running)}}}},{key:"handleMMStartStopNote",value:function(e){var t=this.page;br.setVis(e.running,t.stopBotsBtn,t.runningHeader),br.setVis(!e.running,t.startBotsBtn,t.addBotBtn,t.enabledHeader,t.baseBalanceHeader,t.quoteBalanceHeader,t.removeHeader);for(var n=t.botTableBody.children,r=0;r<n.length;r++){var a=n[r],o=br.parseTemplate(a);this.setTableRowRunning(o,e.running,void 0)}}},{key:"handleBalanceNote",value:function(e){for(var t=this,n=function(e){var n,r=Cs(t.botConfigs);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(As(a.host,a.baseAsset,a.quoteAsset)===e)return a}}catch(e){r.e(e)}finally{r.f()}},r=this.page.botTableBody.children,a=0;a<r.length;a++){var o=r[a],s=br.parseTemplate(o),i=n(o.id);i&&(i.baseAsset===e.assetID?s.baseBalance.textContent=this.walletBalanceStr(e.assetID,i.baseBalance):i.quoteAsset===e.assetID&&(s.quoteBalance.textContent=this.walletBalanceStr(e.assetID,i.quoteBalance)))}}},{key:"unload",value:function(){br.unbind(document,"keyup",this.keyup)}},{key:"selectMarketAssetClicked",value:(v=o(b().mark((function e(t,n){var a,o,s,i,c,l,u,d,h,p,f,v,m,g,y,k,w,x,C,S,A,F,E,I,R,T=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.page,t.stopPropagation(),o=n?a.baseSelect:a.quoteSelect,s=br.descendentMetrics(a.addBotForm,o),a.assetDropdown.style.left="".concat(s.bodyLeft,"px"),a.assetDropdown.style.top="".concat(s.bodyTop,"px"),i=n?this.currentNewMarket.quoteid:this.currentNewMarket.baseid,c=n?this.currentNewMarket.basesymbol:this.currentNewMarket.quotesymbol,l=new Set,u=new Set,e.t0=Cs,e.next=13,this.sortedMarkets();case 13:e.t1=e.sent,d=(0,e.t0)(e.t1);try{for(d.s();!(h=d.n()).done;)p=h.value,u.add(p.basesymbol),u.add(p.quotesymbol),f=n?[p.quoteid,p.baseid]:[p.baseid,p.quoteid],v=r(f,2),m=v[0],g=v[1],y=n?[p.quotesymbol,p.basesymbol]:[p.basesymbol,p.quotesymbol],k=r(y,2),w=k[0],x=k[1],m===i?l.add(x):g===i&&l.add(w)}catch(e){d.e(e)}finally{d.f()}for((C=Array.from(l)).sort((function(e,t){return e.localeCompare(t)})),S=0,A=C;S<A.length;S++)F=A[S],u.delete(F);(E=Array.from(u)).sort((function(e,t){return e.localeCompare(t)})),br.empty(a.assetDropdown),I=function(e,t){var r,o=Cs(e);try{var s=function(){var e=r.value,o=br.bipIDFromSymbol(e),s=Sn().assets[o],i=T.assetRow(s);br.bind(i,"click",(function(t){if(t.stopPropagation(),e===c)return T.hideAssetDropdown();n?T.setCreationBase(e):T.setCreationQuote(e)})),t||i.classList.add("ghost"),a.assetDropdown.appendChild(i)};for(o.s();!(r=o.n()).done;)s()}catch(e){o.e(e)}finally{o.f()}},I(C,!0),I(E,!1),br.show(a.assetDropdown),R=function e(t){br.mouseInElement(t,a.assetDropdown)||(T.hideAssetDropdown(),br.unbind(document,"click",e))},br.bind(document,"click",R);case 28:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"selectMarketHost",value:function(){this.currentNewMarket&&this.page.hostSelect.value&&(this.currentNewMarket.host=this.page.hostSelect.value)}},{key:"assetRow",value:function(e){var t=this.page.assetRowTmpl.cloneNode(!0),n=br.parseTemplate(t);return n.logo.src=br.logoPath(e.symbol),br.empty(n.symbol),n.symbol.appendChild(br.symbolize(e)),t}},{key:"hideAssetDropdown",value:function(){var e=this.page;e.assetDropdown.scrollTop=0,br.hide(e.assetDropdown)}},{key:"setMarket",value:(f=o(b().mark((function e(t){var n,r,a,o,s,i,c,l,u;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,r=t[0],this.currentNewMarket=r,br.empty(n.baseSelect,n.quoteSelect),a=Sn().assets[r.baseid],o=Sn().assets[r.quoteid],n.baseSelect.appendChild(this.assetRow(a)),n.quoteSelect.appendChild(this.assetRow(o)),this.hideAssetDropdown(),s=function(e,t){br.setContent(t,br.symbolize(a),new Text("-"),br.symbolize(o),new Text(" @ "),new Text(e.host))},br.hide(n.hostSelect,n.marketOneChoice),1===t.length)br.show(n.marketOneChoice),s(r,n.marketOneChoice);else{br.show(n.hostSelect),br.empty(n.hostSelect),i=Cs(t);try{for(i.s();!(c=i.n()).done;)l=c.value,u=document.createElement("option"),n.hostSelect.appendChild(u),u.value="".concat(l.host),s(l,u)}catch(e){i.e(e)}finally{i.f()}}case 12:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"setCreationBase",value:(p=o(b().mark((function e(t){var n,r,a,o,s,i,c,l,u,d,h,p;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.currentNewMarket.quotesymbol,e.next=3,this.sortedMarkets();case 3:if(r=e.sent,a=function(e,t){var n,a=[],o=Cs(r);try{for(o.s();!(n=o.n()).done;){var s=n.value;s.basesymbol===e&&s.quotesymbol===t&&a.push(s)}}catch(e){o.e(e)}finally{o.f()}return a},!((o=a(t,n)).length>0)){e.next=8;break}return e.abrupt("return",this.setMarket(o));case 8:if(!((o=a(n,t)).length>0)){e.next=11;break}return e.abrupt("return",this.setMarket(o));case 11:i=Cs(r);try{for(i.s();!(c=i.n()).done;)(l=c.value).basesymbol===t&&(s=l.quotesymbol)}catch(e){i.e(e)}finally{i.f()}if(!s){e.next=15;break}return e.abrupt("return",this.setMarket(a(t,s)));case 15:d=Cs(r);try{for(d.s();!(h=d.n()).done;)(p=h.value).quotesymbol===t&&(u=p.basesymbol)}catch(e){d.e(e)}finally{d.f()}if(!u){e.next=19;break}return e.abrupt("return",this.setMarket(a(u,t)));case 19:console.error("No market found for ".concat(t));case 20:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"setCreationQuote",value:(h=o(b().mark((function e(t){var n,r,a,o,s,i,c,l,u,d,h,p;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.currentNewMarket.basesymbol,e.next=3,this.sortedMarkets();case 3:if(r=e.sent,a=function(e,t){var n,a=[],o=Cs(r);try{for(o.s();!(n=o.n()).done;){var s=n.value;s.basesymbol===e&&s.quotesymbol===t&&a.push(s)}}catch(e){o.e(e)}finally{o.f()}return a},!((o=a(n,t)).length>0)){e.next=8;break}return e.abrupt("return",this.setMarket(o));case 8:if(!((o=a(t,n)).length>0)){e.next=11;break}return e.abrupt("return",this.setMarket(o));case 11:i=Cs(r);try{for(i.s();!(c=i.n()).done;)(l=c.value).quotesymbol===t&&(s=l.quotesymbol)}catch(e){i.e(e)}finally{i.f()}if(!s){e.next=15;break}return e.abrupt("return",this.setMarket(a(s,t)));case 15:d=Cs(r);try{for(d.s();!(h=d.n()).done;)(p=h.value).basesymbol===t&&(u=p.quotesymbol)}catch(e){d.e(e)}finally{d.f()}if(!u){e.next=19;break}return e.abrupt("return",this.setMarket(a(t,u)));case 19:console.error("No market found for ".concat(t));case 20:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"sortedMarkets",value:(l=o(b().mark((function e(){var t,n,r,a,o,s,i,c,l,u,d,h;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],n=function(e){return e.markets?Object.values(e.markets).map((function(t){return Object.assign({host:e.host},t)})):[]},r=0,a=Object.values(Sn().user.exchanges);r<a.length;r++)o=a[r],t.push.apply(t,Vr(n(o)));return e.next=5,Sn().getMarketMakingConfig();case 5:s=e.sent,i=s.botConfigs||[],c={},l=Cs(i);try{for(l.s();!(u=l.n()).done;)d=u.value,c[As(d.host,d.baseAsset,d.quoteAsset)]=!0}catch(e){l.e(e)}finally{l.f()}return(h=t.filter((function(e){return!c[As(e.host,e.baseid,e.quoteid)]}))).sort((function(e,t){return e.spot?t.spot?t.spot.vol24/t.lotsize-e.spot.vol24/e.lotsize:1:t.spot?-1:e.name.localeCompare(t.name)})),e.abrupt("return",h);case 13:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)})},{key:"addBotSubmit",value:function(){var e=this.currentNewMarket;return Sn().walletMap[e.baseid]?Sn().walletMap[e.quoteid]?void Sn().loadPage("mmsettings?host=".concat(e.host,"&base=").concat(e.baseid,"&&quote=").concat(e.quoteid)):(this.newWalletForm.setAsset(e.quoteid),void this.showForm(this.page.newWalletForm)):(this.newWalletForm.setAsset(e.baseid),void this.showForm(this.page.newWalletForm))}},{key:"walletBalanceStr",value:function(e,t){var n=Sn().assets[e],r=n.wallet.balance.available,a=n.unitInfo,o=br.formatCoinValue(r*t/100,a);return"".concat(t,"% - ").concat(o," ").concat(n.symbol.toUpperCase())}},{key:"setTableRowRunning",value:function(e,t,n){void 0!==t&&(br.setVis(t,e.running),br.setVis(!t,e.enabled,e.baseBalanceTd,e.quoteBalanceTd,e.removeTd)),void 0!==n&&(br.setVis(n,e.runningIcon),br.setVis(!n,e.notRunningIcon))}},{key:"setupBotTable",value:function(e,t,n){var r=this,a=this.page;br.empty(a.botTableBody),br.setVis(t,a.runningHeader),br.setVis(!t,a.enabledHeader,a.baseBalanceHeader,a.quoteBalanceHeader,a.removeHeader);var s,i=Cs(e);try{var c=function(){var e=s.value,i=a.botTableRowTmpl.cloneNode(!0);i.id=As(e.host,e.baseAsset,e.quoteAsset);var c=br.parseTemplate(i),l=n.some((function(t){return t.host===e.host&&t.base===e.baseAsset&&t.quote===e.quoteAsset}));r.setTableRowRunning(c,t,l);var u=Sn().assets[e.baseAsset].symbol,d=Sn().assets[e.quoteAsset].symbol,h=br.logoPath(u),p=br.logoPath(d);c.enabledCheckbox.checked=!e.disabled,c.enabledCheckbox.onclick=o(b().mark((function t(){return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Sn().setMarketMakingEnabled(e.host,e.baseAsset,e.quoteAsset,!!c.enabledCheckbox.checked);case 1:case"end":return t.stop()}}),t)}))),c.host.textContent=e.host,c.baseMktLogo.src=h,c.quoteMktLogo.src=p,c.baseSymbol.textContent=u.toUpperCase(),c.quoteSymbol.textContent=d.toUpperCase(),c.botType.textContent="Market Maker",c.baseBalance.textContent=r.walletBalanceStr(e.baseAsset,e.baseBalance),c.quoteBalance.textContent=r.walletBalanceStr(e.quoteAsset,e.quoteBalance),c.baseBalanceLogo.src=h,c.quoteBalanceLogo.src=p,c.remove.onclick=o(b().mark((function t(){var n,r;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Sn().removeMarketMakingConfig(e);case 2:return i.remove(),t.next=5,Sn().getMarketMakingConfig();case 5:n=t.sent,r=!n||!n.botConfigs||0===n.botConfigs.length,br.setVis(r,a.noBotsHeader),br.setVis(!r,a.botTable);case 9:case"end":return t.stop()}}),t)}))),c.settings.onclick=function(){Sn().loadPage("mmsettings?host=".concat(e.host,"&base=").concat(e.baseAsset,"&quote=").concat(e.quoteAsset))},a.botTableBody.appendChild(i)};for(i.s();!(s=i.n()).done;)c()}catch(e){i.e(e)}finally{i.f()}}},{key:"showAddBotForm",value:(c=o(b().mark((function e(){var t,n,r,a,o,s,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sortedMarkets();case 2:if(0!==(t=e.sent).length){e.next=5;break}return e.abrupt("return");case 5:n=[],r=t[0].basesymbol,a=t[0].quotesymbol,o=Cs(t);try{for(o.s();!(s=o.n()).done;)(i=s.value).basesymbol===r&&i.quotesymbol===a&&n.push(i)}catch(e){o.e(e)}finally{o.f()}this.setMarket(n),this.showForm(this.page.addBotForm);case 12:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"showPWSubmitForm",value:(i=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.page,this.showForm(t.pwForm);case 2:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"startBots",value:(a=o(b().mark((function e(){var t,n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,e.prev=1,n=t.pwInput.value,this.page.pwInput.value="",this.closePopups(),e.next=7,Sn().startMarketMaking(n||"");case 7:e.next=14;break;case 9:e.prev=9,e.t0=e.catch(1),t.mmErr.textContent=e.t0.message,br.show(t.mmErr),setTimeout((function(){br.hide(t.mmErr)}),3e3);case 14:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(){return a.apply(this,arguments)})},{key:"stopBots",value:(n=o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sn().stopMarketMaking();case 2:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"showForm",value:(t=o(b().mark((function e(t){var n,r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentForm=t,n=this.page,br.hide(n.pwForm,n.newWalletForm,n.addBotForm),t.style.right="10000px",br.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,br.animate(300,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"closePopups",value:function(){br.hide(this.page.forms)}}]),w}(Pr);function Es(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Is(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Is(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function Is(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Rs="multiplier",Ts="absolute",Ds="absolute-plus",Ms="percent",Ps="percent-plus",Bs={start:{label:"0%",x:0,y:0},end:{label:"1%",x:.01,y:1},xUnit:"",yUnit:"%"},Os={start:{label:"-1%",x:-.01,y:-1},end:{label:"1%",x:.01,y:1},xUnit:"",yUnit:"%"},Ls={start:{label:"0%",x:0,y:0},end:{label:"100%",x:1,y:100},xUnit:"",yUnit:"%"},Ws={gapStrategy:Ps,sellPlacements:[],buyPlacements:[],driftTolerance:.001,oracleWeighting:.1,oracleBias:0,emptyMarketRate:0},qs=function(e){En(l,e);var t,n,r,a,i,c=(a=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rn(a);if(i){var n=Rn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return In(this,e)});function l(e){var t;s(this,l),d(An(t=c.call(this)),"page",void 0),d(An(t),"currentMarket",void 0),d(An(t),"originalConfig",void 0),d(An(t),"updatedConfig",void 0),d(An(t),"creatingNewBot",void 0),d(An(t),"host",void 0),d(An(t),"baseID",void 0),d(An(t),"quoteID",void 0),d(An(t),"oracleBiasRangeHandler",void 0),d(An(t),"oracleWeightingRangeHandler",void 0),d(An(t),"driftToleranceRangeHandler",void 0),d(An(t),"baseBalanceRangeHandler",void 0),d(An(t),"quoteBalanceRangeHandler",void 0),d(An(t),"baseWalletSettingControl",{}),d(An(t),"quoteWalletSettingControl",{});var n=t.page=br.idDescendants(e);Dn(n),br.cleanTemplates(n.orderOptTmpl,n.booleanOptTmpl,n.rangeOptTmpl,n.placementRowTmpl,n.oracleTmpl,n.boolSettingTmpl,n.rangeSettingTmpl),br.bind(n.resetButton,"click",(function(){t.setOriginalValues(!1)})),br.bind(n.updateButton,"click",(function(){t.saveSettings(),br.show(n.settingsUpdatedMsg),setTimeout((function(){br.hide(n.settingsUpdatedMsg)}),2e3)})),br.bind(n.createButton,"click",o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.saveSettings();case 2:Sn().loadPage("mm");case 3:case"end":return e.stop()}}),e)})))),br.bind(n.backButton,"click",(function(){Sn().loadPage("mm")}));var r=new URLSearchParams(window.location.search),a=r.get("host"),i=r.get("base"),u=r.get("quote");return a&&i&&u?(t.baseID=parseInt(i),t.quoteID=parseInt(u),t.host=a,n.baseHeader.textContent=Sn().assets[t.baseID].symbol.toUpperCase(),n.quoteHeader.textContent=Sn().assets[t.quoteID].symbol.toUpperCase(),n.hostHeader.textContent=a,n.baseBalanceLogo.src=br.logoPathFromID(t.baseID),n.quoteBalanceLogo.src=br.logoPathFromID(t.quoteID),n.baseSettingsLogo.src=br.logoPathFromID(t.baseID),n.quoteSettingsLogo.src=br.logoPathFromID(t.quoteID),n.baseLogo.src=br.logoPathFromID(t.baseID),n.quoteLogo.src=br.logoPathFromID(t.quoteID),t.setup(),t):(console.log("Missing 'host', 'base', or 'quote' URL parameter"),In(t))}return u(l,[{key:"defaultWalletOptions",value:function(e){var t=Sn().currentWalletDefinition(e);if(!t.multifundingopts)return{};var n,r={},a=Es(t.multifundingopts);try{for(a.s();!(n=a.n()).done;){var o=n.value;o.quoteAssetOnly&&e!==this.quoteID||(r[o.key]="".concat(o.default))}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"setup",value:(r=o(b().mark((function e(){var t,n,r,a,o,s,i,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,e.next=3,Sn().getMarketMakingConfig();case 3:return n=e.sent,r=n.botConfigs||[],e.next=7,Sn().getMarketMakingStatus();case 7:a=e.sent,o=Es(r),e.prev=9,o.s();case 11:if((s=o.n()).done){e.next=19;break}if((i=s.value).host!==this.host||i.baseAsset!==this.baseID||i.quoteAsset!==this.quoteID){e.next=17;break}return this.originalConfig=JSON.parse(JSON.stringify(i)),this.updatedConfig=JSON.parse(JSON.stringify(i)),e.abrupt("break",19);case 17:e.next=11;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(9),o.e(e.t0);case 24:return e.prev=24,o.f(),e.finish(24);case 27:this.creatingNewBot=!this.updatedConfig,this.creatingNewBot&&(c={host:this.host,baseAsset:this.baseID,quoteAsset:this.quoteID,baseBalanceType:xn.Percentage,baseBalance:0,quoteBalanceType:xn.Percentage,quoteBalance:0,basicMarketMakingConfig:Ws,disabled:!1},this.originalConfig=JSON.parse(JSON.stringify(c)),this.originalConfig.basicMarketMakingConfig.baseOptions=this.defaultWalletOptions(this.baseID),this.originalConfig.basicMarketMakingConfig.quoteOptions=this.defaultWalletOptions(this.quoteID),this.updatedConfig=JSON.parse(JSON.stringify(this.originalConfig)),br.hide(t.updateButton,t.resetButton),br.show(t.createButton)),a.running&&br.hide(t.updateButton,t.createButton,t.resetButton),this.setupMMConfigSettings(a.running),this.setupBalanceSelectors(r,a.running),this.setupWalletSettings(a.running),this.setOriginalValues(a.running),br.show(t.botSettingsContainer),this.fetchOracles();case 36:case"end":return e.stop()}}),e,this,[[9,21,24,27]])}))),function(){return r.apply(this,arguments)})},{key:"updateModifiedMarkers",value:function(){if(!this.creatingNewBot){var e=this.page,t=this.originalConfig.basicMarketMakingConfig,n=this.updatedConfig.basicMarketMakingConfig,r=t.gapStrategy!==n.gapStrategy;e.gapStrategySelect.classList.toggle("modified",r);var a=!1;if(t.buyPlacements.length!==n.buyPlacements.length)a=!0;else for(var o=0;o<t.buyPlacements.length;o++)if(t.buyPlacements[o].lots!==n.buyPlacements[o].lots||t.buyPlacements[o].gapFactor!==n.buyPlacements[o].gapFactor){a=!0;break}e.buyPlacementsTableWrapper.classList.toggle("modified",a);var s=!1;if(t.sellPlacements.length!==n.sellPlacements.length)s=!0;else for(var i=0;i<t.sellPlacements.length;i++)if(t.sellPlacements[i].lots!==n.sellPlacements[i].lots||t.sellPlacements[i].gapFactor!==n.sellPlacements[i].gapFactor){s=!0;break}e.sellPlacementsTableWrapper.classList.toggle("modified",s);var c=t.driftTolerance!==n.driftTolerance;e.driftToleranceContainer.classList.toggle("modified",c);var l=t.oracleBias!==n.oracleBias;e.oracleBiasContainer.classList.toggle("modified",l);var u=0!==t.oracleWeighting!=(0!==n.oracleWeighting);e.useOracleCheckbox.classList.toggle("modified",u);var d=t.oracleWeighting!==n.oracleWeighting;e.oracleWeightingContainer.classList.toggle("modified",d);var h=t.emptyMarketRate!==n.emptyMarketRate;e.emptyMarketRateInput.classList.toggle("modified",h);var p=0===t.emptyMarketRate!=!e.emptyMarketRateCheckbox.checked;e.emptyMarketRateCheckbox.classList.toggle("modified",p);var f=this.originalConfig.baseBalance!==this.updatedConfig.baseBalance;e.baseBalanceContainer.classList.toggle("modified",f);var v=this.originalConfig.quoteBalance!==this.updatedConfig.quoteBalance;e.quoteBalanceContainer.classList.toggle("modified",v);for(var m=0,g=Object.keys(this.baseWalletSettingControl);m<g.length;m++){var y=g[m];if(!this.updatedConfig.basicMarketMakingConfig.baseOptions)break;if(!this.originalConfig.basicMarketMakingConfig.baseOptions)break;var k=this.originalConfig.basicMarketMakingConfig.baseOptions[y]!==this.updatedConfig.basicMarketMakingConfig.baseOptions[y];this.baseWalletSettingControl[y].toHighlight.classList.toggle("modified",k)}for(var b=0,w=Object.keys(this.quoteWalletSettingControl);b<w.length;b++){var x=w[b];if(!this.updatedConfig.basicMarketMakingConfig.quoteOptions)break;if(!this.originalConfig.basicMarketMakingConfig.quoteOptions)break;var C=this.originalConfig.basicMarketMakingConfig.quoteOptions[x]!==this.updatedConfig.basicMarketMakingConfig.quoteOptions[x];this.quoteWalletSettingControl[x].toHighlight.classList.toggle("modified",C)}}}},{key:"gapFactorHeaderUnit",value:function(e){switch(e){case Rs:return["Multiplier","x"];case Ts:case Ds:return["Rate","".concat(Sn().assets[this.quoteID].symbol,"/").concat(Sn().assets[this.baseID].symbol)];case Ms:case Ps:return["Percent","%"];default:throw new Error("Unknown gap strategy ".concat(e))}}},{key:"checkGapFactorRange",value:function(e,t){switch(e){case Rs:return t<1||t>100?"Multiplier must be between 1 and 100":null;case Ts:case Ds:return t<=0?"Rate must be greater than 0":null;case Ms:case Ps:return t<=0||t>10?"Percent must be between 0 and 10":null;default:throw new Error("Unknown gap factor ".concat(e))}}},{key:"convertGapFactor",value:function(e,t,n){switch(t){case Rs:case Ts:case Ds:return e;case Ms:case Ps:return n?100*e:e/100;default:throw new Error("Unknown gap factor ".concat(t))}}},{key:"addPlacement",value:function(e,t,n){var r=this,a=this.page,o=a.sellPlacementsTableBody,s=a.addSellPlacementRow,i=a.addSellPlacementLots,c=a.addSellPlacementGapFactor,l=a.sellPlacementsErr;e&&(o=a.buyPlacementsTableBody,s=a.addBuyPlacementRow,i=a.addBuyPlacementLots,c=a.addBuyPlacementGapFactor,l=a.buyPlacementsErr);var u=function(e){return e?r.updatedConfig.basicMarketMakingConfig.buyPlacements:r.updatedConfig.basicMarketMakingConfig.sellPlacements},d=function(){for(var e=0;e<o.children.length-1;e++){var t=br.parseTemplate(o.children[e]);n?br.hide(t.upBtn,t.downBtn):(br.setVis(0!==e,t.upBtn),br.setVis(e!==o.children.length-2,t.downBtn))}};br.hide(l);var h,p,f,v=function(e){l.textContent=e,br.show(l)},m=this.updatedConfig.basicMarketMakingConfig.gapStrategy,g=this.gapFactorHeaderUnit(m)[1];if(t)h=t.lots,p=t.gapFactor,f=this.convertGapFactor(p,m,!0);else{if(h=parseInt(i.value||"0"),f=parseFloat(c.value||"0"),p=this.convertGapFactor(f,m,!1),0===h)return void v("Lots must be greater than 0");var y=this.checkGapFactorRange(m,f);if(y)return void v(y);var k=u(e);if(k.find((function(e){return e.gapFactor===p})))return void v("Duplicate placement");k.push({lots:h,gapFactor:p})}var b=a.placementRowTmpl.cloneNode(!0),w=br.parseTemplate(b);w.priority.textContent="".concat(o.children.length),w.lots.textContent="".concat(h),w.gapFactor.textContent="".concat(f," ").concat(g),w.removeBtn.onclick=function(){var t=u(e),n=t.findIndex((function(e){return e.lots===h&&e.gapFactor===p}));-1!==n&&(t.splice(n,1),b.remove(),d(),r.updateModifiedMarkers())},n&&br.hide(w.removeBtn),w.upBtn.onclick=function(){var t=u(e),n=t.findIndex((function(e){return e.lots===h&&e.gapFactor===p}));if(0!==n){var a=t[n-1];t[n-1]=t[n],t[n]=a,w.priority.textContent="".concat(n),b.remove(),o.insertBefore(b,o.children[n-1]),br.parseTemplate(o.children[n]).priority.textContent="".concat(n+1),d(),r.updateModifiedMarkers()}},w.downBtn.onclick=function(){var t=u(e),n=t.findIndex((function(e){return e.lots===h&&e.gapFactor===p}));if(n!==t.length-1){var a=t[n+1];t[n+1]=t[n],t[n]=a,w.priority.textContent="".concat(n+2),b.remove(),o.insertBefore(b,o.children[n+1]),br.parseTemplate(o.children[n]).priority.textContent="".concat(n+1),d(),r.updateModifiedMarkers()}},o.insertBefore(b,s),d()}},{key:"setGapFactorLabels",value:function(e){var t=this.page,n=this.gapFactorHeaderUnit(e)[0];t.buyGapFactorHdr.textContent=n,t.sellGapFactorHdr.textContent=n}},{key:"setupMMConfigSettings",value:function(e){var t=this,n=this.page;n.gapStrategySelect.onchange=function(){if(n.gapStrategySelect.value){for(t.updatedConfig.basicMarketMakingConfig.gapStrategy=n.gapStrategySelect.value;n.buyPlacementsTableBody.children.length>1;)n.buyPlacementsTableBody.children[0].remove();for(;n.sellPlacementsTableBody.children.length>1;)n.sellPlacementsTableBody.children[0].remove();t.updatedConfig.basicMarketMakingConfig.buyPlacements=[],t.updatedConfig.basicMarketMakingConfig.sellPlacements=[],t.setGapFactorLabels(n.gapStrategySelect.value),t.updateModifiedMarkers()}},e&&n.gapStrategySelect.setAttribute("disabled","true"),n.addBuyPlacementBtn.onclick=function(){t.addPlacement(!0,null,!1),n.addBuyPlacementLots.value="",n.addBuyPlacementGapFactor.value="",t.updateModifiedMarkers()},n.addSellPlacementBtn.onclick=function(){t.addPlacement(!1,null,!1),n.addSellPlacementLots.value="",n.addSellPlacementGapFactor.value="",t.updateModifiedMarkers()},br.setVis(!e,n.addBuyPlacementRow,n.addSellPlacementRow);var r=function(){t.updateModifiedMarkers()},a=function(){},o=this.updatedConfig.basicMarketMakingConfig.driftTolerance;this.driftToleranceRangeHandler=new Ln(Bs,o,(function(e){t.updatedConfig.basicMarketMakingConfig.driftTolerance=e}),r,a,!1,!1,e),n.driftToleranceContainer.appendChild(this.driftToleranceRangeHandler.control),n.useOracleCheckbox.onchange=function(){n.useOracleCheckbox.checked?(br.show(n.oracleBiasSection,n.oracleWeightingSection),t.updatedConfig.basicMarketMakingConfig.oracleWeighting=Ws.oracleWeighting,t.updatedConfig.basicMarketMakingConfig.oracleBias=Ws.oracleBias,t.oracleWeightingRangeHandler.setValue(Ws.oracleWeighting),t.oracleBiasRangeHandler.setValue(Ws.oracleBias)):(br.hide(n.oracleBiasSection,n.oracleWeightingSection),t.updatedConfig.basicMarketMakingConfig.oracleWeighting=0,t.updatedConfig.basicMarketMakingConfig.oracleBias=0),t.updateModifiedMarkers()},e&&n.useOracleCheckbox.setAttribute("disabled","true");var s=this.originalConfig.basicMarketMakingConfig.oracleBias;this.oracleBiasRangeHandler=new Ln(Os,s,(function(e){t.updatedConfig.basicMarketMakingConfig.oracleBias=e}),r,a,!1,!1,e),n.oracleBiasContainer.appendChild(this.oracleBiasRangeHandler.control);var i=this.originalConfig.basicMarketMakingConfig.oracleWeighting;this.oracleWeightingRangeHandler=new Ln(Ls,i,(function(e){t.updatedConfig.basicMarketMakingConfig.oracleWeighting=e}),r,a,!1,!1,e),n.oracleWeightingContainer.appendChild(this.oracleWeightingRangeHandler.control),n.emptyMarketRateCheckbox.onchange=function(){n.emptyMarketRateCheckbox.checked?(t.updatedConfig.basicMarketMakingConfig.emptyMarketRate=t.originalConfig.basicMarketMakingConfig.emptyMarketRate,n.emptyMarketRateInput.value="".concat(t.updatedConfig.basicMarketMakingConfig.emptyMarketRate),br.show(n.emptyMarketRateInput),t.updateModifiedMarkers()):(t.updatedConfig.basicMarketMakingConfig.emptyMarketRate=0,br.hide(n.emptyMarketRateInput),t.updateModifiedMarkers())},n.emptyMarketRateInput.onchange=function(){var e=parseFloat(n.emptyMarketRateInput.value||"0");t.updatedConfig.basicMarketMakingConfig.emptyMarketRate=e,t.updateModifiedMarkers()},e&&(n.emptyMarketRateCheckbox.setAttribute("disabled","true"),n.emptyMarketRateInput.setAttribute("disabled","true"))}},{key:"setOriginalValues",value:function(e){var t=this,n=this.page;if(this.updatedConfig=JSON.parse(JSON.stringify(this.originalConfig)),n.gapStrategySelect.options){for(Array.from(n.gapStrategySelect.options).forEach((function(e){e.value===t.originalConfig.basicMarketMakingConfig.gapStrategy&&(e.selected=!0)})),this.setGapFactorLabels(this.originalConfig.basicMarketMakingConfig.gapStrategy);n.buyPlacementsTableBody.children.length>1;)n.buyPlacementsTableBody.children[0].remove();for(;n.sellPlacementsTableBody.children.length>1;)n.sellPlacementsTableBody.children[0].remove();if(this.originalConfig.basicMarketMakingConfig.buyPlacements.forEach((function(n){t.addPlacement(!0,n,e)})),this.originalConfig.basicMarketMakingConfig.sellPlacements.forEach((function(n){t.addPlacement(!1,n,e)})),console.log(this.originalConfig.basicMarketMakingConfig.emptyMarketRate),n.emptyMarketRateCheckbox.checked=this.originalConfig.basicMarketMakingConfig.emptyMarketRate>0,br.setVis(!!n.emptyMarketRateCheckbox.checked,n.emptyMarketRateInput),n.emptyMarketRateInput.value="".concat(this.originalConfig.basicMarketMakingConfig.emptyMarketRate||0),0===this.originalConfig.basicMarketMakingConfig.oracleWeighting&&(n.useOracleCheckbox.checked=!1,br.hide(n.oracleBiasSection,n.oracleWeightingSection)),this.oracleBiasRangeHandler.setValue(this.originalConfig.basicMarketMakingConfig.oracleBias),this.oracleWeightingRangeHandler.setValue(this.originalConfig.basicMarketMakingConfig.oracleWeighting),this.driftToleranceRangeHandler.setValue(this.originalConfig.basicMarketMakingConfig.driftTolerance),this.baseBalanceRangeHandler&&this.baseBalanceRangeHandler.setValue(this.originalConfig.baseBalance),this.quoteBalanceRangeHandler&&this.quoteBalanceRangeHandler.setValue(this.originalConfig.quoteBalance),this.updatedConfig.basicMarketMakingConfig.baseOptions&&this.originalConfig.basicMarketMakingConfig.baseOptions)for(var r=0,a=Object.keys(this.updatedConfig.basicMarketMakingConfig.baseOptions);r<a.length;r++){var o=a[r],s=this.originalConfig.basicMarketMakingConfig.baseOptions[o];this.updatedConfig.basicMarketMakingConfig.baseOptions[o]=s,this.baseWalletSettingControl[o]&&this.baseWalletSettingControl[o].setValue(s)}if(this.updatedConfig.basicMarketMakingConfig.quoteOptions&&this.originalConfig.basicMarketMakingConfig.quoteOptions)for(var i=0,c=Object.keys(this.updatedConfig.basicMarketMakingConfig.quoteOptions);i<c.length;i++){var l=c[i],u=this.originalConfig.basicMarketMakingConfig.quoteOptions[l];this.updatedConfig.basicMarketMakingConfig.quoteOptions[l]=u,this.quoteWalletSettingControl[l]&&this.quoteWalletSettingControl[l].setValue(u)}this.updateModifiedMarkers()}}},{key:"saveSettings",value:(n=o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sn().updateMarketMakingConfig(this.updatedConfig);case 2:this.originalConfig=JSON.parse(JSON.stringify(this.updatedConfig)),this.updateModifiedMarkers();case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setupBalanceSelectors",value:function(e,t){var n=this,r=this.page,a=Sn().assets[this.updatedConfig.baseAsset],o=Sn().assets[this.updatedConfig.quoteAsset],s=a.wallet.balance.available,i=o.wallet.balance.available,c=0,l=0;e.forEach((function(e){e.baseAsset===n.updatedConfig.baseAsset&&e.quoteAsset===n.updatedConfig.quoteAsset&&e.host===n.updatedConfig.host||(e.baseAsset===n.updatedConfig.baseAsset&&(c+=e.baseBalance),e.quoteAsset===n.updatedConfig.baseAsset&&(c+=e.quoteBalance),e.baseAsset===n.updatedConfig.quoteAsset&&(l+=e.baseBalance),e.quoteAsset===n.updatedConfig.quoteAsset&&(l+=e.quoteBalance))}));var u=0,d=0;c<100&&(u=100-c),l<100&&(d=100-l);var h=br.conventionalCoinValue(s*u/100,a.unitInfo),p=br.conventionalCoinValue(i*d/100,o.unitInfo),f={start:{label:"0%",x:0,y:0},end:{label:"".concat(u,"%"),x:u,y:h},xUnit:"%",yUnit:a.symbol},v={start:{label:"0%",x:0,y:0},end:{label:"".concat(d,"%"),x:d,y:p},xUnit:"%",yUnit:o.symbol};if(br.hide(r.noBaseBalance,r.noQuoteBalance,r.baseBalanceContainer,r.quoteBalanceContainer),br.empty(r.baseBalanceContainer,r.quoteBalanceContainer),h>0){var m=this.originalConfig.baseBalance,g=new Ln(f,m,(function(e){n.updatedConfig.baseBalance=e,n.updateModifiedMarkers()}),(function(){}),(function(){}),!1,!0,t);r.baseBalanceContainer.appendChild(g.control),this.baseBalanceRangeHandler=g,br.show(r.baseBalanceContainer)}else br.show(r.noBaseBalance);if(p>0){var y=this.originalConfig.quoteBalance,k=new Ln(v,y,(function(e){n.updatedConfig.quoteBalance=e,n.updateModifiedMarkers()}),(function(){}),(function(){}),!1,!0,t);r.quoteBalanceContainer.appendChild(k.control),this.quoteBalanceRangeHandler=k,br.show(r.quoteBalanceContainer)}else br.show(r.noQuoteBalance)}},{key:"setupWalletSettings",value:function(e){var t=this,n=this.page,r=Sn().currentWalletDefinition(this.baseID),a=Sn().currentWalletDefinition(this.quoteID);br.setVis(r.multifundingopts,n.baseWalletSettings),br.setVis(a.multifundingopts,n.quoteWalletSettings);var o={},s={},i={},c={},l=function(e,t,n){var r,a;n?(r=c,a=s):(r=i,a=o);var l=r[e];if(l){var u,d=Es(l);try{for(d.s();!(u=d.n()).done;){var h=u.value;br.setVis(t,a[h])}}catch(e){d.e(e)}finally{d.f()}}},u=function(e,n,r,a){a?t.quoteWalletSettingControl[e]={toHighlight:n,setValue:r}:t.baseWalletSettingControl[e]={toHighlight:n,setValue:r}},d=function(e,n,r){if(e){if(!t.updatedConfig.basicMarketMakingConfig.quoteOptions)return;t.updatedConfig.basicMarketMakingConfig.quoteOptions[n]=r}else{if(!t.updatedConfig.basicMarketMakingConfig.baseOptions)return;t.updatedConfig.basicMarketMakingConfig.baseOptions[n]=r}},h=function(r,a){var h,p,f;if(a){if(!t.updatedConfig.basicMarketMakingConfig.quoteOptions)return;h=t.updatedConfig.basicMarketMakingConfig.quoteOptions[r.key],p=n.quoteWalletSettingsContainer}else{if(r.quoteAssetOnly)return;if(!t.updatedConfig.basicMarketMakingConfig.baseOptions)return;h=t.updatedConfig.basicMarketMakingConfig.baseOptions[r.key],p=n.baseWalletSettingsContainer}if(r.isboolean){f=n.boolSettingTmpl.cloneNode(!0);var v=br.parseTemplate(f);v.name.textContent=r.displayname,v.input.checked="true"===h,e&&v.input.setAttribute("disabled","true"),v.input.onchange=function(){d(a,r.key,v.input.checked?"true":"false"),l(r.key,!!v.input.checked,a),t.updateModifiedMarkers()},u(r.key,v.input,(function(e){v.input.checked="true"===e,l(r.key,!!v.input.checked,a)}),a),r.description&&(v.tooltip.dataset.tooltip=r.description),p.appendChild(f)}else if(r.xyRange){f=n.rangeSettingTmpl.cloneNode(!0);var m=br.parseTemplate(f);m.name.textContent=r.displayname,r.description&&(m.tooltip.dataset.tooltip=r.description);var g=parseInt(h),y=new Ln(r.xyRange,g,(function(e){d(a,r.key,"".concat(e))}),(function(){t.updateModifiedMarkers()}),(function(){}),r.xyRange.roundX,r.xyRange.roundY,e);u(r.key,m.sliderContainer,(function(e){y.setValue(parseInt(e))}),a),m.sliderContainer.appendChild(y.control),p.appendChild(f)}if(f&&r.dependsOn){!function(e,t,n,r){var a,l;r?(a=c,l=s):(a=i,l=o),a[n]||(a[n]=[]),a[n].push(e),l[e]=t}(r.key,f,r.dependsOn,a);var k=function(e,n){if(e){if(!t.updatedConfig.basicMarketMakingConfig.quoteOptions)return;return t.updatedConfig.basicMarketMakingConfig.quoteOptions[n]}if(t.updatedConfig.basicMarketMakingConfig.baseOptions)return t.updatedConfig.basicMarketMakingConfig.baseOptions[n]}(a,r.dependsOn);br.setVis("true"===k,f)}};if(r.multifundingopts&&r.multifundingopts.length>0){var p,f=Es(r.multifundingopts);try{for(f.s();!(p=f.n()).done;)h(p.value,!1)}catch(e){f.e(e)}finally{f.f()}}if(a.multifundingopts&&a.multifundingopts.length>0){var v,m=Es(a.multifundingopts);try{for(m.s();!(v=m.n()).done;)h(v.value,!0)}catch(e){m.e(e)}finally{m.f()}}Sn().bindTooltips(n.baseWalletSettingsContainer),Sn().bindTooltips(n.quoteWalletSettingsContainer)}},{key:"fetchOracles",value:(t=o(b().mark((function e(){var t,n,r,a,o,s,i,c,l,u,d,h;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=this.originalConfig,r=n.baseAsset,a=n.quoteAsset,e.next=4,Lr("/api/marketreport",{baseID:r,quoteID:a});case 4:if(o=e.sent,br.hide(t.oraclesLoading),Sn().checkResponse(o)){e.next=10;break}return t.oraclesErrMsg.textContent=o.msg,br.show(t.oraclesErr),e.abrupt("return");case 10:if((s=o.report).oracles&&0!==s.oracles.length){br.empty(t.oracles),c=Es(null!==(i=s.oracles)&&void 0!==i?i:[]);try{for(c.s();!(l=c.n()).done;)u=l.value,d=t.oracleTmpl.cloneNode(!0),t.oracles.appendChild(d),(h=br.parseTemplate(d)).logo.src="img/"+u.host+".png",h.host.textContent=Ns[u.host],h.volume.textContent=br.formatFourSigFigs(u.usdVol),h.price.textContent=br.formatFourSigFigs((u.bestBuy+u.bestSell)/2)}catch(e){c.e(e)}finally{c.f()}t.avgPrice.textContent=s.price?br.formatFourSigFigs(s.price):"0",br.show(t.oraclesTable)}else br.show(t.noOracles);t.baseFiatRateSymbol.textContent=Sn().assets[r].symbol.toUpperCase(),t.baseFiatRateLogo.src=br.logoPathFromID(r),s.baseFiatRate>0?t.baseFiatRate.textContent=br.formatFourSigFigs(s.baseFiatRate):t.baseFiatRate.textContent="N/A",t.quoteFiatRateSymbol.textContent=Sn().assets[a].symbol.toUpperCase(),t.quoteFiatRateLogo.src=br.logoPathFromID(a),s.quoteFiatRate>0?t.quoteFiatRate.textContent=br.formatFourSigFigs(s.quoteFiatRate):t.quoteFiatRate.textContent="N/A",br.show(t.fiatRates);case 19:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),l}(Pr),Ns={"binance.com":"Binance","coinbase.com":"Coinbase","bittrex.com":"Bittrex","hitbtc.com":"HitBTC","exmo.com":"EXMO"};var Us=function(e){En(w,e);var t,n,a,i,c,l,h,p,f,v,m,g,y,k=(g=w,y=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rn(g);if(y){var n=Rn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return In(this,e)});function w(e){var t;s(this,w),d(An(t=k.call(this)),"body",void 0),d(An(t),"forms",void 0),d(An(t),"currentForm",void 0),d(An(t),"page",void 0),d(An(t),"host",void 0),d(An(t),"keyup",void 0),d(An(t),"dexAddrForm",void 0),d(An(t),"bondFeeBufferCache",void 0),t.body=e,t.host=e.dataset.host?e.dataset.host:"";var n=t.page=br.idDescendants(e);t.forms=br.applySelector(n.forms,":scope > form"),br.bind(n.exportDexBtn,"click",(function(){return t.prepareAccountExport(n.authorizeAccountExportForm)})),br.bind(n.disableAcctBtn,"click",(function(){return t.prepareAccountDisable(n.disableAccountForm)})),br.bind(n.bondDetailsBtn,"click",(function(){return t.prepareBondDetailsForm()})),br.bind(n.updateCertBtn,"click",(function(){return n.certFileInput.click()})),br.bind(n.updateHostBtn,"click",(function(){return t.prepareUpdateHost()})),br.bind(n.certFileInput,"change",(function(){return t.onCertFileChange()})),br.bind(n.bondAssetSelect,"change",(function(){return t.updateBondAssetCosts()})),br.bind(n.bondTargetTier,"input",(function(){return t.updateBondAssetCosts()})),t.dexAddrForm=new xa(n.dexAddrForm,function(){var e=o(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.location.assign("/dexsettings/".concat(t.host));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),void 0,t.host),Ta(n.bondDetailsForm,n.updateBondOptionsConfirm,(function(){return t.updateBondOptions()})),Ta(n.authorizeAccountExportForm,n.authorizeExportAccountConfirm,(function(){return t.exportAccount()})),Ta(n.disableAccountForm,n.disableAccountConfirm,(function(){return t.disableAccount()}));var r=function(){br.hide(n.forms)};return br.bind(n.forms,"mousedown",(function(e){br.mouseInElement(e,t.currentForm)||r()})),t.keyup=function(e){"Escape"===e.key&&r()},br.bind(document,"keyup",t.keyup),n.forms.querySelectorAll(".form-closer").forEach((function(e){br.bind(e,"click",(function(){r()}))})),Sn().registerNoteFeeder({conn:function(){t.setConnectionStatus()}}),t.setConnectionStatus(),t}return u(w,[{key:"unload",value:function(){br.unbind(document,"keyup",this.keyup)}},{key:"showForm",value:(m=o(b().mark((function e(t){var n,r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,this.currentForm=t,this.forms.forEach((function(e){return br.hide(e)})),t.style.right="10000px",br.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,br.animate(300,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"exportAccount",value:(v=o(b().mark((function e(){var t,n,r,a,o,s,i,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=t.exportAccountAppPass.value,r=t.exportAccountHost.textContent,t.exportAccountAppPass.value="",a={pw:n,host:r},o=Sn().loading(this.body),e.next=8,Lr("/api/exportaccount",a);case 8:if(s=e.sent,o(),Sn().checkResponse(s)){e.next=14;break}return t.exportAccountErr.textContent=s.msg,br.show(t.exportAccountErr),e.abrupt("return");case 14:s.account.bonds=s.bonds,i=JSON.parse(JSON.stringify(s.account)),(c=document.createElement("a")).setAttribute("download","dcrAccount-"+r+".json"),c.setAttribute("href","data:text/json,"+JSON.stringify(i,null,2)),c.click(),br.hide(t.forms);case 21:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"disableAccount",value:(f=o(b().mark((function e(){var t,n,r,a,o,s;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=t.disableAccountAppPW.value,r=t.disableAccountHost.textContent,t.disableAccountAppPW.value="",a={pw:n,host:r},o=Sn().loading(this.body),e.next=8,Lr("/api/disableaccount",a);case 8:if(s=e.sent,o(),Sn().checkResponse(s)){e.next=14;break}return t.disableAccountErr.textContent=s.msg,br.show(t.disableAccountErr),e.abrupt("return");case 14:br.hide(t.forms),window.location.assign("/settings");case 16:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"prepareAccountExport",value:(p=o(b().mark((function e(t){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.page).exportAccountHost.textContent=this.host,n.exportAccountErr.textContent="",Mr.passwordIsCached()?this.exportAccount():this.showForm(t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"prepareAccountDisable",value:(h=o(b().mark((function e(t){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.page).disableAccountHost.textContent=this.host,n.disableAccountErr.textContent="",this.showForm(t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"prepareBondDetailsForm",value:(l=o(b().mark((function e(){var t,n,a,o,s,i,c,l,u;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=this.page,n=Sn().user.exchanges[this.host],a=n.auth.targetTier.toString(),t.currentTargetTier.textContent="".concat(a),t.currentTier.textContent="".concat(n.auth.effectiveTier),t.bondTargetTier.setAttribute("placeholder",a),t.bondTargetTier.value="",this.bondFeeBufferCache={},br.empty(t.bondAssetSelect),o=0,s=Object.entries(n.bondAssets);o<s.length;o++)i=r(s[o],2),c=i[0],l=i[1],(u=document.createElement("option")).value=l.id.toString(),u.textContent=c.toUpperCase(),l.id===n.auth.bondAssetID&&(u.selected=!0),t.bondAssetSelect.appendChild(u);return t.bondOptionsErr.textContent="",br.hide(t.bondOptionsErr),e.next=14,this.updateBondAssetCosts();case 14:this.showForm(t.bondDetailsForm);case 15:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"updateBondAssetCosts",value:(c=o(b().mark((function e(){var t,n,r,a,o,s,i,c,l,u,d,h,p,f;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Sn().user.exchanges[this.host],a=this.page,o=parseInt(null!==(t=a.bondAssetSelect.value)&&void 0!==t?t:""),br.hide(a.bondCostFiat.parentElement),br.hide(a.bondReservationAmtFiat.parentElement),s=r.assets[o],i=r.bondAssets[s.symbol],c=i.amount,l=s.unitInfo,u=i.id,br.applySelector(a.bondDetailsForm,".bondAssetSym").forEach((function(e){e.textContent=s.symbol.toLocaleUpperCase()})),a.bondCost.textContent=br.formatFullPrecision(c,l),d=Sn().fiatRatesMap[u],br.showFiatValue(a.bondCostFiat,c,d,l),h=this.bondFeeBufferCache[s.symbol]){e.next=20;break}return e.next=18,this.getBondsFeeBuffer(u,a.bondDetailsForm);case 18:(h=e.sent)>0&&(this.bondFeeBufferCache[s.symbol]=h);case 20:if(0!==h){e.next=23;break}return a.bondReservationAmt.textContent=vn(yt),e.abrupt("return");case 23:p=parseInt(null!==(n=a.bondTargetTier.value)&&void 0!==n?n:""),f=0,p>0&&(f=c*p*2+h),a.bondReservationAmt.textContent=br.formatFullPrecision(f,l),br.showFiatValue(a.bondReservationAmtFiat,f,d,l);case 28:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"getBondsFeeBuffer",value:(i=o(b().mark((function e(t,n){var r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Sn().loading(n),e.next=3,Lr("/api/bondsfeebuffer",{assetID:t});case 3:if(a=e.sent,r(),Sn().checkResponse(a)){e.next=7;break}return e.abrupt("return",0);case 7:return e.abrupt("return",a.feeBuffer);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)})},{key:"prepareUpdateHost",value:(a=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.page,this.dexAddrForm.refresh(),this.showForm(t.dexAddrForm);case 3:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"onCertFileChange",value:(n=o(b().mark((function e(){var t,n,r,a,o,s;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,br.hide(t.errMsg),!(n=t.certFileInput.files)||!n.length){e.next=7;break}return e.next=6,n[0].text();case 6:r=e.sent;case 7:if(r){e.next=9;break}return e.abrupt("return");case 9:return a={host:this.host,cert:r},o=Sn().loading(this.body),e.next=13,Lr("/api/updatecert",a);case 13:s=e.sent,o(),Sn().checkResponse(s)?(br.show(t.updateCertMsg),setTimeout((function(){br.hide(t.updateCertMsg)}),5e3)):(t.errMsg.textContent=s.msg,br.show(t.errMsg));case 16:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setConnectionStatus",value:function(){var e=this.page,t=Sn().user.exchanges[this.host],n=function(t){t?(br.hide(e.disconnectedIcon),br.show(e.connectedIcon)):(br.show(e.disconnectedIcon),br.hide(e.connectedIcon))};if(t)switch(t.connectionStatus){case bn.Connected:n(!0),e.connectionStatus.textContent=vn(ut);break;case bn.Disconnected:n(!1),e.connectionStatus.textContent=vn(dt);break;case bn.InvalidCert:n(!1),e.connectionStatus.textContent="".concat(vn(dt)," - ").concat(vn(ht))}}},{key:"updateBondOptions",value:(t=o(b().mark((function e(){var t,n,r,a,o,s,i,c,l,u,d;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.page,a=parseInt(null!==(t=r.bondTargetTier.value)&&void 0!==t?t:""),o=parseInt(null!==(n=r.bondAssetSelect.value)&&void 0!==n?n:""),s={host:this.host,targetTier:a,bondAssetID:o},(i=Sn().assets[o])&&(c=this.bondFeeBufferCache[i.symbol])>0&&(s.feeBuffer=c),l=Sn().loading(this.body),e.next=9,Lr("/api/updatebondoptions",s);case 9:u=e.sent,l(),Sn().checkResponse(u)?(br.hide(r.bondOptionsErr),br.show(r.bondOptionsMsg),setTimeout((function(){br.hide(r.bondOptionsMsg)}),5e3),(d=Sn().user.exchanges[this.host]).auth.bondAssetID=o,d.auth.targetTier=a,r.currentTargetTier.textContent="".concat(a)):(r.bondOptionsErr.textContent=u.msg,br.show(r.bondOptionsErr));case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),w}(Pr);function Vs(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return _s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function _s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var zs,js=function(e){En(i,e);var t,n,r,a=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rn(n);if(r){var a=Rn(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return In(this,e)});function i(e){var t;s(this,i),d(An(t=a.call(this)),"body",void 0),d(An(t),"page",void 0),d(An(t),"initForm",void 0),d(An(t),"quickConfigForm",void 0),d(An(t),"seedBackupForm",void 0),d(An(t),"seedProvided",void 0),t.body=e;var n=t.page=br.idDescendants(e);return t.initForm=new Hs(n.appPWForm,(function(e,n,r){t.appInited(e,n,r)})),t.quickConfigForm=new Ks(n.quickConfigForm,(function(){return t.quickConfigDone()})),t.seedBackupForm=new Xs(n.seedBackupForm,(function(){return t.seedBackedUp()})),t}return u(i,[{key:"appInited",value:(t=o(b().mark((function e(t,n,r){var a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.seedProvided=r,a=this.page,e.next=4,this.quickConfigForm.update(t,n);case 4:this.seedBackupForm.update(t),Ia(a.appPWForm,a.quickConfigForm);case 6:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"quickConfigDone",value:function(){this.seedProvided?Sn().loadPage("wallets"):Ia(this.page.quickConfigForm,this.page.seedBackupForm)}},{key:"seedBackedUp",value:function(){Sn().loadPage("wallets")}}]),i}(Pr),Hs=function(){function e(t,n){var r=this;s(this,e),d(this,"form",void 0),d(this,"page",void 0),d(this,"success",void 0),this.form=t,this.success=n;var a=this.page=br.idDescendants(t);Ta(t,a.appPWSubmit,(function(){return r.setAppPass()})),Ta(t,a.toggleSeedInput,(function(){br.isHidden(a.seedInput)?(a.toggleSeedInputIcon.classList.remove("ico-plus"),a.toggleSeedInputIcon.classList.add("ico-minus"),br.show(a.seedInput)):(a.toggleSeedInputIcon.classList.remove("ico-minus"),a.toggleSeedInputIcon.classList.add("ico-plus"),br.hide(a.seedInput))}))}var t;return u(e,[{key:"setAppPass",value:(t=o(b().mark((function e(){var t,n,r,a,o,s,i,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,br.hide(n.appPWErrMsg),r=n.appPW.value||"",a=n.appPWAgain.value,""!==r){e.next=8;break}return n.appPWErrMsg.textContent=vn(w),br.show(n.appPWErrMsg),e.abrupt("return");case 8:if(r===a){e.next=12;break}return n.appPWErrMsg.textContent=vn(K),br.show(n.appPWErrMsg),e.abrupt("return");case 12:return Sn().setNotes([]),n.appPW.value="",n.appPWAgain.value="",o=Sn().loading(this.form),s=null===(t=n.seedInput.value)||void 0===t?void 0:t.replace(/\s+/g,""),i=n.rememberPass.checked,e.next=20,Lr("/api/init",{pass:r,seed:s,rememberPass:i});case 20:if(c=e.sent,o(),Sn().checkResponse(c)){e.next=26;break}return n.appPWErrMsg.textContent=c.msg,br.show(n.appPWErrMsg),e.abrupt("return");case 26:this.success(r,c.hosts,Boolean(s));case 27:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Gs=0,Ks=function(){function e(t,n){var r=this;s(this,e),d(this,"page",void 0),d(this,"form",void 0),d(this,"servers",void 0),d(this,"wallets",void 0),d(this,"pw",void 0),d(this,"success",void 0),this.form=t,this.success=n;var a=this.page=br.idDescendants(t);br.cleanTemplates(a.qcServerTmpl,a.qcWalletTmpl),Ta(t,a.quickConfigSubmit,(function(){r.submit()})),Ta(t,a.qcErrAck,(function(){r.success()}))}var t,n;return u(e,[{key:"update",value:(n=o(b().mark((function e(t,n){var r,a,o,s,i,c,l,u,d,h,p,f,v,m,g,y,k,w,x;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.pw=t,r=this.page,this.servers=[],a=Vs(n);try{for(a.s();!(o=a.n()).done;)s=o.value,i=r.qcServerTmpl.cloneNode(!0),r.qcServersBox.appendChild(i),c=br.parseTemplate(i),Gs++,l="qcsrow".concat(Gs),i.htmlFor=l,c.checkbox.id=l,c.host.textContent=s,this.servers.push({host:s,checkbox:c.checkbox})}catch(e){a.e(e)}finally{a.f()}return e.next=7,Sn().fetchUser();case 7:u=e.sent,this.wallets=[],d=0,h=Object.values(u.assets);case 10:if(!(d<h.length)){e.next=52;break}if(!(p=h[d]).token){e.next=14;break}return e.abrupt("continue",49);case 14:f=p.info,v=null,m=Vs(f.availablewallets),e.prev=17,m.s();case 19:if((g=m.n()).done){e.next=29;break}if((y=g.value).seeded){e.next=23;break}return e.abrupt("continue",27);case 23:if(!y.configopts||!y.configopts.some((function(e){return e.required}))){e.next=25;break}return e.abrupt("continue",27);case 25:return v=y,e.abrupt("break",29);case 27:e.next=19;break;case 29:e.next=34;break;case 31:e.prev=31,e.t0=e.catch(17),m.e(e.t0);case 34:return e.prev=34,m.f(),e.finish(34);case 37:if(v){e.next=39;break}return e.abrupt("continue",49);case 39:k=r.qcWalletTmpl.cloneNode(!0),r.qcWalletsBox.appendChild(k),w=br.parseTemplate(k),Gs++,x="qcwrow".concat(Gs),k.htmlFor=x,w.checkbox.id=x,w.icon.src=br.logoPath(p.symbol),w.name.textContent=p.name,this.wallets.push({asset:p,type:v.type,checkbox:w.checkbox});case 49:d++,e.next=10;break;case 52:case"end":return e.stop()}}),e,this,[[17,31,34,37]])}))),function(e,t){return n.apply(this,arguments)})},{key:"submit",value:(t=o(b().mark((function e(){var t,n,r,a,s,i,c,l,u,d,h,p,f=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n=[],(r=new ea(this.form,{backgroundColor:!0,message:"..."})).opts.message=vn(Vt),a=function(){var e=o(b().mark((function e(n){var r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.checkbox.checked){e.next=2;break}return e.abrupt("return");case 2:return r={addr:n.host,pass:f.pw},e.next=5,Lr("/api/adddex",r);case 5:a=e.sent,Sn().checkResponse(a)||t.push(n.host);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=6,Promise.all(this.servers.map(a));case 6:return r.opts.message=vn(Ut),s=function(){var e=o(b().mark((function e(t){var r,a,o,s;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.asset,a=t.type,t.checkbox.checked){e.next=3;break}return e.abrupt("return");case 3:return o={assetID:r.id,appPass:f.pw,walletType:a},e.next=6,Lr("/api/newwallet",o);case 6:s=e.sent,Sn().checkResponse(s)||n.push(r.name);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=10,Promise.all(this.wallets.map(s));case 10:return r.stop(),e.next=13,Sn().fetchUser();case 13:if(n.length+t.length!==0){e.next=15;break}return e.abrupt("return",this.success());case 15:if(i=this.page,br.hide(i.qcChoices),br.show(i.qcErrors),t.length){c=Vs(t);try{for(c.s();!(l=c.n()).done;)u=l.value,i.qcServerErrorList.appendChild(document.createTextNode(u)),i.qcServerErrorList.appendChild(document.createElement("br"))}catch(e){c.e(e)}finally{c.f()}}else br.hide(i.qcServerErrors);if(n.length){d=Vs(n);try{for(d.s();!(h=d.n()).done;)p=h.value,i.qcWalletErrorList.appendChild(document.createTextNode(p)),i.qcWalletErrorList.appendChild(document.createElement("br"))}catch(e){d.e(e)}finally{d.f()}}else br.hide(i.qcWalletErrors);case 20:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Xs=function(){function e(t,n){var r=this;s(this,e),d(this,"form",void 0),d(this,"page",void 0),d(this,"pw",void 0),this.form=t;var a=this.page=br.idDescendants(t);Ta(t,a.seedAck,(function(){return n()})),Ta(t,a.showSeed,(function(){return r.showSeed()}))}var t;return u(e,[{key:"update",value:function(e){this.pw=e}},{key:"showSeed",value:(t=o(b().mark((function e(){var t,n,r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Sn().loading(this.form),e.next=3,Lr("/api/exportseed",{pass:this.pw});case 3:if(n=e.sent,t(),Sn().checkResponse(n)){e.next=8;break}return console.error("error exporting seed:",n.msg),e.abrupt("return");case 8:(r=this.page).seedDiv.textContent=n.seed.match(/.{1,32}/g).map((function(e){var t;return null===(t=e.match(/.{1,8}/g))||void 0===t?void 0:t.join(" ")})).join("\n"),br.hide(r.sbWanna),br.show(r.sbSeed);case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();function Ys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ys(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Js(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Zs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zs(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function Zs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $s=br.idel,ei=br.bind,ti=br.unbind,ni={login:Ka,register:Oa,markets:is,wallets:go,settings:Oo,orders:ws,order:$a,dexsettings:Us,init:js,mm:Fs,mmsettings:qs},ri=function(){function e(){var t=this;s(this,e),d(this,"notes",void 0),d(this,"pokes",void 0),d(this,"user",void 0),d(this,"seedGenTime",void 0),d(this,"commitHash",void 0),d(this,"showPopups",void 0),d(this,"loggers",void 0),d(this,"recorders",void 0),d(this,"main",void 0),d(this,"header",void 0),d(this,"headerSpace",void 0),d(this,"assets",void 0),d(this,"exchanges",void 0),d(this,"walletMap",void 0),d(this,"fiatRatesMap",void 0),d(this,"tooltip",void 0),d(this,"page",void 0),d(this,"loadedPage",void 0),d(this,"popupNotes",void 0),d(this,"popupTmpl",void 0),d(this,"noteReceivers",void 0),d(this,"marketMakingCfg",void 0),d(this,"marketMakingStatus",void 0),this.notes=[],this.pokes=[],this.seedGenTime=0,this.commitHash="db6bafbfa98bcbcf2a0bae368bc7f5613fe426a5",this.noteReceivers=[],this.fiatRatesMap={},this.showPopups="1"===Mr.fetchLocal(Mr.popupsLK),console.log("Decred DEX Client App, Build",this.commitHash.substring(0,7)),this.loggers=Mr.fetchLocal(Mr.loggersLK)||{},window.enableLogger=function(e,n){return n?t.loggers[e]=!0:delete t.loggers[e],Mr.storeLocal(Mr.loggersLK,t.loggers),"".concat(e," logger ").concat(n?"enabled":"disabled")},window.log=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];t.log.apply(t,[e].concat(r))};var n=Mr.fetchLocal(Mr.recordersLK)||[];this.recorders={};var r,a=Js(n);try{for(a.s();!(r=a.n()).done;){var o=r.value;console.log("recording",o),this.recorders[o]=[]}}catch(e){a.e(e)}finally{a.f()}window.recordLogger=function(e,n){return n?t.recorders[e]=[]:delete t.recorders[e],Mr.storeLocal(Mr.recordersLK,Object.keys(t.recorders)),"".concat(e," recorder ").concat(n?"enabled":"disabled")},window.dumpLogger=function(e){var n=t.recorders[e];if(!n)return"no recorder for logger ".concat(e);var r=document.createElement("a");r.href="data:application/octet-stream;base64,".concat(window.btoa(JSON.stringify(n,null,4))),r.download="".concat(e,".json"),document.body.appendChild(r),r.click(),setTimeout((function(){document.body.removeChild(r)}),0)},y=pn[document.documentElement.lang.toLowerCase()]}var t,n,a,i,c,l,h,p,f,v,m,g;return u(e,[{key:"start",value:(g=o(b().mark((function e(){var t,n,r,a=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ei(window,"popstate",(function(e){var t,n=null===(t=e.state)||void 0===t?void 0:t.page;(n||""===n)&&a.loadPage(n,e.state.data,!0)})),this.main=$s(document,"main"),t=this.main.dataset.handler,e.next=5,this.fetchUser();case 5:oi((n=new URL(window.location.href)).pathname)!==t&&(n.pathname="/".concat(t),n.search="",window.history.replaceState({page:t},"",n)),this.attachHeader(),this.attachCommon(this.header),this.attach({}),this.updateMenuItemsDisplay(),To(),r=Mr.fetchLocal(Mr.notificationsLK),this.setNotes(r||[]),Vo.connect((void 0,o="https:"===window.location.protocol?"wss":"ws","".concat(o,"://").concat(window.location.host,"/ws")),this.reconnected),Vo.registerRoute("notify",(function(e){a.notify(e)}));case 16:case"end":return e.stop()}var o}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"reconnected",value:function(){window.location.reload()}},{key:"fetchUser",value:(m=o(b().mark((function e(){var t,n,a,o,s,i,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qr("/api/user");case 2:if(t=e.sent,this.checkResponse(t)){e.next=5;break}return e.abrupt("return");case 5:for(n=t,this.seedGenTime=n.seedgentime,this.user=n,this.assets=n.assets,this.exchanges=n.exchanges,this.walletMap={},this.fiatRatesMap=n.fiatRates,a=0,o=Object.entries(n.assets);a<o.length;a++)s=r(o[a],2),i=s[0],(c=s[1]).wallet&&(this.walletMap[i]=c.wallet);return this.updateMenuItemsDisplay(),e.abrupt("return",n);case 15:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"authed",value:function(){return this.user&&this.user.authed}},{key:"loadPage",value:(v=o(b().mark((function e(t,n,r){var a,o,s,i,c,l,u,d;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.tooltip.style.left="-10000px",br.hide(this.page.noteBox,this.page.profileBox),a=new URL("/".concat(t),window.location.origin),o=oi(t),e.next=6,window.fetch(a.toString());case 6:if((s=e.sent).ok){e.next=9;break}return e.abrupt("return",!1);case 9:return e.next=11,s.text();case 11:return i=e.sent,c=br.noderize(i),l=$s(c,"main"),u=l.dataset.handler,r||(d=u===o?a.toString():"/".concat(u),window.history.pushState({page:t,data:n},"",d)),document.title=c.title,this.main.replaceWith(l),this.main=l,this.noteReceivers=[],br.empty(this.headerSpace),this.attach(n),e.abrupt("return",!0);case 23:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return v.apply(this,arguments)})},{key:"attach",value:function(e){var t=this.main.dataset.handler;if(t){this.attachCommon(this.main),this.loadedPage&&this.loadedPage.unload();var n=ni[t];this.loadedPage=n?new n(this.main,e):null,this.bindTooltips(this.main)}else console.error("cannot attach to content with no specified handler")}},{key:"bindTooltips",value:function(e){var t=this;e.querySelectorAll("[data-tooltip]").forEach((function(e){ei(e,"mouseenter",(function(){t.tooltip.textContent=e.dataset.tooltip||"";var n=br.layoutMetrics(e),r=n.centerX-t.tooltip.offsetWidth/2;r<0&&(r=5),r+t.tooltip.offsetWidth>document.body.offsetWidth&&(r=document.body.offsetWidth-t.tooltip.offsetWidth-5),t.tooltip.style.left="".concat(r,"px"),t.tooltip.style.top="".concat(n.bodyTop-t.tooltip.offsetHeight-5,"px")})),ei(e,"mouseleave",(function(){t.tooltip.style.left="-10000px"}))}))}},{key:"attachHeader",value:function(){var e=this;this.header=$s(document.body,"header"),this.headerSpace=br.idel(this.header,"headerSpace"),this.popupNotes=$s(document.body,"popupNotes"),this.popupTmpl=br.tmplElement(this.popupNotes,"note"),this.popupTmpl?this.popupTmpl.remove():console.error("popupTmpl element not found"),this.tooltip=$s(document.body,"tooltip");var t=this.page=br.idDescendants(this.header);t.noteTmpl.removeAttribute("id"),t.noteTmpl.remove(),t.pokeTmpl.removeAttribute("id"),t.pokeTmpl.remove(),t.loader.remove(),br.show(t.loader),ei(t.noteBell,"click",o(b().mark((function n(){var r,a,o;return b().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:br.hide(t.pokeList),br.show(t.noteList),e.ackNotes(),t.noteCat.classList.add("active"),t.pokeCat.classList.remove("active"),e.showDropdown(t.noteBell,t.noteBox),br.hide(t.noteIndicator),r=Js(e.notes);try{for(r.s();!(a=r.n()).done;)(o=a.value).acked&&o.el.classList.remove("firstview")}catch(e){r.e(e)}finally{r.f()}e.setNoteTimes(t.noteList),e.setNoteTimes(t.pokeList),e.storeNotes();case 12:case"end":return n.stop()}}),n)})))),ei(t.burgerIcon,"click",(function(){br.hide(t.logoutErr),e.showDropdown(t.burgerIcon,t.profileBox)})),ei(t.innerNoteIcon,"click",(function(){br.hide(t.noteBox)})),ei(t.innerBurgerIcon,"click",(function(){br.hide(t.profileBox)})),ei(t.profileSignout,"click",o(b().mark((function t(){return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.signOut();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))),ei(t.pokeCat,"click",(function(){e.setNoteTimes(t.pokeList),t.pokeCat.classList.add("active"),t.noteCat.classList.remove("active"),br.hide(t.noteList),br.show(t.pokeList),e.ackNotes()})),ei(t.noteCat,"click",(function(){e.setNoteTimes(t.noteList),t.noteCat.classList.add("active"),t.pokeCat.classList.remove("active"),br.hide(t.pokeList),br.show(t.noteList),e.ackNotes()}))}},{key:"showDropdown",value:function(e,t){var n=this,r=e.getBoundingClientRect();br.hide(this.page.noteBox,this.page.profileBox),br.show(t),t.style.right="".concat(window.innerWidth-r.left-r.width+5,"px"),t.style.top="".concat(r.top-4,"px"),ei(document,"click",(function e(r){br.mouseInElement(r,t)||(br.hide(t),ti(document,"click",e),t===n.page.noteBox&&br.isDisplayed(n.page.noteList)&&n.ackNotes())}))}},{key:"ackNotes",value:function(){var e,t=[],n=Js(this.notes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.acked?r.el.classList.remove("firstview"):(r.acked=!0,r.id&&r.severity>2&&t.push(r.id))}}catch(e){n.e(e)}finally{n.f()}t.length&&Vo.request("acknotes",t),br.hide(this.page.noteIndicator)}},{key:"setNoteTimes",value:function(e){for(var t=0,n=Array.from(e.children);t<n.length;t++){var r=n[t];br.safeSelector(r,"span.note-time").textContent=br.timeSince(r.note.stamp)}}},{key:"bindInternalNavigation",value:function(e){var t=this,n=new URL(window.location.href);e.querySelectorAll("a").forEach((function(e){if(e.href){var r=new URL(e.href);if(r.origin===n.origin){var a=r.pathname.substring(1),o={};r.search&&r.searchParams.forEach((function(e,t){o[t]=e})),br.bind(e,"click",(function(e){e.preventDefault(),t.loadPage(a,o)}))}}}))}},{key:"storeNotes",value:function(){Mr.storeLocal(Mr.notificationsLK,this.notes.map((function(e){return{subject:e.subject,details:e.details,severity:e.severity,stamp:e.stamp,id:e.id,acked:e.acked}})))}},{key:"updateMenuItemsDisplay",value:function(){var e=this.page,t=this.user;if(e){if(!t||!t.authed)return e.profileBox.classList.remove("authed"),void br.hide(e.noteBell,e.walletsMenuEntry,e.marketsMenuEntry);e.profileBox.classList.add("authed"),br.show(e.noteBell,e.walletsMenuEntry),br.setVis(Object.keys(t.exchanges).length>0,e.marketsMenuEntry)}}},{key:"attachCommon",value:function(e){this.bindInternalNavigation(e)}},{key:"updateBondConfs",value:function(e,t,n){var r,a=Js(this.exchanges[e].auth.pendingBonds);try{for(a.s();!(r=a.n()).done;){var o=r.value;o.coinID===t&&(o.confs=n)}}catch(e){a.e(e)}finally{a.f()}}},{key:"updateTier",value:function(e,t){this.exchanges[e].auth.rep.bondedTier=t}},{key:"handleBondNote",value:function(e){switch(e.topic){case"RegUpdate":null!==e.coinID&&this.updateBondConfs(e.dex,e.coinID,e.confirmations);break;case"BondConfirmed":null!==e.tier&&this.updateTier(e.dex,e.tier)}}},{key:"setNotes",value:function(e){this.log("notes","setNotes",e),this.notes=[],br.empty(this.page.noteList);for(var t=0;t<e.length;t++)this.prependNoteElement(e[t],!0);this.storeNotes()}},{key:"updateUser",value:function(e){var t=this.user,n=this.assets,a=this.walletMap;if("fiatrateupdate"!==e.type){if(t)switch(e.type){case"order":var o=e,s=o.order,i=t.exchanges[s.host].markets[s.market],c=o.tempID;if("AsyncOrderSubmitted"===e.topic){var l=s;l.tempID=c,i.inflight?i.inflight.push(l):i.inflight=[l];break}if("AsyncOrderFailure"===e.topic){i.inflight=i.inflight.filter((function(e){return e.tempID!==c}));break}for(var u in i.inflight||[])if(i.inflight[u].tempID===c){i.inflight=i.inflight.filter((function(e){return e.tempID!==c}));break}i.orders?function(e,t){for(var n in e.orders||[])if(e.orders[n].id===t.id)return e.orders[n]=t,!0;return!1}(i,s)||i.orders.push(s):i.orders=[s];break;case"balance":var d=e,h=t.assets[d.assetID];if(!h)break;var p=h.wallet;p&&(p.balance=d.balance);break;case"bondpost":this.handleBondNote(e);break;case"walletstate":case"walletconfig":if(!n)return;var f=e.wallet;n[f.assetID].wallet=f,a[f.assetID]=f;break;case"match":var v=e,m=this.order(v.orderID);m&&function(e,t){for(var n in e.matches)if(e.matches[n].matchID===t.matchID)return void(e.matches[n]=t);e.matches=e.matches||[],e.matches.push(t)}(m,v.match);break;case"conn":var g=e,y=t.exchanges[g.host];y&&(y.connectionStatus=g.connectionStatus);break;case"spots":var k=e,b=t.exchanges[k.host];if(!b||!b.markets)break;for(var w=0,x=Object.entries(k.spots);w<x.length;w++){var C=r(x[w],2),S=C[0],A=C[1];b.markets[S].spot=A}break;case"fiatrateupdate":this.fiatRatesMap=e.fiatRates;break;case"mmstartstop":var F=e;if(!this.marketMakingStatus)return;this.marketMakingStatus.running=F.running}}else this.fiatRatesMap=e.fiatRates}},{key:"notify",value:function(e){this.log("notes","notify",e),this.updateUser(e);var t,n=Js(this.noteReceivers);try{for(n.s();!(t=n.n()).done;){var r=t.value[e.type];if(r)try{r(e)}catch(t){console.error("note feeder error:",t.message?t.message:t),console.log(e),console.log(t.stack)}}}catch(e){n.e(e)}finally{n.f()}if(!(e.severity<2)){var a=this.popupTmpl,s=this.popupNotes;if(this.showPopups){var i=a.cloneNode(!0);br.tmplElement(i,"text").textContent="".concat(e.subject,": ").concat(e.details);var c=br.tmplElement(i,"indicator");for(2===e.severity?br.hide(c):ii(c,e.severity),s.appendChild(i);s.children.length>5;)s.removeChild(s.firstChild);setTimeout(o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,br.animate(500,(function(e){i.style.opacity=String(1-e)}));case 2:i.remove();case 3:case"end":return e.stop()}}),e)}))),6e3)}2===e.severity?this.prependPokeElement(e):this.prependNoteElement(e),function(e){So[e.type]&&Ro(e.subject,e.details)}(e)}}},{key:"registerNoteFeeder",value:function(e){this.noteReceivers.push(e)}},{key:"log",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];this.loggers[e]&&(t=console).log.apply(t,["".concat(si(),"[").concat(e,"]:")].concat(r)),this.recorders[e]&&this.recorders[e].push({time:si(),msg:r})}},{key:"prependPokeElement",value:function(e){var t=r(this.makePoke(e),2),n=t[0],a=t[1];for(this.pokes.push(a);this.pokes.length>100;)this.pokes.shift();this.prependListElement(this.page.pokeList,a,n)}},{key:"prependNoteElement",value:function(e,t){var n=r(this.makeNote(e),2),a=n[0],o=n[1];for(this.notes.push(o);this.notes.length>100;)this.notes.shift();var s=this.page.noteList;if(this.prependListElement(s,o,a),t||this.storeNotes(),!(0===this.notes.length||br.isDisplayed(this.page.noteBox)&&br.isDisplayed(s))){var i=0,c=this.notes.reduce((function(e,t){return t.acked||i++,!t.acked&&t.severity>e?t.severity:e}),0),l=this.page.noteIndicator;ii(l,c),i?(l.textContent=String(i>99?"".concat(99,"+"):i),br.show(l)):br.hide(l)}}},{key:"prependListElement",value:function(e,t,n){for(n.note=t,e.prepend(n);e.children.length>100;)e.removeChild(e.lastChild);this.setNoteTimes(e)}},{key:"makeNote",value:function(e){var t=this.page.noteTmpl.cloneNode(!0);if(e.severity>2){var n=3===e.severity?"good":4===e.severity?"warn":"bad";br.safeSelector(t,"div.note-indicator").classList.add(n)}return br.safeSelector(t,"div.note-subject").textContent=e.subject,br.safeSelector(t,"div.note-details").textContent=e.details,[t,Qs({el:t},e)]}},{key:"makePoke",value:function(e){var t=this.page.pokeTmpl.cloneNode(!0),n=new Date(e.stamp);return br.tmplElement(t,"dateTime").textContent="".concat(n.toLocaleDateString(),", ").concat(n.toLocaleTimeString()),br.tmplElement(t,"details").textContent="".concat(e.subject,": ").concat(e.details),[t,Qs({el:t},e)]}},{key:"loading",value:function(e){var t=this.page.loader.cloneNode(!0);return e.appendChild(t),function(){t.remove()}}},{key:"orders",value:function(e,t){var n=[],r=this.user.exchanges[e].markets[t];return r.orders&&(n=n.concat(r.orders)),r.inflight&&(n=n.concat(r.inflight)),n}},{key:"haveActiveOrders",value:function(e){for(var t=0,n=Object.values(this.user.exchanges);t<n.length;t++){var r=n[t];if(r.markets)for(var a=0,o=Object.values(r.markets);a<o.length;a++){var s=o[a];if(s.orders){var i,c=Js(s.orders);try{for(c.s();!(i=c.n()).done;){var l=i.value;if((l.baseID===e||l.quoteID===e)&&(l.status<jn||Qn(l)))return!0}}catch(e){c.e(e)}finally{c.f()}}}}return!1}},{key:"order",value:function(e){for(var t=0,n=Object.values(this.user.exchanges);t<n.length;t++){var r=n[t];if(r&&r.markets)for(var a=0,o=Object.values(r.markets);a<o.length;a++){var s=o[a];if(s.orders){var i,c=Js(s.orders);try{for(c.s();!(i=c.n()).done;){var l=i.value;if(l.id===e)return l}}catch(e){c.e(e)}finally{c.f()}}}}return null}},{key:"canAccelerateOrder",value:function(e){var t;t=e.sell?e.baseID:e.quoteID;var n=this.walletMap[t];if(!(n&&16&n.traits))return!1;if(e.matches)for(var r=0;r<(null===(a=e.matches)||void 0===a?void 0:a.length);r++){var a,o=e.matches[r];if(o.swap&&o.swap.confs&&0===o.swap.confs.count&&!o.revoked)return!0}return!1}},{key:"unitInfo",value:function(e,t){var n=this.assets[e];if(n)return n.unitInfo;if(!t||!t.assets)throw Error(vn(He,{assetID:"".concat(e)}));return t.assets[e].unitInfo}},{key:"conventionalRate",value:function(e,t,n,r){var a=[this.unitInfo(e,r),this.unitInfo(t,r)],o=a[1];return n*(a[0].conventional.conversionFactor/o.conventional.conversionFactor)/Gn}},{key:"walletDefinition",value:function(e,t){var n=this.assets[e];if(n.token)return n.token.definition;if(!n.info)throw Error("where's the wallet info?");return""===t?n.info.availablewallets[n.info.emptyidx]:n.info.availablewallets.filter((function(e){return e.type===t}))[0]}},{key:"currentWalletDefinition",value:function(e){var t=this.assets[e];return t.token?t.token.definition:this.walletDefinition(e,this.assets[e].wallet.type)}},{key:"fetchBalance",value:(f=o(b().mark((function e(t){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lr("/api/balance",{assetID:t});case 2:if(n=e.sent,this.checkResponse(n)){e.next=5;break}throw new Error("failed to fetch balance for asset ID ".concat(t));case 5:return e.abrupt("return",n.balance);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"checkResponse",value:function(e){return e.requestSuccessful&&e.ok}},{key:"signOut",value:(p=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lr("/api/logout");case 2:if(t=e.sent,this.checkResponse(t)){e.next=7;break}return t.code===Ur.activeOrdersErr?this.page.logoutErr.textContent=vn(We):this.page.logoutErr.textContent=t.msg,br.show(this.page.logoutErr),e.abrupt("return");case 7:Mr.removeCookie(Mr.authCK),Mr.removeCookie(Mr.pwKeyCK),Mr.removeLocal(Mr.notificationsLK),window.location.href="/login";case 11:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"getMarketMakingConfig",value:(h=o(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.marketMakingCfg){e.next=2;break}return e.abrupt("return",this.marketMakingCfg);case 2:return e.next=4,qr("/api/marketmakingconfig");case 4:if(t=e.sent,this.checkResponse(t)){e.next=7;break}throw new Error("failed to fetch market making config");case 7:return this.marketMakingCfg=t.cfg,e.abrupt("return",this.marketMakingCfg);case 9:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"updateMarketMakingConfig",value:(l=o(b().mark((function e(t){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lr("/api/updatemarketmakingconfig",t);case 2:if(!(n=e.sent).err){e.next=5;break}throw new Error(n.err);case 5:this.marketMakingCfg=n.cfg;case 6:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"removeMarketMakingConfig",value:(c=o(b().mark((function e(t){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lr("/api/removemarketmakingconfig",{host:t.host,baseAsset:t.baseAsset,quoteAsset:t.quoteAsset});case 2:if(!(n=e.sent).err){e.next=5;break}throw new Error(n.err);case 5:this.marketMakingCfg=n.cfg;case 6:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"setMarketMakingEnabled",value:(i=o(b().mark((function e(t,n,r,a){var o,s;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.marketMakingCfg.botConfigs||[],s=o.find((function(e){return e.host===t&&e.baseAsset===n&&e.quoteAsset===r}))){e.next=4;break}throw new Error("market making config not found");case 4:return s.disabled=!a,e.next=7,this.updateMarketMakingConfig(s);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return i.apply(this,arguments)})},{key:"startMarketMaking",value:(a=o(b().mark((function e(t){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lr("/api/startmarketmaking",{appPW:t});case 2:if(n=e.sent,this.checkResponse(n)){e.next=5;break}throw new Error(n.msg);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"stopMarketMaking",value:(n=o(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lr("/api/stopmarketmaking");case 2:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"getMarketMakingStatus",value:(t=o(b().mark((function e(){var t,n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.marketMakingStatus){e.next=2;break}return e.abrupt("return",this.marketMakingStatus);case 2:return e.next=4,qr("/api/marketmakingstatus");case 4:if(t=e.sent,this.checkResponse(t)){e.next=7;break}throw new Error("failed to fetch market making status");case 7:return(n={}).running=!!t.running,n.runningBots=t.runningBots,e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),ai=(d(zs={},3,"good"),d(zs,5,"bad"),d(zs,4,"warn"),zs);function oi(e){return e.replace(/^\//,"").split("/")[0].split("?")[0].split("#")[0]}function si(){var e=new Date,t=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0"),r=e.getSeconds().toString().padStart(2,"0"),a=e.getMilliseconds().toString().padStart(3,"0");return"".concat(t,":").concat(n,":").concat(r,".").concat(a)}function ii(e,t){e.classList.remove("bad","warn","good"),e.classList.add(ai[t])}var ci=new ri;mn=ci,ci.start()})()})();
//# sourceMappingURL=entry.js.map